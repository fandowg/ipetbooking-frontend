{"version":3,"sources":["webpack:///./src/router/views/prepaid/DetailOrders.vue?b5ae","webpack:///src/router/views/prepaid/DetailOrders.vue","webpack:///./src/router/views/prepaid/DetailOrders.vue?d681","webpack:///./src/router/views/prepaid/DetailOrders.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","title","scopedSlots","_u","key","fn","staticClass","disabled","enabledCreateOrder","type","on","click","handleCreateOrder","_v","proxy","directives","name","rawName","value","expression","modifiers","fullscreen","lock","element-loading-text","data","loadedOrders","default-sort","prop","order","row-class-name","calcRowClassName","row-click","tryToGetOrder","sort-change","sortChange","label","min-width","sortable","ref","row","_s","_f","created","state","status","text","source","sizeTitle","paymentMethod","fullName","gender","content","placement","current-page","currentPage","update:currentPage","$event","update:current-page","visible","drawerVisible","append-to-body","size","$root","isSmallDevice","destroy-on-close","update:visible","drawerMode","slot","default-value","drawerOrderData","update:defaultValue","update:default-value","update","tryToFetchOrder","defaultValue","selectPrice","_e","prepaid","select-price","update:selectPrice","update:select-price","store","handleUpdateOrders","cancel","handleCloseDrawer","staticRenderFns","DetailOrdersvue_type_script_lang_js_","components","PortalTarget","portal_vue_common","BaseStateLabel","Object","lazyload_component","__webpack_require__","e","then","bind","OrderDetail","OrderForm","filters","genderFilter","filter_value_to_text","orderStatusFilter","orderSourceFilter","orderPaymentMethodFilter","formatDate","format_date","mixins","pagination","props","default","tryingToGetOrder","filterData","order_by","computed","infinity","inventory","qty","watch","handler","immediate","methods","updateDrawerMode","_ref","orderStatus","orderUsedStatus","groupSize","usedSize","_tryToGetOrder","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","$store","dispatch","id","sent","stop","_x","apply","arguments","_tryToFetchOrder","_callee2","_ref2","items","total","_this","_context2","assign","groupOrdering","pageQuery","$nextTick","$refs","updateTotal","drawer","closeDrawer","$emit","objectSpread","_ref3","column","prepaid_DetailOrdersvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"yHAAA,IAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,kBAAsCE,MAAA,CAAOC,MAAA,eAAsBC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,QAAAC,GAAA,WAA0B,OAAAP,EAAA,aAAwBQ,YAAA,WAAAN,MAAA,CAA8BO,UAAAb,EAAAc,mBAAAC,KAAA,WAAoDC,GAAA,CAAKC,MAAAjB,EAAAkB,oBAA+B,CAAAlB,EAAAmB,GAAA,iBAAyBC,OAAA,OAAehB,EAAA,YAAiBiB,WAAA,EAAaC,KAAA,UAAAC,QAAA,4BAAAC,MAAAxB,EAAA,iBAAAyB,WAAA,mBAAAC,UAAA,CAAyHC,YAAA,EAAAC,MAAA,KAA+BtB,MAAA,CAASuB,uBAAA,UAAAC,KAAA9B,EAAA+B,aAAAC,eAAA,CAAyEC,KAAA,UAAAC,MAAA,cAAuCC,iBAAAnC,EAAAoC,kBAAuCpB,GAAA,CAAKqB,YAAArC,EAAAsC,cAAAC,cAAAvC,EAAAwC,aAA4D,CAAApC,EAAA,mBAAwBE,MAAA,CAAOmC,MAAA,QAAAR,KAAA,aAAAS,YAAA,MAAAC,SAAA,UAA0EnC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,UAAAC,GAAA,SAAAiC,GACx5B,IAAAC,EAAAD,EAAAC,IACA,OAAAzC,EAAA,QAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAA,IAAAD,EAAA,YAAAzC,EAAA,OAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAA+C,GAAA,aAAA/C,CAAA6C,EAAAG,QAAA,uBAAyI5C,EAAA,mBAAwBE,MAAA,CAAOmC,MAAA,QAAAR,KAAA,SAAAS,YAAA,MAAAC,SAAA,UAAsEnC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,UAAAC,GAAA,SAAAiC,GACpQ,IAAAC,EAAAD,EAAAC,IACA,OAAAzC,EAAA,kBAA6BE,MAAA,CAAO2C,MAAAjD,EAAA+C,GAAA,oBAAA/C,CAAA6C,EAAAK,OAAA,SAAAC,KAAA,KAAmE,CAAAnD,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAA+C,GAAA,oBAAA/C,CAAA6C,EAAAK,OAAA,YAAA9C,EAAA,MAAAA,EAAA,kBAAiGE,MAAA,CAAO2C,MAAA,OAAAE,KAAA,KAA0B,CAAAnD,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAA+C,GAAA,oBAAA/C,CAAA6C,EAAAO,mBAAiEhD,EAAA,mBAAwBE,MAAA,CAAOmC,MAAA,KAAAC,YAAA,MAA8BlC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,UAAAC,GAAA,SAAAiC,GAC7X,IAAAC,EAAAD,EAAAC,IACA,OAAA7C,EAAAmB,GAAAnB,EAAA8C,GAAAD,EAAAQ,mBAA2CjD,EAAA,mBAAwBE,MAAA,CAAOmC,MAAA,OAAAC,YAAA,MAAAT,KAAA,gBAAAU,SAAA,UAA4EnC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,UAAAC,GAAA,SAAAiC,GAC5K,IAAAC,EAAAD,EAAAC,IACA,OAAA7C,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAA+C,GAAA,2BAAA/C,CAAA6C,EAAAS,wBAAmFlD,EAAA,mBAAwBE,MAAA,CAAOmC,MAAA,OAAAC,YAAA,OAAiClC,YAAAR,EAAAS,GAAA,EAAsBC,IAAA,UAAAC,GAAA,SAAAiC,GACzK,IAAAC,EAAAD,EAAAC,IACA,OAAAzC,EAAA,OAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAAD,EAAAU,UAAA,IAAAvD,EAAA8C,GAAA9C,EAAA+C,GAAA,eAAA/C,CAAA6C,EAAAW,YAAApD,EAAA,OAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAAD,EAAA,cAAAA,EAAA,uBAA6KzC,EAAA,mBAAwBE,MAAA,CAAOoC,YAAA,OAAkB,CAAAtC,EAAA,cAAmBE,MAAA,CAAOmD,QAAA,SAAAC,UAAA,QAAsC,CAAAtD,EAAA,aAAkBE,MAAA,CAAOS,KAAA,SAAe,CAAAX,EAAA,YAAiBE,MAAA,CAAOgB,KAAA,iBAAqB,eAAAlB,EAAA,kBAAuCwC,IAAA,aAAAtC,MAAA,CAAwBqD,eAAA3D,EAAA4D,aAA+B5C,GAAA,CAAK6C,qBAAA,SAAAC,GAAsC9D,EAAA4D,YAAAE,GAAuBC,sBAAA,SAAAD,GAAwC9D,EAAA4D,YAAAE,MAAyB1D,EAAA,aAAkBwC,IAAA,SAAAtC,MAAA,CAAoB0D,QAAAhE,EAAAiE,cAAAC,iBAAA,GAAAC,KAAAnE,EAAAoE,MAAAC,cAAA,aAAAC,oBAAA,GAAwHtD,GAAA,CAAKuD,iBAAA,SAAAT,GAAkC9D,EAAAiE,cAAAH,KAA2B,YAAA9D,EAAAwE,WAAA,CAAApE,EAAA,gBAAoDE,MAAA,CAAOmE,KAAA,QAAAnD,KAAA,yBAA8CmD,KAAA,UAAcrE,EAAA,eAAoBwC,IAAA,cAAAtC,MAAA,CAAyBoE,gBAAA1E,EAAA2E,iBAAoC3D,GAAA,CAAK4D,sBAAA,SAAAd,GAAuC9D,EAAA2E,gBAAAb,GAA2Be,uBAAA,SAAAf,GAAyC9D,EAAA2E,gBAAAb,GAA2BgB,OAAA9E,EAAA+E,oBAA+B,CAAA3E,EAAA,gBAAuBE,MAAA,CAAOmE,KAAA,QAAAnD,KAAA,yBAA8CmD,KAAA,UAAcrE,EAAA,MAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAAgF,aAAAzE,UAAAH,EAAA,MAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAA9C,EAAAgF,aAAA,YAAAhF,EAAA,YAAAI,EAAA,QAAAJ,EAAAmB,GAAAnB,EAAA8C,GAAA,OAAA9C,EAAAiF,gBAAAjF,EAAAkF,OAAA9E,EAAA,aAAmNE,MAAA,CAAO6E,QAAAnF,EAAAgF,aAAAI,eAAApF,EAAAiF,aAA0DjE,GAAA,CAAKqE,qBAAA,SAAAvB,GAAsC9D,EAAAiF,YAAAnB,GAAuBwB,sBAAA,SAAAxB,GAAwC9D,EAAAiF,YAAAnB,GAAuByB,MAAAvF,EAAAwF,mBAAAC,OAAAzF,EAAA0F,uBAAgE,QACrtDC,EAAA,4GCEAC,EAAA,CACAC,WAAA,CACAC,aAAAC,EAAA,gBACAC,eAAA,kBACAC,OAAAC,EAAA,KAAAD,CAAAE,EAAAC,EAAA,kBAAAC,KAAAF,EAAAG,KAAA,gBACAC,YAAA,kBACAN,OAAAC,EAAA,KAAAD,CAAAE,EAAAC,EAAA,kBAAAC,KAAAF,EAAAG,KAAA,gBACAE,UAAA,kBAAAL,EAAAC,EAAA,kBAAAC,KAAAF,EAAAG,KAAA,gBAEAG,QAAA,CACAC,aAAAC,EAAA,KACAC,kBAAAD,EAAA,KACAE,kBAAAF,EAAA,KACAG,yBAAAH,EAAA,KACAI,WAAAC,EAAA,MAEAC,OAAA,CAAAC,EAAA,MACAC,MAAA,CACAnC,aAAA,CACAjE,KAAAkF,OACAmB,QAAA,eAGAtF,KAvBA,WAwBA,OACAC,aAAA,GACAsF,kBAAA,EACApD,eAAA,EACAU,gBAAA,GACAH,WAAA,SACA8C,WAAA,CACAC,SAAA,aACArF,MAAA,QAEA+C,YAAA,IAGAuC,SAAA,CACA1G,mBADA,WAEA,OACA,IAAAb,KAAA+E,aAAAyC,UACA,IAAAxH,KAAA+E,aAAAyC,UACAxH,KAAA+E,aAAA0C,UAAAzH,KAAA+E,aAAA2C,MAIAC,MAAA,CACAhE,YAAA,CACAiE,QAAA,kBACAC,WAAA,GAEA7D,cALA,SAKAzC,GACAA,IACAvB,KAAAgF,YAAA,KAKA8C,QAAA,CACAC,iBADA,SACAxG,GACAvB,KAAAuE,aAAAhD,IAAAvB,KAAAuE,WAAAhD,IAEAY,iBAJA,SAAA6F,GAIA,IAAApF,EAAAoF,EAAApF,IACAqF,EAAArF,EAAAK,OACAiF,EAAAtF,EAAAuF,UAAAvF,EAAAwF,SAEA,WAAAH,EAAA,kBACA,IAAAC,EAAA,sBAEA7F,cAXA,eAAAgG,EAAArC,OAAAsC,EAAA,KAAAtC,CAAAuC,EAAAC,EAAAC,KAAA,SAAAC,EAWA9F,GAXA,OAAA2F,EAAAC,EAAAG,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAYA9I,KAAAoH,kBAAA,EAZAwB,EAAAE,KAAA,EAaA9I,KAAA+I,OAAAC,SACA,2BACApG,EAAAqG,IAfA,OAaAjJ,KAAA0E,gBAbAkE,EAAAM,KAiBAlJ,KAAAoH,kBAAA,EACApH,KAAA+H,iBAAA,UACA/H,KAAAgE,eAAA,EAnBA,wBAAA4E,EAAAO,SAAAT,EAAA1I,SAAA,gBAAAoJ,GAAA,OAAAf,EAAAgB,MAAArJ,KAAAsJ,YAAA,GAqBAxE,gBArBA,eAAAyE,EAAAvD,OAAAsC,EAAA,KAAAtC,CAAAuC,EAAAC,EAAAC,KAAA,SAAAe,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAA5J,KAAA,OAAAuI,EAAAC,EAAAG,KAAA,SAAAkB,GAAA,eAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,cAAAe,EAAAf,KAAA,EAuBA9I,KAAA+I,OAAAC,SACA,sBACAhD,OAAA8D,OACA,CACAC,cAAA/J,KAAA+E,aAAAgF,cAEA1G,cAAA,MACAiE,SAAAtH,KAAAqH,WAAAC,SACArF,MAAAjC,KAAAqH,WAAApF,OAEAjC,KAAAgK,YAjCA,OAAAP,EAAAI,EAAAX,KAuBAQ,EAvBAD,EAuBAC,MAAAC,EAvBAF,EAuBAE,MAcA3J,KAAA8B,aAAA4H,EACA1J,KAAAiK,UAAA,WACAL,EAAAM,MAAAjD,WAAAkD,YAAAR,KAvCA,wBAAAE,EAAAV,SAAAK,EAAAxJ,SAAA,yBAAAuJ,EAAAF,MAAArJ,KAAAsJ,YAAA,GA0CArI,kBA1CA,WA2CAjB,KAAA+H,iBAAA,OACA/H,KAAAgE,eAAA,GAEAyB,kBA9CA,WA+CAzF,KAAAkK,MAAAE,OAAAC,eAGA9E,mBAlDA,WAmDAvF,KAAAsK,MAAA,sBAAAtE,OAAAuE,EAAA,KAAAvE,CAAA,GACAhG,KAAA+E,aADA,CAEA2C,IAAA1H,KAAA+E,aAAA2C,IAAA,KAEA1H,KAAA8E,kBACA9E,KAAAyF,qBAEAlD,WA1DA,SAAAiI,GA0DAA,EAAAC,OAAA,IAAAzI,EAAAwI,EAAAxI,KAAAC,EAAAuI,EAAAvI,MACAA,IACAjC,KAAAqH,WAAAC,SAAAtF,EACAhC,KAAAqH,WAAApF,MAAA,cAAAA,EAAA,aACAjC,KAAA2D,YAAA,EACA3D,KAAA8E,sBCtIoX4F,EAAA,cCOpXC,EAAgB3E,OAAA4E,EAAA,KAAA5E,CACd0E,EACA5K,EACA4F,GACF,EACA,KACA,KACA,MAIemF,EAAA,WAAAF","file":"js/chunk-2d0e2345.ef799e08.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('BasePageHeader',{attrs:{\"title\":\"此包月方案客戶購買紀錄\"},scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('el-button',{staticClass:\"is-round\",attrs:{\"disabled\":!_vm.enabledCreateOrder,\"type\":\"primary\"},on:{\"click\":_vm.handleCreateOrder}},[_vm._v(\"代客購買此包月方案\")])]},proxy:true}])}),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading.fullscreen.lock\",value:(_vm.tryingToGetOrder),expression:\"tryingToGetOrder\",modifiers:{\"fullscreen\":true,\"lock\":true}}],attrs:{\"element-loading-text\":\"取得訂單資訊中\",\"data\":_vm.loadedOrders,\"default-sort\":{ prop: 'created', order: 'descending' },\"row-class-name\":_vm.calcRowClassName},on:{\"row-click\":_vm.tryToGetOrder,\"sort-change\":_vm.sortChange}},[_c('el-table-column',{attrs:{\"label\":\"#訂單編號\",\"prop\":\"created_at\",\"min-width\":\"170\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',[_vm._v(_vm._s((\"#\" + (row.orderNo))))]),_c('div',[_vm._v(_vm._s(_vm._f(\"formatDate\")(row.created,'dateTime')))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"狀態與來源\",\"prop\":\"status\",\"min-width\":\"120\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('BaseStateLabel',{attrs:{\"state\":_vm._f(\"orderStatusFilter\")(row.status,'color'),\"text\":\"\"}},[_vm._v(_vm._s(_vm._f(\"orderStatusFilter\")(row.status,'text')))]),_c('br'),_c('BaseStateLabel',{attrs:{\"state\":\"info\",\"text\":\"\"}},[_vm._v(_vm._s(_vm._f(\"orderSourceFilter\")(row.source)))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"體型\",\"min-width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(_vm._s(row.sizeTitle))]}}])}),_c('el-table-column',{attrs:{\"label\":\"付款方式\",\"min-width\":\"100\",\"prop\":\"paymentMethod\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(_vm._s(_vm._f(\"orderPaymentMethodFilter\")(row.paymentMethod)))]}}])}),_c('el-table-column',{attrs:{\"label\":\"客戶資訊\",\"min-width\":\"120\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(row.fullName)+\" \"+_vm._s(_vm._f(\"genderFilter\")(row.gender)))]),_c('div',[_vm._v(_vm._s(((row.phoneCode) + \" \" + (row.phoneNumber))))])]}}])}),_c('el-table-column',{attrs:{\"min-width\":\"40\"}},[_c('el-tooltip',{attrs:{\"content\":\"查看訂單詳情\",\"placement\":\"top\"}},[_c('el-button',{attrs:{\"type\":\"text\"}},[_c('BaseIcon',{attrs:{\"name\":\"ellipsis-v\"}})],1)],1)],1)],1),_c('BasePagination',{ref:\"pagination\",attrs:{\"current-page\":_vm.currentPage},on:{\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event}}}),_c('el-drawer',{ref:\"drawer\",attrs:{\"visible\":_vm.drawerVisible,\"append-to-body\":\"\",\"size\":_vm.$root.isSmallDevice ? '100%' : '50%',\"destroy-on-close\":true},on:{\"update:visible\":function($event){_vm.drawerVisible=$event}}},[(_vm.drawerMode === 'detail')?[_c('PortalTarget',{attrs:{\"slot\":\"title\",\"name\":\"drawer-prepaid-header\"},slot:\"title\"}),_c('OrderDetail',{ref:\"orderDetail\",attrs:{\"default-value\":_vm.drawerOrderData},on:{\"update:defaultValue\":function($event){_vm.drawerOrderData=$event},\"update:default-value\":function($event){_vm.drawerOrderData=$event},\"update\":_vm.tryToFetchOrder}})]:[_c('PortalTarget',{attrs:{\"slot\":\"title\",\"name\":\"drawer-prepaid-header\"},slot:\"title\"}),_c('h4',[_vm._v(_vm._s(_vm.defaultValue.title))]),_c('h5',[_vm._v(_vm._s(((_vm.defaultValue.times) + \"次\"))),(_vm.selectPrice)?_c('span',[_vm._v(_vm._s((\" / $\" + _vm.selectPrice)))]):_vm._e()]),_c('OrderForm',{attrs:{\"prepaid\":_vm.defaultValue,\"select-price\":_vm.selectPrice},on:{\"update:selectPrice\":function($event){_vm.selectPrice=$event},\"update:select-price\":function($event){_vm.selectPrice=$event},\"store\":_vm.handleUpdateOrders,\"cancel\":_vm.handleCloseDrawer}})]],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport lazyLoadComponent from '@router/lazyload-component'\nimport {\n  genderFilter,\n  orderStatusFilter,\n  orderSourceFilter,\n  orderPaymentMethodFilter,\n} from '@utils/filter-value-to-text'\nimport formatDate from '@utils/format-date'\n\nimport pageMixin from '@src/mixins/pagination'\nimport { PortalTarget } from 'portal-vue'\n\nexport default {\n  components: {\n    PortalTarget,\n    BaseStateLabel: () =>\n      lazyLoadComponent(import('@components/BaseStateLabel')),\n    OrderDetail: () =>\n      lazyLoadComponent(import('@components/PrepaidOrderDetail')),\n    OrderForm: () => import('@components/PrepaidOrderForm'),\n  },\n  filters: {\n    genderFilter,\n    orderStatusFilter,\n    orderSourceFilter,\n    orderPaymentMethodFilter,\n    formatDate,\n  },\n  mixins: [pageMixin],\n  props: {\n    defaultValue: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  data() {\n    return {\n      loadedOrders: [],\n      tryingToGetOrder: false,\n      drawerVisible: false,\n      drawerOrderData: '',\n      drawerMode: 'detail',\n      filterData:{\n        order_by:'created_at',\n        order:'desc'\n      },\n      selectPrice:0\n    }\n  },\n  computed: {\n    enabledCreateOrder() {\n      return (\n        this.defaultValue.infinity === 1 ||\n        (this.defaultValue.infinity === 0 &&\n          this.defaultValue.inventory > this.defaultValue.qty)\n      )\n    },\n  },\n  watch: {\n    currentPage: {\n      handler: 'tryToFetchOrder',\n      immediate: true,\n    },\n    drawerVisible(value){\n      if(!value){\n        this.selectPrice = 0\n      }\n\n    }\n  },\n  methods: {\n    updateDrawerMode(value) {\n      if (this.drawerMode !== value) this.drawerMode = value\n    },\n    calcRowClassName({ row }) {\n      const orderStatus = row.status\n      const orderUsedStatus = row.groupSize / row.usedSize\n\n      if (orderStatus === 0) return 'order--canceled'\n      if (orderUsedStatus === 1) return 'order--used'\n    },\n    async tryToGetOrder(row) {\n      this.tryingToGetOrder = true\n      this.drawerOrderData = await this.$store.dispatch(\n        'prepaid/fetchOrderSingle',\n        row.id\n      )\n      this.tryingToGetOrder = false\n      this.updateDrawerMode('detail')\n      this.drawerVisible = true\n    },\n    async tryToFetchOrder() {\n      // console.log(orderby)\n      const { items, total } = await this.$store.dispatch(\n        'prepaid/fetchOrders',\n        Object.assign(\n          { \n            groupOrdering:this.defaultValue.groupOrdering,\n            // prepaidId: this.defaultValue.id,\n            paymentMethod: 'All',\n            order_by:this.filterData.order_by,\n            order:this.filterData.order,\n          },\n          this.pageQuery\n        )\n      )\n\n      this.loadedOrders = items\n      this.$nextTick(() => {\n        this.$refs.pagination.updateTotal(total)\n      })\n    },\n    handleCreateOrder() {\n      this.updateDrawerMode('add')\n      this.drawerVisible = true\n    },\n    handleCloseDrawer() {\n      this.$refs.drawer.closeDrawer()\n      // this.drawerVisible = false\n    },\n    handleUpdateOrders() {\n      this.$emit('update:defaultValue', {\n        ...this.defaultValue,\n        qty: this.defaultValue.qty + 1,\n      })\n      this.tryToFetchOrder()\n      this.handleCloseDrawer()\n    },\n     sortChange({column, prop, order}){\n      if(order){\n        this.filterData.order_by = prop\n        this.filterData.order = order==='ascending'?'asc':'desc'\n        this.currentPage=1\n        this.tryToFetchOrder()\n      }\n      // console.log(column, prop, order)\n    }\n  },\n}\n</script>\n\n<template>\n  <div>\n    <BasePageHeader title=\"此包月方案客戶購買紀錄\">\n      <template v-slot:right>\n        <el-button\n          class=\"is-round\"\n          :disabled=\"!enabledCreateOrder\"\n          type=\"primary\"\n          @click=\"handleCreateOrder\"\n        >代客購買此包月方案</el-button>\n      </template>\n    </BasePageHeader>\n    <el-table\n      v-loading.fullscreen.lock=\"tryingToGetOrder\"\n      element-loading-text=\"取得訂單資訊中\"\n      :data=\"loadedOrders\"\n      :default-sort=\"{ prop: 'created', order: 'descending' }\"\n      :row-class-name=\"calcRowClassName\"\n      @row-click=\"tryToGetOrder\"\n      @sort-change=\"sortChange\"\n    >\n      <el-table-column v-slot=\"{ row }\" label=\"#訂單編號\" prop=\"created_at\" min-width=\"170\" sortable=\"custom\">\n        <span>{{ `#${row.orderNo}` }}</span>\n        <div>{{ row.created | formatDate('dateTime') }}</div>\n      </el-table-column>\n      <el-table-column v-slot=\"{ row }\" label=\"狀態與來源\" prop=\"status\" min-width=\"120\" sortable=\"custom\">\n        <BaseStateLabel\n          :state=\"row.status | orderStatusFilter('color') \"\n          text\n        >{{ row.status | orderStatusFilter('text') }}</BaseStateLabel>\n        <br />\n        <BaseStateLabel state=\"info\" text>{{ row.source | orderSourceFilter }}</BaseStateLabel>\n      </el-table-column>\n      <el-table-column\n        v-slot=\"{ row }\"\n        label=\"體型\"\n        min-width=\"80\"\n\n\n      >{{ row.sizeTitle }}</el-table-column>\n      <el-table-column\n        v-slot=\"{ row }\"\n        label=\"付款方式\"\n        min-width=\"100\"\n        prop=\"paymentMethod\"\n        sortable=\"custom\"\n      >{{ row.paymentMethod | orderPaymentMethodFilter }}</el-table-column>\n       \n      <el-table-column v-slot=\"{ row }\" label=\"客戶資訊\" min-width=\"120\">\n        <div>{{ row.fullName }} {{ row.gender | genderFilter }}</div>\n        <div>{{ `${row.phoneCode} ${row.phoneNumber}` }}</div>\n      </el-table-column>\n      <el-table-column min-width=\"40\">\n        <el-tooltip content=\"查看訂單詳情\" placement=\"top\">\n          <el-button type=\"text\">\n            <BaseIcon name=\"ellipsis-v\" />\n          </el-button>\n        </el-tooltip>\n      </el-table-column>\n    </el-table>\n    <BasePagination ref=\"pagination\" :current-page.sync=\"currentPage\" />\n    <el-drawer ref=\"drawer\" :visible.sync=\"drawerVisible\" append-to-body :size=\"$root.isSmallDevice ? '100%' : '50%'\" :destroy-on-close=\"true\">\n      <template v-if=\"drawerMode === 'detail'\">\n        <!-- header -->\n        <PortalTarget slot=\"title\" name=\"drawer-prepaid-header\"></PortalTarget>\n        <OrderDetail\n          ref=\"orderDetail\"\n          :default-value.sync=\"drawerOrderData\"\n          @update=\"tryToFetchOrder\"\n        />\n      </template>\n      <template v-else>\n        <PortalTarget slot=\"title\" name=\"drawer-prepaid-header\"></PortalTarget>\n        <h4>{{ defaultValue.title }}</h4>\n        <h5>{{ `${defaultValue.times}次`}}<span v-if=\"selectPrice\">{{` / $${selectPrice}` }}</span></h5>\n        <OrderForm :prepaid=\"defaultValue\" :select-price.sync=\"selectPrice\" @store=\"handleUpdateOrders\" @cancel=\"handleCloseDrawer\" />\n      </template>\n    </el-drawer>\n  </div>\n</template>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailOrders.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailOrders.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailOrders.vue?vue&type=template&id=4654c29f&\"\nimport script from \"./DetailOrders.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailOrders.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}