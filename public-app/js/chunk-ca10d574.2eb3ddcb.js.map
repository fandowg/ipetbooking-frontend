{"version":3,"sources":["webpack:///./src/router/views/notification/listContent.vue?ce4e","webpack:///./src/router/views/notification/listContent.vue?075b","webpack:///src/router/views/notification/listContent.vue","webpack:///./src/router/views/notification/listContent.vue?68be","webpack:///./src/router/views/notification/listContent.vue?f334","webpack:///./src/router/views/notification/listContent.vue?93e2"],"names":["module","exports","slide","slide-reverse","page","card-wrapper","footer","listContentSection","render","_vm","this","_h","$createElement","_c","_self","ref","class","$style","employeeBox","isEmployee","attrs","stretch","type","model","value","callback","$$v","activeTab","expression","_l","tab","index","key","name","slot","_v","_s","title","readData","readType","staticClass","_e","activeList","length","staticStyle","padding","item","i","on","update","tryToFetchPushes","directives","rawName","height","isListEnd","staticRenderFns","listContentvue_type_script_lang_js_","components","ListItem","Object","lazyload_component","__webpack_require__","e","then","bind","filters","genderFilter","filter_value_to_text","mixins","pagination","props","Boolean","default","data","tabList","freeze","tryingPush","next_cursor","normal","system","computed","objectSpread","vuex_esm","list","normalPushes","systemPushes","watch","created","$store","commit","clearUnRead","mounted","$refs","notification","style","concat","window","innerHeight","addEventListener","onScroll","$route","methods","_tryToFetchPushes","asyncToGenerator","regenerator_default","a","mark","_callee","nextCursorRequest","nextCursorResponse","wrap","_context","prev","next","fetchPushes","sent","stop","apply","arguments","bottomOfWindow","scrollHeight","scrollTop","notification_listContentvue_type_script_lang_js_","injectStyles","context","listContentvue_type_style_index_0_lang_scss_module_true_","locals","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_listContent_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_listContent_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-ca10d574.2eb3ddcb.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"slide\":\"listContent_slide_2NzGm\",\"slide-reverse\":\"listContent_slide-reverse_3aDkB\",\"page\":\"listContent_page_1UPYs\",\"card-wrapper\":\"listContent_card-wrapper_3ue96\",\"footer\":\"listContent_footer_3qxfR\",\"listContentSection\":\"listContent_listContentSection_X8UIy\"};","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"notification\",class:[_vm.$style.listContentSection,{ 'employeeBox': _vm.isEmployee }]},[_c('el-tabs',{attrs:{\"stretch\":\"\",\"type\":\"border-card\"},model:{value:(_vm.activeTab),callback:function ($$v) {_vm.activeTab=$$v},expression:\"activeTab\"}},_vm._l((_vm.tabList),function(tab,index){return _c('el-tab-pane',{key:index,attrs:{\"name\":tab.type}},[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(_vm._s(tab.title)+\" \"),(_vm.readData[tab.readType] !== 0 && _vm.readData[tab.readType])?_c('span',[_vm._v(\"(\"),_c('span',{staticClass:\"hidden-mobile\"},[_vm._v(\"未讀\")]),_vm._v(_vm._s(_vm.readData[tab.readType])+\")\")]):_vm._e()]),(_vm.activeList.length === 0)?_c('p',{staticStyle:{\"padding\":\"35px 30px\"}},[_vm._v(\"尚未有任何通知\")]):_vm._e(),_c('div',[_vm._l((_vm.activeList),function(item,i){return _c('ListItem',{key:i,attrs:{\"item\":item,\"index\":i,\"type\":tab.type},on:{\"update\":_vm.tryToFetchPushes}})}),(_vm.tryingPush)?_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.tryingPush),expression:\"tryingPush\"}],staticStyle:{\"height\":\"80px\"}}):_vm._e()],2),(_vm.isListEnd[tab.type])?_c('div',{staticClass:\"listEnd\"},[_vm._v(\"已經到最後囉\")]):_vm._e()])}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport lazyLoadComponent from '@router/lazyload-component'\nimport { genderFilter, orderStatusMap } from '@utils/filter-value-to-text'\nimport pageMixin from '@src/mixins/pagination'\nimport { mapState, mapGetters, mapActions } from 'vuex'\n\nexport default {\n  components: {\n    ListItem: () => lazyLoadComponent(import('./components/ListItem')),\n  },\n  filters: {\n    genderFilter,\n  },\n  mixins: [pageMixin],\n  props: {\n    isEmployee:{\n      type:Boolean,\n      default:false\n    }\n  },\n  data() {\n    return {\n      activeTab: 'normal',\n      // activeList:[],\n      tabList: Object.freeze([\n        {\n          title: '一般通知',\n          type:'normal',\n          readType: 'unRead',\n          // listType:'normalPushes'\n          // component: () => lazyLoadComponent(import('./TabIncome')),\n        },\n        {\n          title: '系統公告',\n          type:'system',\n          readType: 'sysUnRead',\n          // listType:'systemPushes'\n          // component: () => lazyLoadComponent(import('./TabSell')),\n        },\n      ]),\n      tryingPush: false,\n      next_cursor: {\n        normal:null,\n        system:null\n      },\n      isListEnd:{\n        normal:false,\n        system:false\n      }\n      // pushList:[],\n      // readData:{},\n    }\n  },\n  computed: {\n    ...mapState('push', ['readData','normalPushes','systemPushes']),\n    // ...mapGetters('push', ['normalPushes', 'systemPushes']),\n    // normalPushes(){\n    //   return this.pushList.filter(item =>{\n    //     return item.type !== 'PushSystemPostEvent'\n    //   })\n    // },\n    // systemPushes(){\n    //   return this.pushList.filter(item =>{\n    //     return item.type === 'PushSystemPostEvent'\n    //   })\n    // },\n    activeList() {\n      let list = []\n      if (this.activeTab === 'normal') {\n        list = this.normalPushes\n      } else {\n        list = this.systemPushes\n      }\n      return list\n    },\n  },\n  watch: {},\n  created() {\n    this.$store.commit('push/CLEAR_PUSHES')\n    this.tryToFetchPushes()\n    // 已在通知頁面，所以清空狀態\n    this.clearUnRead()\n  },\n  \n  mounted() {\n    // console.log(this.$refs.notification)\n    this.$refs.notification.style.height=`${window.innerHeight - 0}px`\n    this.$refs.notification.addEventListener('scroll', this.onScroll)\n    if(this.$route.name==='notification'){\n      // document.getElementById('app').addEventListener('scroll', this.onScroll)\n      // document.querySelector('.eee').addEventListener('scroll', this.onScroll)\n    }\n   \n  //  console.log(document.getElementById('app').scrollTop)\n  //  document.getElementById('app').onscroll()\n  },\n  // beforedestroy(){\n  //   document.getElementById('app').removeEventListener('scroll', this.onScroll)\n  // },\n  methods: {\n    ...mapActions('push', ['fetchPushes','clearUnRead']),\n\n    async tryToFetchPushes() {\n      this.tryingPush = true\n      const nextCursorRequest = this.next_cursor[this.activeTab]\n      // console.log(nextCursorRequest)\n      const nextCursorResponse = await this.fetchPushes({\n        type:this.activeTab,\n        nextCursorRequest\n      })\n      // console.log(next_cursor)\n      if(nextCursorResponse.normal!=='not'){\n        this.next_cursor.normal = nextCursorResponse.normal\n      }\n      if(nextCursorResponse.system!=='not'){\n        this.next_cursor.system = nextCursorResponse.system\n      }\n      // this.next_cursor[this.activeTab] = nextCursorResponse\n      this.tryingPush = false\n\n      \n\n    },\n    // installScroll() {\n    //   document.addEventListener('scroll', this.onScroll)\n    // },\n    onScroll() {\n      // console.log('scroll')\n      let bottomOfWindow = this.$refs.notification.scrollHeight  - this.$refs.notification.scrollTop < window.innerHeight + 20\n      // console.log(this.next_cursor[this.activeTab])\n      // console.log(this.$refs.notification.scrollHeight ,this.$refs.notification.scrollTop ,window.innerHeight,bottomOfWindow)\n      // console.log(this.next_cursor[this.activeTab],bottomOfWindow,this.tryingPush)\n      if (this.next_cursor[this.activeTab] && bottomOfWindow && !this.tryingPush) {\n        // console.log('取資料')\n        this.tryToFetchPushes()\n      }\n      if(!this.next_cursor[this.activeTab]){\n        this.isListEnd[this.activeTab] = true\n      }\n    },\n  },\n}\n</script>\n<template>\n  <div ref=\"notification\" :class=\"[$style.listContentSection,{ 'employeeBox': isEmployee }]\">\n    <el-tabs v-model=\"activeTab\"  stretch type=\"border-card\">\n      <el-tab-pane v-for=\"(tab, index) in tabList\" :key=\"index\" :name=\"tab.type\">\n        <span slot=\"label\"\n          >{{ tab.title }} <span v-if=\"readData[tab.readType] !== 0 && readData[tab.readType]\">(<span class=\"hidden-mobile\">未讀</span>{{ readData[tab.readType] }})</span>\n        </span>\n        <p v-if=\"activeList.length === 0\" style=\"padding: 35px 30px\">尚未有任何通知</p>\n        <div  >\n          <ListItem v-for=\"(item, i) in activeList\"  :key=\"i\" :item=\"item\" :index=\"i\" :type=\"tab.type\" @update=\"tryToFetchPushes\" />\n          \n          <div v-if=\"tryingPush\" v-loading=\"tryingPush\" style=\"height:80px\"></div>\n        </div>\n        <div v-if=\"isListEnd[tab.type]\" class=\"listEnd\" >已經到最後囉</div>\n      </el-tab-pane>\n    </el-tabs>\n  </div>\n</template>\n\n<style lang=\"scss\" module>\n@import '@src/design/layout_detail_steps.scss';\n.listContentSection {\n  overflow-y:scroll;\n  padding-top: 90px;\n  &:global {\n    &.employeeBox{\n      padding-top: 120px;\n      padding-top: calc(constant(safe-area-inset-top) + 120px);\n      padding-top: calc(env(safe-area-inset-top) + 120px);\n      @include touch {\n        margin-top: 0;\n        padding-top: 90px;\n        padding-top: calc(constant(safe-area-inset-top) + 90px);\n        padding-top: calc(env(safe-area-inset-top) + 90px);\n        padding-bottom: 100px;\n        padding-bottom: calc(constant(safe-area-inset-bottom) + 100px);\n        padding-bottom: calc(env(safe-area-inset-bottom) + 100px);\n      }\n    }\n  }\n  @include touch {\n    // margin-top: 60px;\n  }\n  :global {\n    .el-tabs--border-card{\n      @include touch {\n        box-shadow:none ;\n      }\n    }\n    .scroll-box{\n      overflow-y:scroll\n    }\n    .el-tabs__content {\n      padding: 0 !important;\n    }\n    .listEnd{\n      background:#F9FAFB;\n      text-align:center;\n      padding:10px 0;\n      @include touch {\n        background:none;\n        border-top: $color-border-base 1px solid;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./listContent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./listContent.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./listContent.vue?vue&type=template&id=046a7cb4&\"\nimport script from \"./listContent.vue?vue&type=script&lang=js&\"\nexport * from \"./listContent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./listContent.vue?vue&type=style&index=0&lang=scss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./listContent.vue?vue&type=style&index=0&lang=scss&module=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./listContent.vue?vue&type=style&index=0&lang=scss&module=true&\""],"sourceRoot":""}