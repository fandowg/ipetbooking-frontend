(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8e17bd6"],{"9d74":function(t,e,a){"use strict";var i=a("abdd"),s=a.n(i);e["default"]=s.a},abdd:function(t,e,a){t.exports={slide:"DetailPets_slide_IZ9Gb","slide-reverse":"DetailPets_slide-reverse_1uPQ8",petListImg:"DetailPets_petListImg_3Xj2O",pet:"DetailPets_pet_3Ma2S"}},b155:function(t,e,a){"use strict";a.d(e,"a",function(){return i});var i={personality:[{title:"粘人",name:"clingy"},{title:"膽小",name:"timid"},{title:"親人",name:"nice"},{title:"活潑",name:"lively"},{title:"怕生",name:"shy"},{title:"討厭同類",name:"hate-same"}],healthy:[{title:"關節疾病",name:"joint-disease",text:""},{title:"皮膚疾病",name:"skin-condition",text:""},{title:"過敏反應",name:"allergy",text:""},{title:"其他疾病",name:"other",text:""}],behavior:[{title:"分離焦慮症",name:"SAD",text:""},{title:"攻擊過家人",name:"attack-familly",text:""},{title:"攻擊陌生人",name:"attack-stranger",text:""},{title:"攻擊過同類",name:"attack-same",text:""},{title:"被同類咬過",name:"be-attacked",text:""}],vaccine:0}},b755:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("BasePageHeader",{attrs:{title:"寵物管理"},scopedSlots:t._u([{key:"title",fn:function(){return[t.showDetail?t._e():a("span",[t._v("寵物管理")]),t.showDetail?a("span",[t._v("寵物資料")]):t._e()]},proxy:!0},{key:"right",fn:function(){return[t.showDetail?t._e():a("el-button",{staticClass:"is-round",attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[a("BaseIcon",{attrs:{name:"plus"}}),a("span",[t._v("新增")])],1)]},proxy:!0}])}),t.showDetail?[a("div",{staticClass:"pet__back",staticStyle:{"margin-bottom":"20px"},on:{click:t.backToList}},[a("i",{staticClass:"el-icon-back"}),t._v(" 返回寵物列表")]),a("el-tabs",{attrs:{stretch:"",type:"border-card"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"寵物資訊",name:"1"}},[a("div",{class:t.$style.pet},[a("div",{staticClass:"top"},[a("div",[t.editDetailEnabled?[a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:function(e){t.editDetailEnabled=!1}}},[a("BaseIcon",{attrs:{name:"times"}}),t._v(" 取消")],1),a("el-button",{staticClass:"is-round",attrs:{size:"mini",type:"primary"},on:{click:t.tryToSave}},[a("BaseIcon",{attrs:{name:"check"}}),t._v(" 儲存")],1)]:[a("el-button",{staticClass:"is-round",attrs:{size:"mini",disabled:t.tryingGet},on:{click:t.openEdit}},[a("span",[t._v("編輯")])])]],2)]),a("div",{staticClass:"pet__box"},[a("el-form",{ref:"form",staticClass:"el-form--floating",attrs:{model:t.submitData,rules:t.submitRules,"label-position":"left","validate-on-rule-change":!1,"label-width":"100px"}},[a("el-row",{staticStyle:{"margin-bottom":"30px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"pet__avatar"},[a("BaseUpload",{directives:[{name:"loading",rawName:"v-loading",value:t.tryingGet,expression:"tryingGet"}],attrs:{resource:"pet",circle:"",dir:"pet"},on:{sendSuccess:t.uploadToStore},model:{value:t.singlePetData.avatar,callback:function(e){t.$set(t.singlePetData,"avatar",e)},expression:"singlePetData.avatar"}})],1)]),a("el-col",{attrs:{span:14}},[t.editDetailEnabled?[a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{prop:"name",label:"寵物名"}},[a("el-input",{attrs:{placeholder:"請輸入寵物名"},model:{value:t.submitData.name,callback:function(e){t.$set(t.submitData,"name",e)},expression:"submitData.name"}})],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"類別",prop:"categoryId"}},[a("el-select",{on:{change:t.changeCategory},model:{value:t.submitData.categoryId,callback:function(e){t.$set(t.submitData,"categoryId",e)},expression:"submitData.categoryId"}},t._l(t.category,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.title}})}),1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"體型",prop:"sizeId"}},[a("el-select",{model:{value:t.submitData.sizeId,callback:function(e){t.$set(t.submitData,"sizeId",e)},expression:"submitData.sizeId"}},t._l(t.category[t.parentCategoryIndex].children,function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{prop:"breed",label:"品種"}},[a("el-input",{attrs:{placeholder:"請輸入品種"},model:{value:t.submitData.breed,callback:function(e){t.$set(t.submitData,"breed",e)},expression:"submitData.breed"}})],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"性別"}},[a("el-select",{model:{value:t.submitData.gender,callback:function(e){t.$set(t.submitData,"gender",e)},expression:"submitData.gender"}},[a("el-option",{attrs:{label:"母",value:"female"}}),a("el-option",{attrs:{label:"公",value:"male"}})],1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"生日"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd"},model:{value:t.submitData.birthday,callback:function(e){t.$set(t.submitData,"birthday",e)},expression:"submitData.birthday"}})],1)]:[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tryingGet,expression:"tryingGet"}],staticClass:"pet__info"},[a("ul",{staticClass:"pet__info__list"},[a("li",{staticClass:"pet__info__item"},[t._v("寵物名"),a("span",{staticClass:"danger"},[t._v("*")]),t._v("："+t._s(t.singlePetData.name))]),a("li",{staticClass:"pet__info__item"},[t._v("類別"),a("span",{staticClass:"danger"},[t._v("*")]),t._v("："+t._s(t.singlePetData.categoryTitle))]),a("li",{staticClass:"pet__info__item"},[t._v("體型"),a("span",{staticClass:"danger"},[t._v("*")]),t._v("："+t._s(t.singlePetData.sizeTitle))]),a("li",{staticClass:"pet__info__item"},[t._v("品種："+t._s(t.singlePetData.breed))]),a("li",{staticClass:"pet__info__item"},[t._v("\n                          \n                            性別：\n                          "),t.singlePetData.gender?a("span",[t._v("\n                            "+t._s("male"===t.singlePetData.gender?"公":"母")+"\n                          ")]):t._e()]),a("li",{staticClass:"pet__info__item"},[t._v("生日："+t._s(t.singlePetData.birthday))])])])]],2)],1),a("div",{staticClass:"notice"},[a("h5",[t._v("寵物問題：")]),t.editDetailEnabled?[a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"個性"}},[a("el-checkbox-group",{model:{value:t.submitData.questions.personality,callback:function(e){t.$set(t.submitData.questions,"personality",e)},expression:"submitData.questions.personality"}},t._l(t.questions.personality,function(e){return a("el-checkbox",{key:e.name,attrs:{label:e.title}},[t._v(t._s(e.title))])}),1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"健康狀況"}},[a("el-checkbox-group",{model:{value:t.healthy,callback:function(e){t.healthy=e},expression:"healthy"}},[t._l(t.questions.healthy,function(e){return[a("el-checkbox",{key:e.name,attrs:{label:e.title}},[t._v(t._s(e.title))]),t.healthy.includes("其他疾病")&&"other"===e.name?a("el-input",{key:e.title,attrs:{placeholder:"請填寫其他疾病"},model:{value:e.text,callback:function(a){t.$set(e,"text",a)},expression:"item.text"}}):t._e()]})],2)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"行為"}},[a("el-checkbox-group",{model:{value:t.behavior,callback:function(e){t.behavior=e},expression:"behavior"}},[t._l(t.questions.behavior,function(e){return[a("div",{key:e.title,staticClass:"inline-checkbox-input"},[a("el-checkbox",{key:e.name,attrs:{label:e.title}},[t._v(t._s(e.title))]),a("el-input",{model:{value:e.text,callback:function(a){t.$set(e,"text",a)},expression:"item.text"}})],1)]})],2)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"疫苗"}},[a("el-radio",{attrs:{label:1},model:{value:t.submitData.questions.vaccine,callback:function(e){t.$set(t.submitData.questions,"vaccine",e)},expression:"submitData.questions.vaccine"}},[t._v("1 劑")]),a("el-radio",{attrs:{label:2},model:{value:t.submitData.questions.vaccine,callback:function(e){t.$set(t.submitData.questions,"vaccine",e)},expression:"submitData.questions.vaccine"}},[t._v("2 劑")]),a("el-radio",{attrs:{label:3},model:{value:t.submitData.questions.vaccine,callback:function(e){t.$set(t.submitData.questions,"vaccine",e)},expression:"submitData.questions.vaccine"}},[t._v("3 劑")])],1)]:[t.singlePetData.questions?a("ul",{staticClass:"pet__info__list"},[a("li",{staticClass:"pet__info__item"},[t._v("個性："+t._s(t.personalityContent?t.personalityContent:"未填寫"))]),a("li",{staticClass:"pet__info__item"},[t._v("健康狀況："+t._s(t.healthyContent?t.healthyContent:"未填寫"))]),a("li",{staticClass:"pet__info__item indentList"},[a("span",{staticClass:"title"},[t._v("行為：")]),t.behaviorContent.length>0?[a("span",{staticClass:"content"},t._l(t.behaviorContent,function(e){return a("span",{key:e,staticClass:"content__item"},[t._v(t._s(e))])}),0)]:a("span",[t._v("未填寫")])],2),a("li",{staticClass:"pet__info__item"},[t._v("疫苗："+t._s(t.singlePetData.questions.vaccine?t.vaccineContent:"未填寫"))])]):t._e()]],2),a("div",{staticClass:"notice"},[a("h5",[t._v("內部備註：")]),t.editDetailEnabled?[a("el-form-item",{attrs:{label:"","label-width":"0"}},[a("el-input",{attrs:{type:"textarea",rows:2},model:{value:t.submitData.note,callback:function(e){t.$set(t.submitData,"note",e)},expression:"submitData.note"}})],1)]:[a("div",[t._v(" "+t._s(t.singlePetData.note))])]],2)],1)],1)])]),a("el-tab-pane",{attrs:{label:"寵物備註",name:"2"}},[t.singlePetData.id?a("PetCommentList",{ref:"commentAll",attrs:{order:void 0,pet:t.singlePetData.id,type:"pet"}}):t._e()],1)],1)]:[a("div",{staticClass:"el-table-wrapper"},[a("div",{on:{click:function(t){t.stopPropagation()}}},[a("el-table",{attrs:{data:t.petList,"element-loading-text":"取得寵物資訊中"},on:{"row-click":t.gotoSinglePet}},[a("el-table-column",{attrs:{label:"寵物頭像","min-width":12},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",{class:t.$style.petListImg},[a("img",{attrs:{src:i.avatar,alt:""}})])]}}],null,!1,1213523003)}),a("el-table-column",{attrs:{prop:"name",label:"寵物名字","min-width":12}}),a("el-table-column",{attrs:{prop:"categoryTitle",label:"種類","min-width":8}}),a("el-table-column",{attrs:{prop:"sizeTitle",label:"體型","min-width":12}}),a("el-table-column",{attrs:{width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tooltip",{attrs:{content:"刪除",placement:"top"}},[a("el-button",{staticClass:"is-round",attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.tryToRemove(i.id)}}},[a("BaseIcon",{attrs:{name:"trash-alt"}})],1)],1),a("el-tooltip",{attrs:{content:"查看寵物資訊",placement:"top"}},[a("el-button",{attrs:{type:"text"}},[a("BaseIcon",{attrs:{name:"ellipsis-v"}})],1)],1)]}}],null,!1,2389776e3)})],1)],1)])],a("BaseButtonDialog",{attrs:{title:"寵物資料","only-dialog":"","dialog-visible":t.dialogVisible,floating:""},on:{"update:dialogVisible":function(e){t.dialogVisible=e},"update:dialog-visible":function(e){t.dialogVisible=e},opened:function(e){return t.openDialog("add")}}},[a("PetForm",{attrs:{"default-value":t.defaultValue,category:t.category},on:{close:t.closeDialog}})],1)],2)},s=[],n=a("9395"),l=a("4795"),o=a.n(l),r=a("cb0c"),c=a("a315"),u=a("62d4"),h=a("2ef0"),m=a("b155"),b={components:{BaseButtonDialog:u["default"],BaseUpload:function(){return Object(c["a"])(a.e("chunk-3559b494").then(a.bind(null,"0ac6")))},PetForm:function(){return Object(c["a"])(a.e("chunk-b0d2da58").then(a.bind(null,"eae8")))},PetCommentList:function(){return Object(c["a"])(Promise.all([a.e("chunk-0badaf9f"),a.e("chunk-838dbece")]).then(a.bind(null,"7d95")))}},props:{defaultValue:{type:Object,default:function(){}}},data:function(){return{questions:Object(h["cloneDeep"])(m["a"]),petList:[],dialogItem:{},submitData:{questions:{personality:[],healthy:[],behavior:[],vaccine:0}},behavior:[],healthy:[],singlePetData:{},dialogMode:"edit",dialogVisible:!1,showDetail:!1,editDetailEnabled:!1,category:[],parentCategoryIndex:0,tryingGet:!1,activeTab:"1"}},computed:{submitRules:function(){return{avatar:[{required:!0,message:"請上傳頭像",trigger:"change"}],name:[{required:!0,message:"請填寫寵物名",trigger:"blur"}],categoryId:[{required:!0,message:"請選擇類別",trigger:"blur"}],sizeId:[{required:!0,message:"請選擇體型",trigger:"blur"}],gender:[{required:!0,message:"請選擇性別",trigger:"change"}],birthday:[{required:!0,message:"請選擇生日",trigger:"blur"}]}},personalityContent:function(){return this.singlePetData.questions.personality.join("，")},healthyContent:function(){var t=this.singlePetData.questions.healthy.map(function(t){return"".concat(t.title).concat(t.text?" ( ":""," ").concat(t.text?t.text:"").concat(t.text?" )":"")});return t.join("，")},behaviorContent:function(){var t=this.singlePetData.questions.behavior.map(function(t){return"".concat(t.title).concat(t.text?" ( ":""," ").concat(t.text?t.text:"").concat(t.text?" )":"")});return t},vaccineContent:function(){var t="";switch(this.singlePetData.questions.vaccine){case 1:t="1 劑";break;case 2:t="2 劑";break;case 3:t="3 劑";break;default:break}return t}},watch:{"submitData.categoryId":function(){this.getParentCategoryIndex()},behavior:function(t){var e=this;t.length>0&&this.submitData.questions.behavior?this.submitData.questions.behavior=t.map(function(t){var a=e.questions.behavior.find(function(e){return e.title===t});return a}):0===t.length&&this.submitData.questions.behavior&&(this.submitData.questions.behavior=[])},healthy:function(t){var e=this;t.length>0&&this.submitData.questions.healthy?this.submitData.questions.healthy=t.map(function(t){var a=e.questions.healthy.find(function(e){return e.title===t});return a}):0===t.length&&this.submitData.questions.healthy&&(this.submitData.questions.healthy=[])}},created:function(){this.tryToFetchList(),this.tryToFetchCategory()},methods:{tryToFetchCategory:function(){var t=Object(r["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("product/fetchServiceCategory");case 2:this.category=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),tryToFetchList:function(){var t=Object(r["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("member/fetchPetList",{memberId:this.$route.params.memberId});case 2:this.petList=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),gotoSinglePet:function(){var t=Object(r["a"])(o.a.mark(function t(e,a,i){var s,n;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.showDetail=!0,this.tryingGet=!0,t.next=4,this.$store.dispatch("member/fetchSinglePet",{memberId:this.$route.params.memberId,petId:e.id});case 4:s=t.sent,n=s.items,this.singlePetData=n,this.getDefaultQuestion(),this.tryingGet=!1;case 9:case"end":return t.stop()}},t,this)}));return function(e,a,i){return t.apply(this,arguments)}}(),tryToFetchSinglePet:function(){var t=Object(r["a"])(o.a.mark(function t(){var e,a;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.tryingGet=!0,t.next=3,this.$store.dispatch("member/fetchSinglePet",{memberId:this.$route.params.memberId,petId:this.singlePetData.id});case 3:e=t.sent,a=e.items,this.singlePetData=a,this.getDefaultQuestion(),this.tryingGet=!1;case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getDefaultQuestion:function(){this.questions.behavior.forEach(function(t){t.text=""}),this.questions.healthy.forEach(function(t){t.text=""}),this.singlePetData.questions?(this.behavior=this.singlePetData.questions.behavior.map(function(t){return t.title}),this.healthy=this.singlePetData.questions.healthy.map(function(t){return t.title})):(this.behavior=[],this.healthy=[])},openDialog:function(t,e){this.behavior=[],this.healthy=[],this.questions.behavior.forEach(function(t){t.text=""}),this.questions.healthy.forEach(function(t){t.text=""}),this.dialogVisible=!0,this.dialogMode=t,this.$set(this.$data,"dialogItem",e)},closeDialog:function(){this.dialogVisible=!1,this.tryToFetchList()},tryToRemove:function(){var t=Object(r["a"])(o.a.mark(function t(e){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("確定刪除該寵物？","警告",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning",center:!0});case 2:return t.prev=2,t.next=5,this.$store.dispatch("member/removehPet",{memberId:this.$route.params.memberId,ids:[e]});case 5:this.tryToFetchList();case 6:return t.prev=6,t.finish(6);case 8:case"end":return t.stop()}},t,this,[[2,,6,8]])}));return function(e){return t.apply(this,arguments)}}(),openEdit:function(){var t=this;this.editDetailEnabled=!0,this.submitData=Object(n["a"])({},this.singlePetData),this.submitData.questions?(this.submitData.questions.behavior.forEach(function(e){t.questions.behavior.forEach(function(t){e.title===t.title&&(t.text=e.text)})}),this.submitData.questions.healthy.forEach(function(e){t.questions.healthy.forEach(function(t){e.title===t.title&&(t.text=e.text)})})):this.submitData=Object(n["a"])({},this.submitData,{questions:{personality:[],healthy:[],behavior:[],vaccine:""}}),this.getParentCategoryIndex()},tryToSave:function(){var t=Object(r["a"])(o.a.mark(function t(){var e=this;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.submitData.questions&&(this.submitData.questions.behavior.forEach(function(t){e.questions.behavior.forEach(function(e){t.title===e.title&&(t.text=e.text)})}),this.submitData.questions.healthy.forEach(function(t){e.questions.healthy.forEach(function(e){t.title===e.title&&(t.text=e.text)})})),t.next=3,this.$store.dispatch("member/storeSinglePet",this.submitData);case 3:this.tryToFetchSinglePet(),this.editDetailEnabled=!1;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),backToList:function(){this.showDetail=!1,this.editDetailEnabled=!1,this.submitData={questions:{personality:[],healthy:[],behavior:[]}},this.singlePetData={},this.tryToFetchList()},getParentCategoryIndex:function(){var t=this;this.category.forEach(function(e,a){t.submitData.categoryId===e.id&&(t.parentCategoryIndex=a)})},changeCategory:function(){this.submitData.sizeId=""},uploadToStore:function(){var t=this;this.submitData=Object(n["a"])({},this.singlePetData),this.submitData.questions?(this.submitData.questions.behavior.forEach(function(e){t.questions.behavior.forEach(function(t){e.title===t.title&&(t.text=e.text)})}),this.submitData.questions.healthy.forEach(function(e){t.questions.healthy.forEach(function(t){e.title===t.title&&(t.text=e.text)})})):this.submitData=Object(n["a"])({},this.submitData,{questions:{personality:[],healthy:[],behavior:[]}}),this.tryToSave()}}},d=b,p=a("9d74"),f=a("2877");function v(t){this["$style"]=p["default"].locals||p["default"]}var g=Object(f["a"])(d,i,s,!1,v,null,null);e["default"]=g.exports}}]);
//# sourceMappingURL=chunk-c8e17bd6.947c3293.js.map