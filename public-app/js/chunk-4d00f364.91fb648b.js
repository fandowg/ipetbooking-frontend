(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d00f364"],{"044d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",[a("div",{staticStyle:{"margin-bottom":"60px"}},[t.isEditMode?[a("el-page-header",{staticClass:"headNoAfter",attrs:{title:"返回列表"},on:{back:t.backToList}}),a("el-tabs",{attrs:{stretch:"","before-leave":t.beforeTabSwitch,type:"border-card"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabList,function(e,i){return a("el-tab-pane",{key:i,attrs:{label:e.title,name:e.name}},[a(e.component,{ref:e.name,refInFor:!0,tag:"component",attrs:{"default-value":t.submitData,"category-index":t.parentCategoryIndex,"category-id":t.parentCategoryId,products:t.products,category:t.category},on:{"update:defaultValue":function(e){t.submitData=e},"update:default-value":function(e){t.submitData=e},"update:categoryIndex":function(e){t.parentCategoryIndex=e},"update:category-index":function(e){t.parentCategoryIndex=e},"update:categoryId":function(e){t.parentCategoryId=e},"update:category-id":function(e){t.parentCategoryId=e},store:t.tryToStore,update:t.tryToFetchSingle}})],1)}),1),a("div",{class:t.$style.footer},[a("el-button",{staticClass:"is-round",on:{click:t.backToList}},[t._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{type:"primary","data-tour-step":"5","data-tour-text":"最後別忘記按下「完成」，完成此方案新增了唷！",loading:t.tryingToStore,disabled:t.tryingToStore},on:{click:t.tryToStore}},[t.tryingToStore?t._e():a("BaseIcon",{attrs:{name:"check"}}),a("span",[t._v(t._s(t.isEditMode?"儲存":"建立"))])],1)],1)]:[a("BaseSteps",{attrs:{active:t.activeStep,list:t.tabList}}),a("el-card",{class:t.$style["card-wrapper"]},[a("keep-alive",[a(t.tabList[t.activeStep-1].component,{ref:t.tabList[t.activeStep-1].name,tag:"component",attrs:{"default-value":t.submitData,"category-index":t.parentCategoryIndex,"category-id":t.parentCategoryId,products:t.products,category:t.category},on:{"update:defaultValue":function(e){t.submitData=e},"update:default-value":function(e){t.submitData=e},"update:categoryIndex":function(e){t.parentCategoryIndex=e},"update:category-index":function(e){t.parentCategoryIndex=e},"update:categoryId":function(e){t.parentCategoryId=e},"update:category-id":function(e){t.parentCategoryId=e},store:t.tryToStore}})],1),a("div",{class:t.$style.footer},[a("el-button",{staticClass:"is-round",on:{click:t.backToList}},[t._v("取消")]),1!==t.activeStep?a("el-button",{staticClass:"is-round",on:{click:t.goBack}},[t._v("上一步")]):t._e(),3!==t.activeStep?a("el-button",{staticClass:"is-round",attrs:{"data-tour-text":"若欄位皆已填寫完成，點擊「下一步」儲存此步驟填寫的資料，前往下一步",type:"primary",loading:t.tryingNextStep},on:{click:function(e){return t.onClickNextStep(t.activeStep)}}},[t._v("\n          "+t._s("下一步")+"\n        ")]):t._e(),3===t.activeStep?a("el-button",{staticClass:"is-round",attrs:{type:"primary","data-tour-step":"5","data-tour-text":"最後別忘記按下「完成」，完成此方案新增了唷！",loading:t.tryingToStore,disabled:t.tryingToStore},on:{click:t.tryToStore}},[t.tryingToStore?t._e():a("BaseIcon",{attrs:{name:"check"}}),a("span",[t._v(t._s(t.isEditMode?"儲存":"建立"))])],1):t._e()],1)],1)]],2)])},r=[],n=a("4795"),c=a.n(n),o=a("cb0c"),s=a("a315"),u=a("444f"),d=a("3fa5"),p=(a("df73"),a("21ac")),l=function(){return{title:"",alias:"",introtext:"",description:"",content:"",notice:"",images:[]}},h={page:{title:"服務項目",meta:[{name:"description",content:"Prepaid List"}]},components:{Layout:u["a"],BaseSteps:function(){return a.e("chunk-b75e1fe6").then(a.bind(null,"f49e"))}},props:{products:{type:Array,required:!0},category:{type:Array,required:!0},defaultValue:{type:Object,default:function(){return l()}}},data:function(){var t=Object.assign({},l(),this.defaultValue,{description:this.defaultValue.description&&this.defaultValue.description.replace(/<br\s\/>/g,""),content:this.defaultValue.content&&this.defaultValue.content.replace(/<br\s\/>/g,""),notice:this.defaultValue.notice&&this.defaultValue.notice.replace(/<br\s\/>/g,"")});return{cacheData:{},submitData:t,tryingToStore:!1,parentCategoryId:null,parentCategoryIndex:0,tabList:Object.freeze([{title:"基本資訊",name:"info",component:function(){return Object(s["a"])(a.e("chunk-0bea79e8").then(a.bind(null,"6924")))}},{title:"價格設定",name:"price",component:function(){return Object(s["a"])(a.e("chunk-42e94286").then(a.bind(null,"092e")))}},{title:"服務項目圖片",name:"image",component:function(){return Object(s["a"])(a.e("chunk-2835c534").then(a.bind(null,"ad46")))}}]),activeTab:"info",activeStep:1,tryingNextStep:!1}},computed:{isEditMode:function(){return this.defaultValue.groupOrdering},isService:function(){return"addition"!==this.$route.params.type}},watch:{},created:function(){this.isEditMode&&this.findCategory(),this.isService||(this.isEditMode?this.$route.meta.title="編輯加購項目":this.$route.meta.title="新增加購項目"),this.isService&&(this.isEditMode?this.$route.meta.title="編輯服務項目":this.$route.meta.title="新增服務項目")},mounted:function(){},methods:{setSubmitData:function(){var t=Object.assign({},l(),this.cacheData,{description:this.cacheData.description&&this.cacheData.description.replace(/<br\s\/>/g,""),content:this.cacheData.content&&this.cacheData.content.replace(/<br\s\/>/g,""),notice:this.cacheData.notice&&this.cacheData.notice.replace(/<br\s\/>/g,"")});this.submitData=t},tryToFetchSingle:function(){var t=Object(o["a"])(c.a.mark(function t(){var e;return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.isService?"product/fetchSingleServicePriceGroup":"product/fetchSingleAdditionalPriceGroup",t.next=3,this.$store.dispatch("".concat(e),this.submitData.groupOrdering);case 3:this.cacheData=t.sent,this.setSubmitData();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onClickNextStep:function(){var t=Object(o["a"])(c.a.mark(function t(e){var a;return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tryingNextStep=!0,t.prev=1,1!==this.activeStep){t.next=5;break}return t.next=5,this.$refs[this.tabList[this.activeStep-1].name].validate();case 5:if(2!==this.activeStep){t.next=10;break}if(a=this.$refs[this.tabList[this.activeStep-1].name].isPriceNone,!a){t.next=10;break}return t.next=10,this.$confirm("尚有服務項目的價格為0，確定要繼續嗎？","提示",{confirmButtonText:"確定",showCancelButton:!0,type:"warning",center:!0});case 10:this.activeStep++,t.next=15;break;case 13:t.prev=13,t.t0=t["catch"](1);case 15:return t.prev=15,this.tryingNextStep=!1,t.finish(15);case 18:case"end":return t.stop()}},t,this,[[1,13,15,18]])}));return function(e){return t.apply(this,arguments)}}(),goBack:function(){this.activeStep--},tryToStore:function(){var t=Object(o["a"])(c.a.mark(function t(e){var a;return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.isEditMode){t.next=7;break}if("info"!==this.activeTab){t.next=5;break}return t.next=5,this.$refs[this.activeTab][0].validate();case 5:t.next=7;break;case 7:return this.tryingToStore=!0,a=this.isService?"product/storeServicePriceGroup":"product/storeAdditionalPriceGroup",t.next=11,this.$store.dispatch("".concat(a),this.submitData);case 11:this.isEditMode?Object(d["b"])("edit"):(Object(d["b"])("add"),Object(p["a"])("一般服務","排班人員","staff")),"price"!==e?this.backToList():this.isEditMode&&this.tryToFetchSingle(),t.next=17;break;case 15:t.prev=15,t.t0=t["catch"](0);case 17:return t.prev=17,this.tryingToStore=!1,t.finish(17);case 20:case"end":return t.stop()}},t,this,[[0,15,17,20]])}));return function(e){return t.apply(this,arguments)}}(),findCategory:function(){var t=this,e=this.defaultValue.prices[0].categoryId;this.category.length>0&&this.category.forEach(function(a){var i=a.children.map(function(t){return t.id});i.includes(e)&&(t.parentCategoryId=a.id)})},getService:function(){},backToList:function(){this.$router.push({name:"service",params:{type:this.isService?"service":"addition"}})},beforeTabSwitch:function(){var t=Object(o["a"])(c.a.mark(function t(e,a){return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("info"!==a){t.next=3;break}return t.next=3,this.$refs[this.activeTab][0].validate();case 3:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()}},f=h,b=a("f7ac"),v=a("2877");function y(t){this["$style"]=b["default"].locals||b["default"]}var g=Object(v["a"])(f,i,r,!1,y,null,null);e["default"]=g.exports},2608:function(t,e,a){t.exports={slide:"ServiceItemDetail_slide_2B39v","slide-reverse":"ServiceItemDetail_slide-reverse_1pDaQ",page:"ServiceItemDetail_page_1Hzqf","card-wrapper":"ServiceItemDetail_card-wrapper_FwrJU",footer:"ServiceItemDetail_footer_1DZBd"}},f7ac:function(t,e,a){"use strict";var i=a("2608"),r=a.n(i);e["default"]=r.a}}]);
//# sourceMappingURL=chunk-4d00f364.91fb648b.js.map