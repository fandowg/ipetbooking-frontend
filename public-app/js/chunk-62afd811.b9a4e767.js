(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62afd811"],{"21ac":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("5c96");n("a18c");function a(t,e,n){Object(r["Notification"])({title:"提示",dangerouslyUseHTMLString:!0,message:"已更新".concat(t,'!\n    <br>您可前往\n    <a href="/').concat(n,'" style="cursor: pointer;">').concat(e,"</a>\n    進行更多設定")})}},"3fa5":function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c});var r=n("5c96");function a(t){"add"===t&&Object(r["Message"])({message:"已新增",type:"success"}),"edit"===t&&Object(r["Message"])({message:"已儲存",type:"success"})}function c(){Object(r["Message"])({message:"已刪除",type:"success"})}},6636:function(t,e,n){t.exports={slide:"add_slide_3EBF5","slide-reverse":"add_slide-reverse_CEYkU",page:"add_page_GKYzw","card-wrapper":"add_card-wrapper_9HR59",footer:"add_footer_1g-aF"}},d613:function(t,e,n){"use strict";var r=n("6636"),a=n.n(r);e["default"]=a.a},df73:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c});var r=n("5c96");function a(t){return r["MessageBox"].confirm("尚未完成新增，請問是否確定離開新增".concat(t),"您將離開此頁面",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning",center:!0,showClose:!1})}function c(t){return r["MessageBox"].confirm("您確定要刪除".concat(t,"嗎？"),"確認刪除",{confirmButtonText:"刪除",cancelButtonText:"取消",type:"warning",center:!0,showClose:!1})}},e8a2:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",{class:t.$style.page},[n("BaseSteps",{attrs:{active:t.activeStep,list:t.stepList}}),n("el-card",{class:t.$style["card-wrapper"],attrs:{shadow:"never"}},[n("keep-alive",[n("step-"+t.activeStep,{ref:"step",tag:"component",attrs:{"item-type":t.productType,"default-value":t.formDataAll},on:{validate:t.handleFormValidate}})],1)],1),n("div",{class:t.$style.footer},[1===t.activeStep?n("el-button",{attrs:{"data-tour-text":"若不想新增此活動，請按「離開」跳出。注意：我們將不會保留此步驟填寫的資料。"},on:{click:t.onClickLeave}},[t._v("離開")]):t._e(),1!==t.activeStep?n("el-button",{on:{click:function(e){t.activeStep--}}},[t._v("上一步")]):t._e(),3!==t.activeStep||t.nextStepButtonVisible?n("el-button",{attrs:{"data-tour-text":"若欄位皆已填寫完成，點擊「下一步」儲存此步驟填寫的資料，前往下一步",type:"primary",loading:t.tryingNextStep},on:{click:t.onClickNextStep}},[t._v(t._s(3!==t.activeStep?"下一步":"儲存"))]):t._e()],1)],1)},a=[],c=n("f210"),i=n("9395"),s=n("4795"),o=n.n(s),u=n("cb0c"),p=n("a315"),d=n("444f"),l=n("3fa5"),h=n("df73"),f=n("21ac"),v={page:{title:"新增項目",meta:[{name:"description",content:"Add Product"}]},components:{Layout:d["a"],BaseSteps:function(){return Object(p["a"])(n.e("chunk-b75e1fe6").then(n.bind(null,"f49e")))},Step1:function(){return Object(p["a"])(Promise.all([n.e("chunk-f55c2908"),n.e("chunk-42549d6e"),n.e("chunk-56236740")]).then(n.bind(null,"3733")))},Step2:function(){return Object(p["a"])(n.e("chunk-4eba3e06").then(n.bind(null,"cff5")))},Step3:function(){return Object(p["a"])(Promise.all([n.e("chunk-f55c2908"),n.e("chunk-42549d6e"),n.e("chunk-2d212b99"),n.e("chunk-fb6a22d2")]).then(n.bind(null,"0c0b")))}},props:{defaultStep:{type:Number,required:!0},productType:{type:String,default:"service"},defaultValue:{type:Object,default:function(){}}},data:function(){return{tryingNextStep:!1,nextStepButtonVisible:!1,activeStep:this.defaultStep,stepList:[{title:"基本資訊",description:"設定分店資訊"},{title:"營業時間",description:"設定營業時間"},{title:"自訂問題",description:"想知道客戶是如何得知你們的嗎？或是需要統計餐點數量提前做準備嗎？可以自訂問題與客戶互動喔～完成或想略過額外欄位新增請按下一步。"}],formDataAll:{},tryingUpdateState:!1,geocoder:"",map:[],hasGeo:!1}},computed:{productId:function(){return this.$route.params.productId}},mounted:function(){this.initGeocoder()},methods:{handleFormValidate:function(t){this.nextStepButtonVisible=t},onClickLeave:function(){var t=Object(u["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h["b"])("分店");case 3:this.$router.push({name:"products"}),t.next=8;break;case 6:t.prev=6,t.t0=t["catch"](0);case 8:return t.prev=8,t.finish(8);case 10:case"end":return t.stop()}},t,this,[[0,6,8,10]])}));return function(){return t.apply(this,arguments)}}(),handleStorePrice:function(t){return this.$store.dispatch("product/storePrices",{productId:this.productId,storeData:t})},handleStoreInventory:function(t){return this.$store.dispatch("inventory/storeGroups",{productId:this.productId,submitData:t})},handleStoreProduct:function(){var t=Object(u["a"])(o.a.mark(function t(e){var n;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.geocode(e);case 2:return e.lat=this.map[0],e.lng=this.map[1],n=Object(i["a"])({},e,{type:this.productType,staffs:e.staffs.map(function(t){return{id:t.id,hostTitle:t.hostTitle}})}),t.abrupt("return",this.$store.dispatch("product/store",n));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleStoreExtraField:function(t){var e=Object(c["a"])(t.byOrder).concat(Object(c["a"])(t.bySize)),n={productId:this.productId};return e.length>0&&(n.extraFields=e),this.$store.dispatch("product/updateExtraField",n)},incrementActiveStep:function(){this.activeStep++===this.stepList.length&&(this.activeStep=1),this.tryingNextStep=!1},onClickNextStep:function(){var t=Object(u["a"])(o.a.mark(function t(){var e,n,r,a,c;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,t.t0=this.activeStep,t.next=1===t.t0?4:2===t.t0?9:3===t.t0?22:31;break;case 4:return t.next=6,this.$refs.step.validate();case 6:return this.formDataAll=this.$refs.step.formatSubmitData,this.activeStep++,t.abrupt("break",31);case 9:return t.next=11,this.$refs.step.validate();case 11:for(n in this.tryingNextStep=!0,e=this.$refs.step.serviceTimeSetting,e)e[n].start=e[n].timeRange[0],e[n].end=e[n].timeRange[1];return t.next=16,this.handleStoreProduct(Object(i["a"])({},this.formDataAll,{serviceTimeSetting:e}));case 16:return r=t.sent,a=this.$router.resolve({params:{productId:r.id}}),this.$router.push(a.location),this.activeStep=3,this.tryingNextStep=!1,t.abrupt("break",31);case 22:return c=this.$refs.step.list,this.tryingNextStep=!0,t.next=26,this.handleStoreExtraField(c);case 26:return this.tryingNextStep=!1,Object(l["b"])("add"),Object(f["a"])("分店資訊","分類設定","prices?tab=category"),this.$router.push({name:"products"}),t.abrupt("break",31);case 31:t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](0),this.tryingNextStep=!1;case 36:case"end":return t.stop()}},t,this,[[0,33]])}));return function(){return t.apply(this,arguments)}}(),updateItemState:function(){var t=Object(u["a"])(o.a.mark(function t(){var e,n=arguments;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,this.tryingUpdateState=!0,t.prev=2,t.next=5,this.$store.dispatch("product/updateState",{ids:[this.productId],state:e});case 5:this.$router.push({name:"products"}),this.tryingUpdateState=!1,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),this.tryingUpdateState=!1;case 12:case"end":return t.stop()}},t,this,[[2,9]])}));return function(){return t.apply(this,arguments)}}(),initGeocoder:function(){this.geocoder=new google.maps.Geocoder},geocode:function(){var t=Object(u["a"])(o.a.mark(function t(e){var n,r,a;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.geocoder.geocode({address:"".concat(e.location.city).concat(e.location.district).concat(e.location.address),componentRestrictions:{country:"TW"}});case 2:n=t.sent,r=n.results[0].geometry.location.lat(),a=n.results[0].geometry.location.lng(),this.map=[r,a];case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},b=v,m=n("d613"),g=n("2877");function S(t){this["$style"]=m["default"].locals||m["default"]}var y=Object(g["a"])(b,r,a,!1,S,null,null);e["default"]=y.exports}}]);
//# sourceMappingURL=chunk-62afd811.b9a4e767.js.map