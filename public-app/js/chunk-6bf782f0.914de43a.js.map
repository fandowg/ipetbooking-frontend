{"version":3,"sources":["webpack:///./src/components/OrderForm.vue?597c","webpack:///src/components/OrderForm.vue","webpack:///./src/components/OrderForm.vue?b6b2","webpack:///./src/components/OrderForm.vue?3b31","webpack:///./src/components/OrderForm.vue?f10a","webpack:///./src/components/OrderForm.vue?a01e","webpack:///./src/utils/scroll-to-element.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","class","$style","wrapper","ref","staticClass","attrs","model","submitData","rules","submitRules","label-position","isEditMode","defaultValue","paymentStatus","status","paymentMethod","label","value","callback","$$v","$set","expression","border","_v","_e","storeCashflowSetting","prop","disabled","_l","bank","index","key","id","title","memberInfo","submitPriceTotal","Object","keys","availablePrepaidList","length","on","change","updateSelectedPrepaid","prepaid","prepaidUuid","prepaidTitle","_s","times","used","type","closable","paramsWithNoQty","param","total","selectedPrepaid","paramSizeTotal","price","qty","paramPriceTotal","couponInfo","placeholder","slot","click","resetCoupon","validCoupon","userSameAsMember","autocomplete","isHomeService","filterCities","gutter","md","filterable","onSelectCity","city","district","staticStyle","margin-top","display","opacity","rows","default-value","false-label","true-label","span","emitCancel","loading","tryingStore","groupSize","handleStoreOrder","visible","statusDialogVisible","is-not-pay-prepaid","prepaidOrderStatus","prepaid-order-uuid","prepaidOrderUuid","order","update:visible","$event","paid","handlePaidStatus","cancelled","emitStore","staticRenderFns","initData","params","fullName","gender","phoneCode","phoneNumber","email","note","basePrice","allowExpired","couponCode","memberId","byOrderExtrafields","customerInfos","bankType","OrderFormvue_type_script_lang_js_","components","CountryCodePicker","lazyload_component","__webpack_require__","e","then","bind","OrderChangeStatusDialog","OrderExtraField","Portal","portal_vue_common","filters","genderFilter","filter_value_to_text","props","default","inventory","data","_this","assign","searchData","searchRules","validator","rule","$store","dispatch","member","updateMemberInfo","catch","Error","trigger","productParams","productHasExtraField","bankTypeList","computed","_this2","isTaiwan","validCodeTimeout","required","message","pattern","isRequiredBankType","address","isRequiredPrePaid","clearTimeout","$refs","form","clearValidate","setTimeout","code","productId","response","applyCoupon","items","error","request","calcFixedDiscount","arguments","undefined","calcPercentDiscount","Math","round","basePriceTotal","_this$couponInfo","discount","statusIsChanged","filteredStatusMap","_this3","filteredStatus","filter","reduce","obj","availableSizeTotal","infinity","sizeArray","map","size","prev","curr","priceArray","memberPrepaids","availablePrepaidOrders","chosenPriceIds","chosenPriceQty","checkPrepaidUsability","prepaidPriceIds","getExcludePriceIds","priceId","has","checkPrepaidAvailability","prepaidQty","chosenQty","checkedPrepaids","memberPrepaid","productPriceIds","Set","normalize_data","productType","$route","product","isAddOrdersCanceled","addOrders","every","showVacc","bookingDate","Date","format_date","date","today","date_fns","storeType","districts","_this4","find","item","watch","submitData.paymentMethod","submitData.prepaidOrderUuid","submitData.params","handler","deep","created","tryToGetParams","fetchExtraField","tryToFetchMember","tryToGetFilterCities","methods","isEmptyExtrafields","Extrafields","Array","$emit","couponData","validateField","resetField","_tryToGetParams","asyncToGenerator","regenerator_default","a","mark","_callee","paramWithQty","wrap","_context","next","sent","objectSpread","stop","apply","_handlePaidStatus","_callee2","merchantNote","_context2","tryToSaveOrder","tryToCreateOrder","_x","_this5","validate","valid","$confirm","confirmButtonText","showCancelButton","center","dangerouslyUseHTMLString","$nextTick","scroll_to_element","$el","querySelector","handleCreateSuccess","_this6","requirePay","$alert","concat","handleSaveSuccess","$message","_tryToSaveOrder","_callee3","storeData","_args3","_context3","convertExtraFieldToStoreDataFromEditMode","t0","finish","_tryToCreateOrder","_callee4","orderExtrafields","_args4","_context4","convertExtraFieldToStoreDataFromCreateMode","inventoryId","calculateParamMaxQty","remainSize","remainParamQty","floor","validPhoneNumber","searchForm","updateUserByMember","_this7","fields","forEach","field","orderInfo","cloneDeep_default","extrafield","getExtraFieldsArray","bySizeExtrafields","getBySizeExtraFieldsArray","_this8","customerInfo","customerInfoId","extraFields","_this9","extraFieldsArray","extraFieldsId","isEdited","_extraFields$extraFie","push","edited","_fetchExtraField","_callee5","productInfo","_context5","convertToObject","byOrder","bySizeExtraFieldsQuestion","bySize","group","Alias","updateEachExtraField","selectedPrices","getSelectedPrices","updateEachCustomerExtraFields","_this10","groupCount","x","_loop","i","bySizeList","alias","byOrderList","toConsumableArray","onStatusChange","_tryToFetchMember","_callee6","_this$defaultValue$me","_context6","_tryToGetFilterCities","_callee7","_ref","addressRestrictions","_context7","components_OrderFormvue_type_script_lang_js_","injectStyles","context","OrderFormvue_type_style_index_0_lang_scss_module_true_","locals","component","componentNormalizer","__webpack_exports__","module","exports","slide","slide-reverse","search-form","info","params-options","params-list","params-list__item","total__item","total__item--discount","payment-methods","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderForm_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderForm_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0___default","n","scrollToElement","offset","container","findScrollableContainer","scrollTo","top","findPos","behavior","isScrollable","hasScrollableContent","scrollHeight","clientHeight","overflowYStyle","window","getComputedStyle","overflowY","isOverflowYScroll","includes","parentElement","el","curtop","offsetParent","offsetTop","d"],"mappings":"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","file":"js/chunk-6bf782f0.914de43a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.$style.wrapper},[_c('el-form',{ref:\"form\",staticClass:\"el-form-item--normal-margin el-form-item--white-bg\",attrs:{\"model\":_vm.submitData,\"rules\":_vm.submitRules,\"label-position\":\"top\"}},[(_vm.isEditMode && _vm.defaultValue.paymentStatus === 'UNPAID' && _vm.submitData.status !== 0 && _vm.defaultValue.paymentMethod !== 'Prepaid')?[_c('el-form-item',{attrs:{\"label\":\"付款方式\"}},[_c('el-radio-group',{class:_vm.$style['payment-methods'],model:{value:(_vm.submitData.paymentMethod),callback:function ($$v) {_vm.$set(_vm.submitData, \"paymentMethod\", $$v)},expression:\"submitData.paymentMethod\"}},[(_vm.submitData.paymentStatus === 'UNPAID')?_c('el-radio',{attrs:{\"label\":null,\"border\":\"\"}},[_vm._v(\"不指定\")]):_vm._e(),_c('el-radio',{attrs:{\"label\":\"Cash\",\"border\":\"\"}},[_vm._v(\"到店付款(現金)\")]),_c('el-radio',{attrs:{\"label\":\"StoreCredit\",\"border\":\"\"}},[_vm._v(\"現場刷卡\")]),_c('el-radio',{attrs:{\"label\":\"Atm\",\"border\":\"\"}},[_vm._v(\"線下匯款\")]),(_vm.submitData.paymentStatus === 'UNPAID' && _vm.storeCashflowSetting === 1)?_c('el-radio',{attrs:{\"label\":\"Credit\",\"border\":\"\"}},[_vm._v(\"信用卡付款\")]):_vm._e(),(_vm.submitData.paymentStatus === 'UNPAID' && _vm.storeCashflowSetting !== 0)?_c('el-radio',{attrs:{\"label\":\"Vacc\",\"border\":\"\"}},[_vm._v(\"ATM虛擬帳戶\")]):_vm._e(),(_vm.memberInfo)?_c('el-radio',{attrs:{\"label\":\"Prepaid\",\"border\":\"\"}},[_vm._v(\"抵扣包月方案\")]):_vm._e()],1)],1),(_vm.submitData.paymentMethod === 'Vacc')?_c('el-form-item',{attrs:{\"prop\":\"bankType\",\"label\":\"轉帳銀行\"}},[_c('el-select',{attrs:{\"disabled\":false},model:{value:(_vm.submitData.bankType),callback:function ($$v) {_vm.$set(_vm.submitData, \"bankType\", $$v)},expression:\"submitData.bankType\"}},_vm._l((_vm.bankTypeList),function(bank,index){return _c('el-option',{key:(\"bank-\" + index),attrs:{\"value\":bank.id,\"label\":bank.title}})}),1)],1):_vm._e(),(_vm.memberInfo && _vm.submitPriceTotal > 0 && _vm.submitData.paymentMethod === 'Prepaid')?[(Object.keys(_vm.availablePrepaidList).length > 0)?_c('el-form-item',{attrs:{\"prop\":\"prepaidOrderUuid\",\"label\":\"請選擇包月方案\"}},[_c('el-select',{on:{\"change\":_vm.updateSelectedPrepaid},model:{value:(_vm.submitData.prepaidOrderUuid),callback:function ($$v) {_vm.$set(_vm.submitData, \"prepaidOrderUuid\", $$v)},expression:\"submitData.prepaidOrderUuid\"}},_vm._l((_vm.availablePrepaidList),function(prepaid,prepaidUuid){return _c('el-option',{key:prepaidUuid,attrs:{\"value\":prepaidUuid,\"label\":prepaid.prepaidTitle}},[_vm._v(\"\\n              \"+_vm._s(prepaid.prepaidTitle)+\"\\n              \"),_c('span',{staticClass:\"select__option--meta\"},[_vm._v(_vm._s((\"(尚餘\" + (prepaid.times - prepaid.used) + \"次)\")))])])}),1)],1):_c('el-form-item',{attrs:{\"label\":\"請選擇包月方案\"}},[_c('el-alert',{attrs:{\"title\":\"目前選擇的服務項目無適用之包月方案（或包月方案剩餘次數不足），請調整購買數量、建議顧客購買新的包月方案、或請顧客改以其它方式付款\",\"type\":\"warning\",\"closable\":false}})],1)]:_vm._e()]:_vm._e(),(_vm.paramsWithNoQty.length > 0)?_c('el-form-item',{class:_vm.$style['params-list']},[(_vm.submitData.paymentMethod === 'Prepaid' && Object.keys(_vm.availablePrepaidList).length > 0)?[_c('div',{class:_vm.$style['params-list__item']},[_c('div',[_vm._v(\"訂購項目\")]),_c('div',[_vm._v(\"數量\")])]),_vm._l((_vm.paramsWithNoQty),function(param){return _c('div',{key:param.id,class:_vm.$style['params-list__item']},[_c('div',[_vm._v(_vm._s(param.title))]),_c('div',[_vm._v(_vm._s((\"x\" + (param.qty))))])])}),_c('div',{class:_vm.$style.total},[(_vm.selectedPrepaid)?_c('div',{class:_vm.$style['total__item']},[_c('div',[_vm._v(\"使用方案\")]),_c('div',[_vm._v(_vm._s(_vm.selectedPrepaid.prepaidTitle))])]):_vm._e(),_c('div',{class:_vm.$style['total__item']},[_c('div',[_vm._v(\"使用次數\")]),_c('div',[_vm._v(_vm._s(_vm.paramSizeTotal))])])])]:[_c('div',{class:_vm.$style['params-list__item']},[_c('div',[_vm._v(\"訂購項目\")]),_c('div',[_vm._v(\"售價\")]),_c('div',[_vm._v(\"數量\")]),_c('div',[_vm._v(\"小計\")])]),_vm._l((_vm.paramsWithNoQty),function(param){return _c('div',{key:param.id,class:_vm.$style['params-list__item']},[_c('div',[_vm._v(_vm._s(param.title))]),_c('div',[_vm._v(_vm._s(param.price))]),_c('div',[_vm._v(_vm._s((\"x\" + (param.qty))))]),_c('div',[_vm._v(_vm._s(param.price * param.qty))])])}),_c('div',{class:_vm.$style.total},[_c('div',{class:_vm.$style['total__item']},[_c('div',[_vm._v(\"小計\")]),_c('div',[_vm._v(_vm._s(_vm.paramPriceTotal))])]),(_vm.couponInfo)?_c('div',{class:[_vm.$style['total__item'], _vm.$style['total__item--discount']]},[_c('div',[_vm._v(_vm._s((\"優惠券（\" + (_vm.couponInfo.code) + \"）\")))]),_c('div',[_vm._v(_vm._s(_vm.submitPriceTotal - _vm.paramPriceTotal))])]):_vm._e()]),_c('div',{class:_vm.$style.total},[_c('div',{class:_vm.$style['total__item']},[_c('div',[_vm._v(\"付款金額\")]),_c('div',[_vm._v(_vm._s(_vm.submitPriceTotal))])])])]],2):_vm._e(),(!_vm.isEditMode && _vm.submitPriceTotal > 0 && (_vm.submitData.paymentMethod === 'Cash' || _vm.submitData.paymentMethod === ''))?_c('el-form-item',{ref:\"couponCode\",attrs:{\"prop\":\"couponCode\",\"label\":\"優惠券\"}},[_c('el-input',{attrs:{\"disabled\":!!_vm.couponInfo,\"placeholder\":\"請輸入優惠券代碼\"},model:{value:(_vm.submitData.couponCode),callback:function ($$v) {_vm.$set(_vm.submitData, \"couponCode\", $$v)},expression:\"submitData.couponCode\"}},[(_vm.couponInfo)?_c('el-button',{attrs:{\"slot\":\"append\"},on:{\"click\":_vm.resetCoupon},slot:\"append\"},[_vm._v(\"清除優惠券\")]):_c('el-button',{attrs:{\"slot\":\"append\"},on:{\"click\":_vm.validCoupon},slot:\"append\"},[_vm._v(\"使用優惠券\")])],1)],1):_vm._e(),_c('el-form-item',{attrs:{\"prop\":\"fullName\",\"label\":\"使用人資訊\"}},[(_vm.memberInfo)?_c('el-checkbox',{model:{value:(_vm.userSameAsMember),callback:function ($$v) {_vm.userSameAsMember=$$v},expression:\"userSameAsMember\"}},[_vm._v(\"使用人同客戶\")]):_vm._e(),_c('el-input',{attrs:{\"disabled\":_vm.userSameAsMember,\"placeholder\":\"姓名\"},model:{value:(_vm.submitData.fullName),callback:function ($$v) {_vm.$set(_vm.submitData, \"fullName\", $$v)},expression:\"submitData.fullName\"}},[_c('el-select',{attrs:{\"slot\":\"append\",\"disabled\":_vm.userSameAsMember,\"placeholder\":\"性別\"},slot:\"append\",model:{value:(_vm.submitData.gender),callback:function ($$v) {_vm.$set(_vm.submitData, \"gender\", $$v)},expression:\"submitData.gender\"}},[_c('el-option',{attrs:{\"value\":\"female\",\"label\":\"小姐\"}}),_c('el-option',{attrs:{\"value\":\"male\",\"label\":\"先生\"}})],1)],1)],1),_c('el-form-item',{attrs:{\"prop\":\"phoneNumber\"}},[_c('el-input',{attrs:{\"disabled\":_vm.userSameAsMember,\"placeholder\":\"手機號碼\",\"autocomplete\":\"tel\"},model:{value:(_vm.submitData.phoneNumber),callback:function ($$v) {_vm.$set(_vm.submitData, \"phoneNumber\", $$v)},expression:\"submitData.phoneNumber\"}},[_c('CountryCodePicker',{attrs:{\"slot\":\"prepend\",\"disabled\":_vm.userSameAsMember},slot:\"prepend\",model:{value:(_vm.submitData.phoneCode),callback:function ($$v) {_vm.$set(_vm.submitData, \"phoneCode\", $$v)},expression:\"submitData.phoneCode\"}})],1)],1),(_vm.isHomeService && _vm.filterCities.length > 0)?[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"md\":6}},[_c('el-form-item',{attrs:{\"prop\":\"city\",\"label\":\"縣市\"}},[_c('el-select',{attrs:{\"filterable\":\"\",\"placeholder\":\"請選擇\"},on:{\"change\":_vm.onSelectCity},model:{value:(_vm.submitData.city),callback:function ($$v) {_vm.$set(_vm.submitData, \"city\", $$v)},expression:\"submitData.city\"}},_vm._l((_vm.filterCities),function(city,index){return _c('el-option',{key:index,attrs:{\"label\":city.city,\"value\":city.city}})}),1)],1)],1),_c('el-col',{attrs:{\"md\":6}},[_c('el-form-item',{attrs:{\"prop\":\"district\",\"label\":\"區域\"}},[_c('el-select',{attrs:{\"placeholder\":\"請選擇\",\"filterable\":\"\"},model:{value:(_vm.submitData.district),callback:function ($$v) {_vm.$set(_vm.submitData, \"district\", $$v)},expression:\"submitData.district\"}},_vm._l((_vm.districts),function(district,index){return _c('el-option',{key:index,attrs:{\"label\":district,\"value\":district}})}),1)],1)],1),_c('el-col',{attrs:{\"md\":12}},[_c('el-form-item',{attrs:{\"prop\":\"address\",\"label\":\"地址\"}},[_c('el-input',{attrs:{\"placeholder\":\"地址\"},model:{value:(_vm.submitData.address),callback:function ($$v) {_vm.$set(_vm.submitData, \"address\", $$v)},expression:\"submitData.address\"}})],1)],1)],1)]:_vm._e(),_c('el-form-item',{attrs:{\"prop\":\"note\",\"label\":\"使用人備註\"}},[_c('small',{staticStyle:{\"margin-top\":\"-20px\",\"display\":\"block\",\"opacity\":\"0.5\"}},[_vm._v(\"客戶可瀏覽此備註。若是不需要提供客戶瀏覽的資訊，請使用「內部備註」功能\")]),_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":2,\"placeholder\":\"其他備註\"},model:{value:(_vm.submitData.note),callback:function ($$v) {_vm.$set(_vm.submitData, \"note\", $$v)},expression:\"submitData.note\"}})],1),_c('OrderExtraField',{ref:\"extrafield\",attrs:{\"default-value\":_vm.defaultValue}}),_c('el-form-item',{attrs:{\"prop\":\"allowExpired\"}},[_c('el-checkbox',{attrs:{\"false-label\":0,\"true-label\":1},model:{value:(_vm.submitData.allowExpired),callback:function ($$v) {_vm.$set(_vm.submitData, \"allowExpired\", $$v)},expression:\"submitData.allowExpired\"}},[_vm._v(\"可逾期付款\")])],1)],2),_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-button',{staticClass:\"is-round is-fullwidth\",on:{\"click\":_vm.emitCancel}},[_vm._v(_vm._s((\"取消\" + (_vm.isEditMode ? '編輯' : '新增'))))])],1),_c('el-col',{attrs:{\"span\":12}},[_c('el-button',{staticClass:\"is-round is-fullwidth\",attrs:{\"type\":\"primary\",\"loading\":_vm.tryingStore,\"disabled\":_vm.isEditMode ? !_vm.submitData.groupSize : !_vm.paramSizeTotal},on:{\"click\":_vm.handleStoreOrder}},[_vm._v(_vm._s(_vm.isEditMode ? '儲存變更' : '新增訂單'))])],1)],1),_c('OrderChangeStatusDialog',{attrs:{\"visible\":_vm.statusDialogVisible,\"is-not-pay-prepaid\":_vm.defaultValue.prepaidOrderStatus === 2,\"prepaid-order-uuid\":_vm.defaultValue.prepaidOrderUuid,\"order\":_vm.submitData},on:{\"update:visible\":function($event){_vm.statusDialogVisible=$event},\"paid\":_vm.handlePaidStatus,\"cancelled\":_vm.emitStore}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport cloneDeep from 'lodash/cloneDeep'\nimport lazyLoadComponent from '@router/lazyload-component'\nimport { groupById } from '@utils/normalize-data'\nimport { genderFilter, orderStatusMap, bookingStatusMap } from '@utils/filter-value-to-text'\nimport { formatStatusMessage } from '@utils/request'\nimport { Portal } from 'portal-vue'\nimport formatDate from '@utils/format-date'\nimport { differenceInDays } from 'date-fns'\nimport scrollToElement from '@utils/scroll-to-element'\n\nconst initData = () => {\n  return {\n    params: [],\n    fullName: '',\n    gender: 'female',\n    phoneCode: '+886',\n    phoneNumber: '',\n    email: '',\n    note: '',\n    status: 2,\n    basePrice: '',\n    total: '',\n    allowExpired: 0,\n    couponCode: '',\n    memberId: '',\n    prepaidOrderUuid: '',\n    byOrderExtrafields: {},\n    customerInfos: [],\n    paymentMethod: 'Cash',\n    bankType: 'BOT'\n  }\n}\nexport default {\n  components: {\n    CountryCodePicker: () => lazyLoadComponent(import('@components/CountryCodePicker')),\n    OrderChangeStatusDialog: () => lazyLoadComponent(import('./OrderChangeStatusDialog')),\n    OrderExtraField: () => lazyLoadComponent(import('@components/OrderExtraField')),\n    Portal,\n  },\n  filters: {\n    genderFilter,\n  },\n  props: {\n    defaultValue: {\n      type: Object,\n      default: () => initData(),\n    },\n    inventory: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  data() {\n    return {\n      tryingStore: false,\n      submitData: Object.assign({}, initData(), this.defaultValue),\n      searchData: {\n        phoneCode: '+886',\n        phoneNumber: '',\n      },\n      searchRules: {\n        phoneNumber: [\n          {\n            validator: (rule, value, callback) => {\n              if (!value) return callback()\n              this.$store\n                .dispatch('member/findByPhone', this.searchData)\n                .then((member) => {\n                  this.updateMemberInfo(member)\n                })\n                .catch(() => {\n                  this.updateMemberInfo()\n                  return callback(new Error('此手機號碼尚未註冊'))\n                })\n            },\n            trigger: 'custom',\n          },\n        ],\n      },\n      statusDialogVisible: false,\n      productParams: [],\n      couponInfo: '',\n      memberInfo: '',\n      userSameAsMember: false,\n\n      selectedPrepaid: '',\n      productHasExtraField: false,\n\n      bankTypeList: [{ id: 'BOT', title: '台灣銀行' }, { id: 'Taishin', title: '台新' }, { id: 'HNCB', title: '華南' }],\n      filterCities:[]\n    }\n  },\n  computed: {\n    submitRules() {\n      const isTaiwan = this.submitData.phoneCode === '+886'\n      let validCodeTimeout = ''\n      return {\n        phoneNumber: [\n          {\n            required: true,\n            message: '請填寫手機號碼',\n            trigger: 'blur',\n          },\n          {\n            pattern: isTaiwan ? /^09\\d{8}$/ : '',\n            message: '格式請符合 09XXXXXXXX',\n            trigger: 'blur',\n          },\n        ],\n        email: [{ required: true, message: '請輸入 Email' }, { type: 'email', message: '請輸入正確的 Email 格式' }],\n        fullName: [{ required: true, message: '請輸入使用人姓名' }],\n        bankType: [{ required: this.isRequiredBankType, message: '請選擇轉帳銀行' }],\n        city: [{ required: this.isHomeService, message: '請選擇縣市'}],\n        district: [{ required: this.isHomeService, message: '請選擇區域'}],\n        address: [{ required: true, message: '請輸入服務地址' }],\n        prepaidOrderUuid: [{ required: this.isRequiredPrePaid, message: '請選擇包月方案', trigger: 'change' }],\n        couponCode: [\n          {\n            validator: (rule, value, callback) => {\n              clearTimeout(validCodeTimeout)\n              if (value === '') {\n                this.$refs.form.clearValidate('couponCode')\n                return callback()\n              }\n              validCodeTimeout = setTimeout(() => {\n                this.$store\n                  .dispatch('coupon/validCode', {\n                    code: value,\n                    basePrice: this.paramPriceTotal,\n                    productId: this.inventory.productId,\n                  })\n                  .then((response) => {\n                    callback()\n                    this.applyCoupon(response.items)\n                  })\n                  .catch((error) => callback(new Error(formatStatusMessage(error.status))))\n              }, 500)\n            },\n            trigger: 'custom',\n          },\n        ],\n      }\n    },\n    submitPriceTotal() {\n      const calcFixedDiscount = (value = 0, total = 0) => {\n        return total - value\n      }\n      const calcPercentDiscount = (value = 0, total = 1) => {\n        return total - Math.round(total * (value / 100))\n      }\n      const basePriceTotal = this.paramPriceTotal\n      const { discount, type } = this.couponInfo\n\n      return this.couponInfo ? (type === 'fixed' ? calcFixedDiscount(discount, basePriceTotal) : calcPercentDiscount(discount, basePriceTotal)) : basePriceTotal\n    },\n    isEditMode() {\n      return this.defaultValue.id\n    },\n    statusIsChanged() {\n      return this.defaultValue.status !== this.submitData.status\n    },\n    filteredStatusMap() {\n      // ! 已付款不能手動改成未付款\n      const filteredStatus = Object.keys(bookingStatusMap)\n        .filter((status) => {\n          switch (this.defaultValue.status) {\n            case 1:\n              return +status < 2\n            case 2:\n              //  虛擬帳戶不能手動改成已付款\n              // if (+status === 1 && this.defaultValue.paymentMethod === 'Vacc') return false\n              return +status <= 2\n            case 3:\n              return +status === 0 || +status === 3\n            case 4:\n              return +status === 4 || +status === 0 \n            case 5:\n              return +status === 0 || +status === 5\n            case 6:\n              return +status === 6\n            default:\n              return false\n          }\n        })\n        .reduce((obj, key) => {\n          obj[key] = bookingStatusMap[key]\n          return obj\n        }, {})\n      return this.isEditMode ? filteredStatus : bookingStatusMap\n    },\n    availableSizeTotal() {\n      if (this.inventory.infinity) return 9999 - this.inventory.qty\n      return this.inventory.inventory - this.inventory.qty || 0\n    },\n    paramSizeTotal() {\n      const sizeArray = this.submitData.params.map((param) => {\n        return +param.qty * +param.size\n      })\n      return sizeArray.length > 0 ? sizeArray.reduce((prev, curr) => +prev + +curr, 0) : ''\n    },\n    paramPriceTotal() {\n      const priceArray = this.submitData.params.map((param) => {\n        return +param.qty * +param.price\n      })\n      return priceArray.length > 0 ? priceArray.reduce((prev, curr) => +prev + +curr, 0) : ''\n    },\n    paramsWithNoQty() {\n      return this.submitData.params.filter((param) => param.qty !== 0)\n    },\n    availablePrepaidList() {\n      const memberPrepaids = (this.memberInfo && this.memberInfo.availablePrepaidOrders) || []\n      const chosenPriceIds = this.paramsWithNoQty.map((param) => param.id)\n      const chosenPriceQty = this.paramSizeTotal\n\n      const checkPrepaidUsability = (prepaidPriceIds, chosenPriceIds) => {\n        const getExcludePriceIds = chosenPriceIds.filter((priceId) => !prepaidPriceIds.has(priceId))\n        return getExcludePriceIds.length === 0\n      }\n\n      const checkPrepaidAvailability = (prepaidQty, chosenQty) => {\n        return chosenQty <= prepaidQty\n      }\n\n      const checkedPrepaids = memberPrepaids.filter((memberPrepaid) => {\n        const { times, used, productPriceIds } = memberPrepaid\n        return checkPrepaidUsability(new Set(productPriceIds), chosenPriceIds) && checkPrepaidAvailability(times - used, chosenPriceQty)\n      })\n      return groupById(checkedPrepaids, 'prepaid') || {}\n    },\n    productType() {\n      if (this.inventory) return this.inventory.productType\n      return this.defaultValue.productType || this.$route.params.product.type\n    },\n    isAddOrdersCanceled() {\n      return this.defaultValue.addOrders.every((order)=> order.status === 0)\n    },\n    showVacc() {\n      const bookingDate = new Date(formatDate(new Date(this.defaultValue.date)))\n      const today = new Date(formatDate(new Date()))\n      // 虛擬帳戶付款距離預約日要大於1天\n      return differenceInDays(bookingDate, today) > 1\n    },\n    isRequiredPrePaid() {\n      return this.memberInfo && this.submitPriceTotal > 0 && this.submitData.paymentMethod === 'Prepaid' && Object.keys(this.availablePrepaidList).length > 0\n    },\n    isRequiredBankType() {\n      return this.submitData.paymentMethod === 'Vacc'\n    },\n    storeCashflowSetting(){\n      return this.defaultValue.storeCashflowSetting\n    },\n    isHomeService(){\n      return this.defaultValue.storeType === 'home'\n    },\n    //    filterCities(){\n    // const cities = this.products.find(item=>{\n    //    return item.id === this.submitData.productId\n    //  }).addressRestrictions\n    //  return cities\n    // },\n    districts() {\n      if(!this.submitData.city){\n        return []\n      }\n      const city = this.filterCities.find(item=>{\n        return this.submitData.city === item.city\n      })\n      return city.district \n    },\n\n  },\n  watch: {\n    'submitData.paymentMethod'(value) {\n      if (value !== 'Prepaid') this.submitData.prepaidOrderUuid = ''\n      if (value !== 'Vacc') this.submitData.bankType = ''\n    },\n    availablePrepaidList(value) {\n      // if (Object.keys(value).length === 0) this.submitData.prepaidOrderUuid = ''\n    },\n    'submitData.prepaidOrderUuid'(value) {\n      this.updateSelectedPrepaid(value)\n    },\n    'submitData.params': { handler: 'updateEachExtraField', deep: true },\n    memberInfo: 'updateUserByMember',\n    userSameAsMember: 'updateUserByMember',\n  },\n  created() {\n    if (!this.isEditMode) this.tryToGetParams()\n\n    if (!this.isEditMode) this.fetchExtraField()\n\n    if (this.isEditMode) this.tryToFetchMember()\n\n    if (this.isEditMode) this.tryToGetFilterCities()\n  },\n  methods: {\n    isEmptyExtrafields(Extrafields) {\n      return Extrafields instanceof Array\n    },\n    emitCancel() {\n      this.$emit('cancel')\n    },\n    emitStore() {\n      this.$emit('store')\n    },\n    applyCoupon(couponData) {\n      this.couponInfo = couponData\n    },\n    validCoupon() {\n      this.$refs.form.validateField('couponCode')\n    },\n    resetCoupon() {\n      this.couponInfo = ''\n      this.$refs.couponCode.resetField('couponCode')\n    },\n    async tryToGetParams() {\n      this.productParams = await this.$store.dispatch('product/fetchPrices', {\n        productId: this.inventory.productId,\n      })\n\n      const paramWithQty = this.productParams.map((param) => {\n        return {\n          ...param,\n          qty: 0,\n        }\n      })\n\n      this.$set(this.submitData, 'params', paramWithQty)\n    },\n    async handlePaidStatus(merchantNote) {\n      this.isEditMode ? this.tryToSaveOrder(merchantNote) : this.tryToCreateOrder(merchantNote)\n    },\n\n    handleStoreOrder() {\n      // show the status dialog when changing order status\n      this.$refs.form.validate((valid) => {\n        if (valid) {\n\n          /* if (this.defaultValue.paymentMethod === 'Prepaid' && this.submitData.status === 1) {\n            this.$confirm('付款方式為「抵扣包月方案」時，<br>不允許將訂單狀態改為已確認', '警告', {\n              confirmButtonText: '確定',\n              showCancelButton: false,\n              type: 'error',\n              center: true,\n              dangerouslyUseHTMLString: true\n            })\n            return\n          } */\n\n          if ( this.statusIsChanged && this.isEditMode )\n          return (this.statusDialogVisible = true)\n          if (this.submitData.paymentMethod === 'Prepaid' && this.defaultValue.paymentMethod !== 'Prepaid') {\n            if (Object.keys(this.availablePrepaidList).length > 0 && this.submitData.prepaidOrderUuid === '') {\n              this.$confirm('請選擇包月方案', '提示', {\n                confirmButtonText: '確定',\n                showCancelButton: false,\n                type: 'warning',\n                center: true,\n              })\n              return\n            }\n            if (Object.keys(this.availablePrepaidList).length === 0) {\n              this.$confirm('目前選擇的服務項目無適用之包月方案，<br>請選擇其他付款方式', '提示', {\n                confirmButtonText: '確定',\n                showCancelButton: false,\n                type: 'warning',\n                center: true,\n                dangerouslyUseHTMLString: true\n              })\n              return\n            }\n          }\n\n          this.isEditMode ? this.tryToSaveOrder() : this.tryToCreateOrder()\n        } else {\n          this.$nextTick(()=>{\n            scrollToElement(this.$refs.form.$el.querySelector('.el-form-item__error'), 100)\n          })\n        }\n      })\n    },\n    handleCreateSuccess(requirePay = false) {\n      this.$alert(`已發送${requirePay ? '付款' : ' QR Code '}連結至使用人 Email`, '訂單新增成功！', {\n        confirmButtonText: '確認',\n        center: true,\n        callback: () => {\n          this.emitStore()\n        },\n      })\n    },\n    handleSaveSuccess() {\n      this.$message({\n        message: '編輯成功！',\n        type: 'success',\n      })\n      this.emitStore()\n    },\n    async tryToSaveOrder(merchantNote = '') {\n      const storeData = {\n        ...this.convertExtraFieldToStoreDataFromEditMode(this.submitData),\n        basePrice: this.paramPriceTotal,\n        total: this.submitPriceTotal,\n        merchantNote,\n      }\n      // if(this.isEditMode){\n      //   delete storeData.prepaidOrderUuid\n      // }\n      this.tryingStore = true\n      try {\n        await this.$store.dispatch('order/store', storeData)\n        this.handleSaveSuccess()\n      } catch (error) {\n        this.$message({\n          type: 'error',\n          message: `Server Error`,\n        })\n        // console.log('TCL: tryToSaveOrder -> error', error)\n      } finally {\n        this.tryingStore = false\n      }\n    },\n    async tryToCreateOrder(merchantNote = '') {\n      const orderExtrafields = this.productHasExtraField ? this.convertExtraFieldToStoreDataFromCreateMode() : undefined\n\n      const storeData = {\n        ...this.submitData,\n        basePrice: this.paramPriceTotal,\n        total: this.submitPriceTotal,\n        groupSize: this.paramSizeTotal,\n        productId: this.inventory.productId,\n        inventoryId: this.inventory.id,\n        merchantNote,\n        orderExtrafields,\n      }\n\n      this.tryingStore = true\n\n      try {\n        await this.$store.dispatch('order/store', storeData)\n        const requirePay = storeData.status === 1 ? false : storeData.status === 2 && storeData.total > 0\n        this.handleCreateSuccess(requirePay)\n      } catch (error) {\n        // console.log('TCL: tryToCreateOrder -> error', error)\n      } finally {\n        this.tryingStore = false\n      }\n    },\n    calculateParamMaxQty(size) {\n      const remainSize = this.availableSizeTotal - this.paramSizeTotal\n      const remainParamQty = remainSize >= size ? Math.floor(this.paramSizeTotal / size) : 0\n      return Math.floor(remainSize / size) + remainParamQty\n    },\n    updateSelectedPrepaid(prepaidUuid) {\n      this.selectedPrepaid = this.availablePrepaidList[prepaidUuid]\n    },\n    validPhoneNumber(phoneNumber) {\n      this.$refs.searchForm.validateField('phoneNumber')\n    },\n    updateMemberInfo(member = '') {\n      if (!member) {\n        this.submitData.phoneNumber = this.searchData.phoneNumber\n      }\n      this.memberInfo = member\n      this.userSameAsMember = !!member\n    },\n    updateUserByMember() {\n      const fields = ['memberId', 'fullName', 'gender', 'phoneCode', 'phoneNumber', 'email']\n      fields.forEach((field) => {\n        this.submitData[field] = field === 'memberId' ? this.memberInfo.id : this.memberInfo[field]\n      })\n    },\n    convertExtraFieldToStoreDataFromEditMode(submitData) {\n      const orderInfo = cloneDeep(submitData)\n      const storeData = cloneDeep(this.$refs.extrafield.defaultValue)\n      orderInfo.byOrderExtrafields = this.getExtraFieldsArray(storeData.byOrderExtrafields)\n      orderInfo.bySizeExtrafields = this.getBySizeExtraFieldsArray(storeData.customerInfos)\n      delete orderInfo.customerInfos\n      return orderInfo\n    },\n    getBySizeExtraFieldsArray(customerInfos) {\n      return customerInfos.map((customerInfo) => {\n        return {\n          customerInfoId: customerInfo.customerInfoId,\n          orderExtrafields: this.getExtraFieldsArray(customerInfo.bySizeExtrafields),\n        }\n      })\n    },\n    getExtraFieldsArray(extraFields) {\n      const extraFieldsArray = []\n      Object.keys(extraFields).forEach((extraFieldsId) => {\n        if (this.isEdited(extraFields[extraFieldsId])) {\n          const { id, value } = extraFields[extraFieldsId]\n          extraFieldsArray.push({ id, value })\n        }\n      })\n      return extraFieldsArray\n    },\n    isEdited(field) {\n      return field.edited === true\n    },\n    async fetchExtraField() {\n      const productInfo = await this.$store.dispatch('product/fetchSingle', this.inventory.productId)\n      this.defaultValue.byOrderExtrafields = this.convertToObject(productInfo.orderExtrafields.byOrder)\n      this.bySizeExtraFieldsQuestion = productInfo.orderExtrafields.bySize\n      this.productHasExtraField = productInfo.orderExtrafields.bySize !== null || productInfo.orderExtrafields.byOrder !== null\n    },\n    convertToObject(extraFields) {\n      if (extraFields === null) return\n      const fields = {}\n      extraFields.forEach((field) => {\n        fields[field.id] = {\n          group: 1,\n          id: field.id,\n          Alias: '',\n          value: '',\n          title: field.title,\n        }\n      })\n      return fields\n    },\n    updateEachExtraField() {\n      const selectedPrices = this.getSelectedPrices()\n      this.updateEachCustomerExtraFields(selectedPrices)\n    },\n    getSelectedPrices() {\n      return this.submitData.params.filter((price) => price.qty > 0)\n    },\n    updateEachCustomerExtraFields(selectedPrices) {\n      if (this.bySizeExtraFieldsQuestion === null) return\n      const customerInfos = []\n      let groupCount = 1\n      selectedPrices.forEach((price) => {\n        for (let x = 0; x < price.qty; x++) {\n          for (let i = 0; i < price.size; i++) {\n            const bySizeList = {}\n            groupCount++\n            this.bySizeExtraFieldsQuestion.forEach((field) => {\n              bySizeList[field.id] = {\n                group: groupCount,\n                id: field.id,\n                Alias: price.alias,\n                value: '',\n                title: field.title,\n              }\n            })\n            customerInfos.push({ bySizeExtrafields: bySizeList })\n          }\n        }\n      })\n\n      this.defaultValue.customerInfos = customerInfos\n    },\n    convertExtraFieldToStoreDataFromCreateMode() {\n      let byOrderList = []\n      let bySizeList = []\n      const byOrderExtrafields = this.$refs.extrafield.defaultValue.byOrderExtrafields || {}\n      const customerInfos = this.$refs.extrafield.defaultValue.customerInfos\n\n      byOrderList = Object.keys(byOrderExtrafields).map((id) => {\n        return byOrderExtrafields[id]\n      })\n      customerInfos.map((customerInfo) => {\n        Object.keys(customerInfo.bySizeExtrafields).forEach((id) => {\n          bySizeList.push(customerInfo.bySizeExtrafields[id])\n        })\n      })\n\n      return [...byOrderList, ...bySizeList]\n    },\n    onStatusChange(value) {\n      if (this.isEditMode && value === 1 && this.defaultValue.paymentMethod !== 'Prepaid') {\n        this.submitData.paymentMethod = 'Cash'\n      }\n    },\n    async tryToFetchMember() {\n      const {phoneCode, phoneNumber} = this.defaultValue.member\n      const member = await this.$store.dispatch('member/findByPhone', {phoneCode, phoneNumber})\n      this.updateMemberInfo(member)\n    },\n    onSelectCity() {\n      this.submitData.district = ''\n    },\n    async tryToGetFilterCities(){\n     const { addressRestrictions } = await this.$store.dispatch('product/fetchSingle',this.submitData.productId)\n     this.filterCities = addressRestrictions\n    //  console.log(await this.$store.dispatch('product/fetchSingle',this.submitData.productId))\n    },\n  },\n}\n</script>\n<template>\n  <div :class=\"$style.wrapper\">\n\n    <el-form ref=\"form\" :model=\"submitData\" :rules=\"submitRules\" label-position=\"top\" class=\"el-form-item--normal-margin el-form-item--white-bg\">\n      <!-- <el-form-item prop=\"status\" label=\"訂單狀態\">\n        <el-select v-model=\"submitData.status\" placeholder=\"訂單狀態\" :disabled=\" defaultValue.status === 6\" @change=\"onStatusChange\">\n          <template v-for=\"(status, statusValue) in filteredStatusMap\">\n            <el-option v-if=\"isEditMode\" :key=\"statusValue\" :value=\"+statusValue\" :label=\"`${status.text} ${+statusValue === 0 && !isAddOrdersCanceled ? '（請先將加購訂單全數退款）' : ''}`\" :disabled=\"+statusValue === 0 && !isAddOrdersCanceled\">\n            </el-option>\n          </template>\n        </el-select>\n      </el-form-item> -->\n\n      <template v-if=\"isEditMode && defaultValue.paymentStatus === 'UNPAID' && submitData.status !== 0 && defaultValue.paymentMethod !== 'Prepaid'\">\n        <el-form-item label=\"付款方式\">\n          <el-radio-group v-model=\"submitData.paymentMethod\" :class=\"$style['payment-methods']\">\n            <el-radio v-if=\"submitData.paymentStatus === 'UNPAID'\" :label=\"null\" border>不指定</el-radio>\n            <el-radio label=\"Cash\" border>到店付款(現金)</el-radio>\n            <el-radio label=\"StoreCredit\" border>現場刷卡</el-radio>\n            <el-radio label=\"Atm\" border>線下匯款</el-radio>\n            <el-radio v-if=\"submitData.paymentStatus === 'UNPAID' && storeCashflowSetting === 1\" label=\"Credit\" border>信用卡付款</el-radio>\n            <el-radio v-if=\"submitData.paymentStatus === 'UNPAID' && storeCashflowSetting !== 0\"  label=\"Vacc\"  border>ATM虛擬帳戶</el-radio>\n            <el-radio v-if=\"memberInfo\" label=\"Prepaid\" border>抵扣包月方案</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-if=\"submitData.paymentMethod === 'Vacc'\" prop=\"bankType\" label=\"轉帳銀行\">\n          <el-select v-model=\"submitData.bankType\" :disabled=\"false\">\n            <el-option v-for=\"(bank, index) in bankTypeList\" :key=\"`bank-${index}`\" :value=\"bank.id\" :label=\"bank.title\"></el-option>\n          </el-select>\n        </el-form-item>\n        <template v-if=\"memberInfo && submitPriceTotal > 0 && submitData.paymentMethod === 'Prepaid'\">\n          <el-form-item v-if=\"Object.keys(availablePrepaidList).length > 0\" prop=\"prepaidOrderUuid\" label=\"請選擇包月方案\">\n            <el-select v-model=\"submitData.prepaidOrderUuid\" @change=\"updateSelectedPrepaid\">\n              <el-option v-for=\"(prepaid, prepaidUuid) in availablePrepaidList\" :key=\"prepaidUuid\" :value=\"prepaidUuid\" :label=\"prepaid.prepaidTitle\">\n                {{ prepaid.prepaidTitle }}\n                <span class=\"select__option--meta\">{{ `(尚餘${prepaid.times - prepaid.used}次)` }}</span>\n              </el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item v-else label=\"請選擇包月方案\">\n            <el-alert\n              title=\"目前選擇的服務項目無適用之包月方案（或包月方案剩餘次數不足），請調整購買數量、建議顧客購買新的包月方案、或請顧客改以其它方式付款\"\n              type=\"warning\"\n              :closable=\"false\"\n            ></el-alert>\n          </el-form-item>\n        </template>\n      </template>\n\n      <!-- <el-form-item v-if=\"!isEditMode\" label=\"購買方案\">\n        <div v-for=\"(param, paramIndex) in productParams\" :key=\"param.id\" :class=\"$style['params-options']\">\n          <div>\n            {{ param.title }}\n            <small>{{ param.size }} 枚憑證</small>\n          </div>\n          <div>${{ param.price }}</div>\n\n          <el-input-number v-if=\"param.state\" v-model.number=\"submitData.params[paramIndex].qty\" :min=\"0\" :max=\"calculateParamMaxQty(param.size) + submitData.params[paramIndex].qty\"></el-input-number>\n          <div v-else>此方案未開放</div>\n        </div>\n      </el-form-item> -->\n      <!-- <template v-if=\"!isEditMode\">\n        <el-form-item v-if=\"memberInfo\" label=\"付款方式\">\n          <el-radio-group v-if=\"submitPriceTotal > 0\" v-model=\"submitData.paymentMethod\">\n            <el-radio v-if=\"submitData.status === 2\" label border>不指定</el-radio>\n            <el-radio label=\"Cash\" border>到店付款(現金)</el-radio>\n            <el-radio v-if=\"submitData.status === 2\" label=\"Prepaid\" border>抵扣包月方案</el-radio>\n          </el-radio-group>\n          <el-alert v-else title=\"請先選擇購買方案\" type=\"warning\" :closable=\"false\"></el-alert>\n        </el-form-item>\n        <el-form-item v-if=\"memberInfo && submitPriceTotal > 0 && submitData.paymentMethod === 'Prepaid'\" label=\"請選擇包月方案\">\n          <el-select v-if=\"Object.keys(availablePrepaidList).length > 0\" v-model=\"submitData.prepaidOrderUuid\" @change=\"updateSelectedPrepaid\">\n            <el-option v-for=\"(prepaid, prepaidUuid) in availablePrepaidList\" :key=\"prepaidUuid\" :value=\"prepaidUuid\" :label=\"prepaid.prepaidTitle\">\n              {{ prepaid.prepaidTitle }}\n              <span class=\"select__option--meta\">{{ `(尚餘${prepaid.times - prepaid.used}次)` }}</span>\n            </el-option>\n          </el-select>\n          <el-alert\n            v-else\n            title=\"目前選擇的購買方案無適用之包月方案（或包月方案剩餘次數不足），請調整購買數量、建議顧客購買新的包月方案、或請顧客改以信用卡付款\"\n            type=\"warning\"\n            :closable=\"false\"\n          ></el-alert>\n        </el-form-item>\n      </template> -->\n\n      <el-form-item v-if=\"paramsWithNoQty.length > 0\" :class=\"$style['params-list']\">\n        <template v-if=\"submitData.paymentMethod === 'Prepaid' && Object.keys(availablePrepaidList).length > 0\">\n          <div :class=\"$style['params-list__item']\">\n            <div>訂購項目</div>\n            <div>數量</div>\n          </div>\n          <div v-for=\"param in paramsWithNoQty\" :key=\"param.id\" :class=\"$style['params-list__item']\">\n            <div>{{ param.title }}</div>\n            <div>{{ `x${param.qty}` }}</div>\n          </div>\n          <div :class=\"$style.total\">\n            <div v-if=\"selectedPrepaid\" :class=\"$style['total__item']\">\n              <div>使用方案</div>\n              <div>{{ selectedPrepaid.prepaidTitle }}</div>\n            </div>\n            <div :class=\"$style['total__item']\">\n              <div>使用次數</div>\n              <div>{{ paramSizeTotal }}</div>\n            </div>\n          </div>\n        </template>\n        <template v-else>\n          <div :class=\"$style['params-list__item']\">\n            <div>訂購項目</div>\n            <div>售價</div>\n            <div>數量</div>\n            <div>小計</div>\n          </div>\n          <div v-for=\"param in paramsWithNoQty\" :key=\"param.id\" :class=\"$style['params-list__item']\">\n            <div>{{ param.title }}</div>\n            <div>{{ param.price }}</div>\n            <div>{{ `x${param.qty}` }}</div>\n            <div>{{ param.price * param.qty }}</div>\n          </div>\n          <div :class=\"$style.total\">\n            <div :class=\"$style['total__item']\">\n              <div>小計</div>\n              <div>{{ paramPriceTotal }}</div>\n            </div>\n            <div v-if=\"couponInfo\" :class=\"[$style['total__item'], $style['total__item--discount']]\">\n              <div>{{ `優惠券（${couponInfo.code}）` }}</div>\n              <div>{{ submitPriceTotal - paramPriceTotal }}</div>\n            </div>\n          </div>\n\n          <div :class=\"$style.total\">\n            <div :class=\"$style['total__item']\">\n              <div>付款金額</div>\n              <div>{{ submitPriceTotal }}</div>\n            </div>\n          </div>\n        </template>\n      </el-form-item>\n\n      <el-form-item v-if=\"!isEditMode && submitPriceTotal > 0 && (submitData.paymentMethod === 'Cash' || submitData.paymentMethod === '')\" ref=\"couponCode\" prop=\"couponCode\" label=\"優惠券\">\n        <el-input v-model=\"submitData.couponCode\" :disabled=\"!!couponInfo\" placeholder=\"請輸入優惠券代碼\">\n          <el-button v-if=\"couponInfo\" slot=\"append\" @click=\"resetCoupon\">清除優惠券</el-button>\n          <el-button v-else slot=\"append\" @click=\"validCoupon\">使用優惠券</el-button>\n        </el-input>\n      </el-form-item>\n      <el-form-item prop=\"fullName\" label=\"使用人資訊\">\n        <el-checkbox v-if=\"memberInfo\" v-model=\"userSameAsMember\">使用人同客戶</el-checkbox>\n        <el-input v-model=\"submitData.fullName\" :disabled=\"userSameAsMember\" placeholder=\"姓名\">\n          <el-select slot=\"append\" v-model=\"submitData.gender\" :disabled=\"userSameAsMember\" placeholder=\"性別\">\n            <el-option value=\"female\" label=\"小姐\"></el-option>\n            <el-option value=\"male\" label=\"先生\"></el-option>\n          </el-select>\n        </el-input>\n      </el-form-item>\n      <el-form-item prop=\"phoneNumber\">\n        <el-input v-model=\"submitData.phoneNumber\" :disabled=\"userSameAsMember\" placeholder=\"手機號碼\" autocomplete=\"tel\">\n          <CountryCodePicker slot=\"prepend\" v-model=\"submitData.phoneCode\" :disabled=\"userSameAsMember\" />\n        </el-input>\n      </el-form-item>\n      <!-- <el-form-item prop=\"email\">\n        <el-input v-model=\"submitData.email\" :disabled=\"userSameAsMember\" placeholder=\"Email\"></el-input>\n      </el-form-item> -->\n       <template v-if=\"isHomeService && filterCities.length > 0\">\n          <el-row :gutter=\"20\">\n            <el-col :md=\"6\">\n              <el-form-item prop=\"city\" label=\"縣市\">\n                <el-select v-model=\"submitData.city\" filterable placeholder=\"請選擇\" @change=\"onSelectCity\">\n                  <el-option v-for=\"(city, index) in filterCities\" :key=\"index\" :label=\"city.city\" :value=\"city.city\"> </el-option>\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :md=\"6\">\n              <el-form-item prop=\"district\" label=\"區域\">\n                <el-select v-model=\"submitData.district\" placeholder=\"請選擇\" filterable>\n                  <el-option v-for=\"(district, index) in districts\" :key=\"index\" :label=\"district\" :value=\"district\"> </el-option>\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :md=\"12\">\n              <el-form-item prop=\"address\" label=\"地址\">\n                <el-input v-model=\"submitData.address\" placeholder=\"地址\" />\n              </el-form-item>\n            </el-col>\n          </el-row>\n        </template>\n      <!-- <el-form-item v-if=\"isHomeService\" prop=\"address\" label=\"服務地址\">\n        <el-input v-model=\"submitData.address\" placeholder=\"地址\"></el-input>\n      </el-form-item> -->\n      <el-form-item prop=\"note\" label=\"使用人備註\">\n        <small style=\"margin-top: -20px;display: block;opacity: 0.5;\">客戶可瀏覽此備註。若是不需要提供客戶瀏覽的資訊，請使用「內部備註」功能</small>\n        <el-input v-model=\"submitData.note\" type=\"textarea\" :rows=\"2\" placeholder=\"其他備註\"></el-input>\n      </el-form-item>\n\n\n      <OrderExtraField ref=\"extrafield\" :default-value=\"defaultValue\" />\n\n      <el-form-item prop=\"allowExpired\">\n        <el-checkbox v-model=\"submitData.allowExpired\" :false-label=\"0\" :true-label=\"1\">可逾期付款</el-checkbox>\n      </el-form-item>\n    </el-form>\n    <!-- <Portal to=\"drawer-header\">\n      <el-button class=\"is-round\" type=\"primary\" :loading=\"tryingStore\" :disabled=\"isEditMode ? !submitData.groupSize : !paramSizeTotal\" @click=\"handleStoreOrder\">{{ isEditMode ? '儲存變更' : '新增訂單' }}</el-button>\n      <el-button class=\"is-round\" @click=\"emitCancel\">{{ `取消${isEditMode ? '編輯' : '新增'}` }}</el-button>\n    </Portal> -->\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\">\n        <el-button class=\"is-round is-fullwidth\" @click=\"emitCancel\">{{\n          `取消${isEditMode ? '編輯' : '新增'}`\n        }}</el-button>\n      </el-col>\n      <el-col :span=\"12\">\n        <el-button\n          class=\"is-round is-fullwidth\"\n          type=\"primary\"\n          :loading=\"tryingStore\"\n          :disabled=\"isEditMode ? !submitData.groupSize : !paramSizeTotal\"\n          @click=\"handleStoreOrder\"\n          >{{ isEditMode ? '儲存變更' : '新增訂單' }}</el-button\n        >\n      </el-col>\n    </el-row>\n    <OrderChangeStatusDialog :visible.sync=\"statusDialogVisible\" :is-not-pay-prepaid=\"defaultValue.prepaidOrderStatus === 2\" :prepaid-order-uuid=\"defaultValue.prepaidOrderUuid\"  :order=\"submitData\" @paid=\"handlePaidStatus\" @cancelled=\"emitStore\" />\n  </div>\n</template>\n<style lang=\"scss\" module>\n@import '@design';\n.wrapper {\n  padding-top: 30px;\n  // border-top: 1px solid $color-border-base;\n  :global {\n    .el-form-item__label {\n      @extend %font-heading;\n    }\n  }\n}\n\n.search-form {\n  margin-bottom: 15px;\n  border-bottom: 1px solid $color-border-base;\n}\n\n.title:not(:first-child) {\n  margin-top: 30px;\n}\n\n.info {\n  padding-inline-start: 0;\n  > li {\n    padding: 5px 0;\n  }\n}\n\n.params {\n  &-options {\n    display: flex;\n    justify-content: space-between;\n\n    &:not(:last-child) {\n      margin-bottom: 10px;\n    }\n  }\n  &-list {\n    padding: 5px 15px;\n    background: white;\n    &__item {\n      display: flex;\n      justify-content: space-between;\n\n      &:first-child {\n        color: $color-text-placeholder;\n      }\n      > * {\n        flex: 1;\n        &:first-child {\n          flex: 2;\n        }\n        &:not(:first-child) {\n          text-align: right;\n        }\n      }\n    }\n  }\n}\n\n.total {\n  border-top: 1px solid $color-border-base;\n  &__item {\n    display: flex;\n    justify-content: space-between;\n\n    &--discount {\n      color: $color-state-danger;\n    }\n    &:not(.total__item--discount) > *:first-child {\n      color: $color-text-placeholder;\n    }\n  }\n}\n\n.payment-methods {\n  :global {\n    .el-radio {\n      margin: 5px !important;\n    }\n    .vacc-disabled {\n      margin-bottom: 20px;\n      &::after {\n        content: '(服務前一日不提供)';\n        position: absolute;\n        bottom: -20px;\n        left: 50%;\n        transform: translateX(-50%);\n        color: #c2c6ce;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./OrderForm.vue?vue&type=template&id=4365600c&\"\nimport script from \"./OrderForm.vue?vue&type=script&lang=js&\"\nexport * from \"./OrderForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./OrderForm.vue?vue&type=style&index=0&lang=scss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"OrderForm_wrapper_3KEOm\",\"slide\":\"OrderForm_slide_1iMp2\",\"slide-reverse\":\"OrderForm_slide-reverse_y0w9c\",\"search-form\":\"OrderForm_search-form_9PCDn\",\"title\":\"OrderForm_title_CUk1j\",\"info\":\"OrderForm_info_29e-Z\",\"params-options\":\"OrderForm_params-options_SZ7Sr\",\"params-list\":\"OrderForm_params-list_1wM7T\",\"params-list__item\":\"OrderForm_params-list__item_3BVAi\",\"total\":\"OrderForm_total_3j8K2\",\"total__item\":\"OrderForm_total__item_3GLK_\",\"total__item--discount\":\"OrderForm_total__item--discount_2WvH2\",\"payment-methods\":\"OrderForm_payment-methods_32O3b\"};","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderForm.vue?vue&type=style&index=0&lang=scss&module=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderForm.vue?vue&type=style&index=0&lang=scss&module=true&\"","export default function scrollToElement($el, offset = 0) {\n  const container = findScrollableContainer($el)\n  container.scrollTo({\n    top: findPos($el) - offset,\n    behavior: \"smooth\"\n  })\n}\n\nfunction isScrollable($el) {\n  // Compare the height to see if the element has scrollable content\n  const hasScrollableContent = $el.scrollHeight > $el.clientHeight;\n\n  // It's not enough because the element's `overflow-y` style can be set as\n  // * `hidden`\n  // * `hidden !important`\n  // In those cases, the scrollbar isn't shown\n  const overflowYStyle = window.getComputedStyle($el).overflowY;\n  const isOverflowYScroll = ['scroll', 'auto'].includes(overflowYStyle)\n\n  return hasScrollableContent && isOverflowYScroll;\n}\n\nfunction findScrollableContainer($el) {\n  if(!isScrollable($el))\n    return findScrollableContainer($el.parentElement)\n  else\n    return $el\n}\n\nfunction findPos(el) {\n  var curtop = 0\n  if (el.offsetParent) {\n    do {\n      curtop += el.offsetTop\n    } while ((el = el.offsetParent))\n    return curtop\n  }\n}"],"sourceRoot":""}