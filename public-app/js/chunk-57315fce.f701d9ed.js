(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57315fce"],{6403:function(e,t,s){"use strict";var a=s("e6ad"),n=s.n(a);t["default"]=n.a},b127:function(e,t,s){"use strict";function a(e){if(Array.isArray(e))return e}function n(e,t){var s=[],a=!0,n=!1,i=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0)if(s.push(u.value),t&&s.length===t)break}catch(r){n=!0,i=r}finally{try{a||null==l["return"]||l["return"]()}finally{if(n)throw i}}return s}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(e,t){return a(e)||n(e,t)||i()}s.d(t,"a",function(){return u})},dd5d:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h4",{staticClass:"form-block-title"},[e._v("限制設定")]),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("div",{class:e.$style.box},[s("el-button",{staticClass:"is-round is-fullwidth",class:{isActiveCheckBox:e.isCreated},on:{click:e.creatUsageRule}},[s("BaseIcon",{attrs:{name:"plus"}}),e._v(" 新增暫停使用期間")],1),e._l(e.submitData.usageRules,function(t,a){return s("el-button",{key:a,staticClass:"is-round is-fullwidth",class:{isActiveCheckBox:a===e.usageRuleIndex},on:{click:function(t){return e.goToSingleUsageRule(a)}}},[e._v(" "+e._s(t.name))])})],2)]),s("el-col",{attrs:{span:12}},[s("div",{class:e.$style.box},[e.usageRules.type||e.isCreated?[s("el-form",{ref:"form",staticClass:"el-form-item--white-bg",attrs:{"validate-on-rule-change":!0,rules:e.formRules,model:e.usageRules,"label-position":"top"}},[s("div",{class:e.$style.switch},[e._v("\n              是否關閉限制\n              "),s("el-form-item",{attrs:{prop:"state"}},[s("el-switch",{attrs:{"active-text":"開放","inactive-text":"關閉","active-value":1,"inactive-value":0},model:{value:e.usageRules.state,callback:function(t){e.$set(e.usageRules,"state",t)},expression:"usageRules.state"}})],1)],1),s("el-form-item",{attrs:{label:"限制名稱",prop:"name"}},[s("el-input",{model:{value:e.usageRules.name,callback:function(t){e.$set(e.usageRules,"name",t)},expression:"usageRules.name"}})],1),s("el-form-item",{attrs:{label:"時段類別"}},[s("el-select",{model:{value:e.usageRules.rangeType,callback:function(t){e.$set(e.usageRules,"rangeType",t)},expression:"usageRules.rangeType"}},[s("el-option",{attrs:{label:"日期",value:"date"}}),s("el-option",{attrs:{label:"星期",value:"week"}})],1)],1),e.usageRules.rangeType?["week"===e.usageRules.rangeType?s("el-form-item",{attrs:{prop:"range",label:"重複於"}},[s("el-checkbox-group",{class:e.$style.repeat,model:{value:e.usageRules.range,callback:function(t){e.$set(e.usageRules,"range",t)},expression:"usageRules.range"}},e._l(e.daysInWeek,function(t,a){return s("el-checkbox-button",{key:a,attrs:{label:String(a)}},[e._v(e._s(t))])}),1)],1):e._e(),"date"===e.usageRules.rangeType?s("el-form-item",{attrs:{prop:"startDate",label:"日期"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange",align:"left","unlink-panels":"","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"起始日期","end-placeholder":"結束日期",clearable:!1},model:{value:e.filterDateRange,callback:function(t){e.filterDateRange=t},expression:"filterDateRange"}})],1):e._e(),s("span",{staticClass:"el-form-item__label"},[e._v("時間")]),e._l(e.usageRules.timeRanges,function(t,a){return s("el-form-item",{key:a,staticStyle:{"margin-bottom":"30px"},attrs:{prop:"timeRanges["+a+"][0]",rules:{required:!0,message:"請輸入時間",trigger:"blur"}}},[s("div",{staticClass:"inline-section"},[s("el-time-picker",{attrs:{clearable:!1,"range-separator":"至",format:"HH:mm","value-format":"HH:mm",placeholder:"選擇時間","is-range":""},model:{value:e.usageRules.timeRanges[a],callback:function(t){e.$set(e.usageRules.timeRanges,a,t)},expression:"usageRules.timeRanges[index]"}}),s("el-button",{staticClass:"is-round is-no-border",attrs:{disabled:1===e.usageRules.timeRanges.length,type:"text",plain:""},on:{click:function(t){return e.deleteTimeRange(a)}}},[s("BaseIcon",{attrs:{name:"trash-alt"}})],1)],1)])}),s("el-button",{staticClass:"is-round is-fullwidth",staticStyle:{"margin-bottom":"40px"},on:{click:e.addTimeRange}},[s("BaseIcon",{attrs:{name:"plus"}}),e._v(" 新增暫停使用時間")],1),s("div",{staticClass:"btn-group-inline"},[null!==e.usageRuleIndex?s("el-button",{staticClass:"is-round",on:{click:e.deleteSingleUsageRule}},[e._v(" 刪除")]):e._e(),null===e.usageRuleIndex?s("el-button",{staticClass:"is-round",on:{click:e.cancelUsageRle}},[e._v(" 取消")]):e._e(),s("el-button",{staticClass:"is-round",attrs:{type:"primary"},on:{click:e.saveSingleUsageRule}},[e._v(" 儲存")])],1)]:e._e()],2)]:[s("span",[e._v("請新增限制，或選擇已有限制")])]],2)])],1)],1)},n=[],i=s("4795"),u=s.n(i),l=s("f210"),r=s("9395"),o=s("cb0c"),c=s("b127"),g=s("7e02"),d=function(){return{type:"exclude",name:"",state:1,rangeType:"date",range:[],startDate:"",endDate:"",times:[{startTime:"",endTime:""}],timeRanges:[["00:00","23:59"]]}},m={components:{},props:{products:{type:Array,required:!0},category:{type:Array,required:!0},prices:{type:Array,required:!0},defaultValue:{type:Object,default:function(){}}},data:function(){return{usageRules:{},usageRuleIndex:null,count:0,daysInWeek:g["d"],isCreated:!1}},computed:{submitData:{get:function(){return this.defaultValue},set:function(e){this.$emit("update:defaultValue",e)}},formRules:function(){return{name:[{required:!0,message:"請輸入限制名稱",trigger:"blur"}],startDate:[{required:!0,message:"請輸入日期",trigger:"blur"}],range:[{required:!0,validator:function(e,t,s){if(0===t.length)return s(new Error("請選擇日期"));s()},trigger:"change"}]}},filterDateRange:{get:function(){return[this.usageRules.startDate,this.usageRules.endDate]},set:function(e){var t=e||["",""],s=Object(c["a"])(t,2),a=s[0],n=s[1];this.usageRules.startDate=a,this.usageRules.endDate=n}},isEditMode:function(){return!!this.defaultValue.groupOrdering}},created:function(){this.isEditMode&&this.submitData.usageRules.length>0&&(this.usageRuleIndex=0,this.goToSingleUsageRule(0))},methods:{addTimeRange:function(){this.usageRules.timeRanges.push(["00:00","23:59"])},deleteTimeRange:function(e){this.usageRules.timeRanges.splice(e,1)},creatUsageRule:function(){this.isCreated||(this.usageRules=d(),this.usageRuleIndex=null,this.isCreated=!0)},saveSingleUsageRule:function(){var e=Object(o["a"])(u.a.mark(function e(){var t,s,a;return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isCreated){e.next=3;break}return e.next=3,this.$refs.form.validate();case 3:if(this.usageRules.name){e.next=5;break}return e.abrupt("return",!1);case 5:t=[],this.usageRules.timeRanges.forEach(function(e){var s=Object(c["a"])(e,2),a=s[0],n=s[1];t.push({startTime:a,endTime:n})}),this.usageRules.times=t,s=Object(r["a"])({},this.usageRules),null===this.usageRuleIndex?(a=this.submitData.usageRules.length,this.submitData.usageRules.push(s),this.goToSingleUsageRule(a)):(this.submitData.usageRules[this.usageRuleIndex]=Object(r["a"])({},this.usageRules),this.submitData.usageRules=Object(l["a"])(this.submitData.usageRules));case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteSingleUsageRule:function(){this.submitData.usageRules.splice(this.usageRuleIndex,1),this.usageRuleIndex=null,this.usageRules=d()},goToSingleUsageRule:function(e){this.usageRules=Object(r["a"])({},this.submitData.usageRules[e]),this.usageRuleIndex=e,this.isCreated=!1,this.getTimeRanges()},getTimeRanges:function(){var e=[];this.usageRules.times.forEach(function(t){null===t.startTime&&(t.startTime=""),null===t.endTime&&(t.endTime=""),e.push([t.startTime,t.endTime])}),this.usageRules.timeRanges=e},cancelUsageRle:function(){this.isCreated=!1,this.usageRules={}},validate:function(){var e=Object(o["a"])(u.a.mark(function e(){return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.saveSingleUsageRule();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},p=m,f=s("6403"),R=s("2877");function h(e){this["$style"]=f["default"].locals||f["default"]}var b=Object(R["a"])(p,a,n,!1,h,null,null);t["default"]=b.exports},e6ad:function(e,t,s){e.exports={slide:"Step2Limit_slide_1NeVw","slide-reverse":"Step2Limit_slide-reverse_3zMte",box:"Step2Limit_box_23_Jl",switch:"Step2Limit_switch_2ybsd",repeat:"Step2Limit_repeat_1vEpy"}}}]);
//# sourceMappingURL=chunk-57315fce.f701d9ed.js.map