(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6433ba41"],{"68dc":function(e,t,a){"use strict";var s=a("e61c"),i=a.n(s);t["default"]=i.a},"9a13":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("BasePageHeader",{attrs:{title:"編輯客戶"}}),a("el-card",[a("h4",{staticClass:"form-block-title"},[e._v("基本資料\n      "),e.editDetailEnabled?[a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.cancelEditDetail}},[e._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{size:"mini",type:"primary"},on:{click:e.saveEdit}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[e._v("儲存")])],1)]:a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.enableEditDetail}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2),a("ul",{class:e.$style.detail},[e.editDetailEnabled?[a("el-form",{ref:"form",class:e.$style["detail-form"],attrs:{model:e.submitData,"label-position":e.$root.isSmallDevice?"top":"left",rules:e.searchRules,"label-width":"130px"}},[a("el-row",[a("el-col",{attrs:{span:15}},[a("el-form-item",{staticClass:"el-form-item--normal-margin",staticStyle:{"margin-left":"-4px"},attrs:{prop:"fullName",label:"姓名"}},[a("el-input",{attrs:{placeholder:"姓名："},model:{value:e.submitData.fullName,callback:function(t){e.$set(e.submitData,"fullName",t)},expression:"submitData.fullName"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{staticClass:"el-form-item--normal-margin gender-box",staticStyle:{"padding-top":"0","margin-left":"20px","margin-bottom":"0",height:"auto"},attrs:{"label-width":"0"}},[a("el-radio-group",{staticClass:"no-bg-radio-group",model:{value:e.submitData.gender,callback:function(t){e.$set(e.submitData,"gender",t)},expression:"submitData.gender"}},[a("el-radio",{attrs:{label:"male"}},[e._v("先生")]),a("el-radio",{attrs:{label:"female"}},[e._v("小姐")])],1)],1)],1)],1),a("li",{staticStyle:{"margin-bottom":"22px"}},[e._v("聯絡電話："+e._s(e.submitData.phoneCode+" "+e.submitData.phoneNumber))]),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"備用電話"}},[a("el-input",{attrs:{placeholder:"請輸入備用電話"},model:{value:e.submitData.extraInfos.extraInfoPhone[0].phoneNumber,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoPhone[0],"phoneNumber","string"===typeof t?t.trim():t)},expression:"submitData.extraInfos.extraInfoPhone[0].phoneNumber"}},[a("CountryCodePicker",{attrs:{slot:"prepend"},slot:"prepend",model:{value:e.submitData.extraInfos.extraInfoPhone[0].phoneCode,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoPhone[0],"phoneCode",t)},expression:"submitData.extraInfos.extraInfoPhone[0].phoneCode"}})],1)],1),a("el-row",[a("el-col",{attrs:{span:15}},[a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"緊急聯絡人姓名"}},[a("el-input",{attrs:{placeholder:"請輸入姓名"},model:{value:e.submitData.extraInfos.extraInfoEmergency[0].fullName,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoEmergency[0],"fullName",t)},expression:"submitData.extraInfos.extraInfoEmergency[0].fullName"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{staticClass:"el-form-item--normal-margin gender-box",staticStyle:{"padding-top":"0","margin-left":"20px","margin-bottom":"0",height:"auto"},attrs:{"label-width":"0"}},[a("el-radio-group",{staticClass:"no-bg-radio-group",model:{value:e.submitData.extraInfos.extraInfoEmergency[0].gender,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoEmergency[0],"gender",t)},expression:"submitData.extraInfos.extraInfoEmergency[0].gender"}},[a("el-radio",{attrs:{label:"male"}},[e._v("先生")]),a("el-radio",{attrs:{label:"female"}},[e._v("小姐")])],1)],1)],1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",attrs:{label:"緊急聯絡人電話"}},[a("el-input",{attrs:{placeholder:"請輸入緊急聯絡人電話"},model:{value:e.submitData.extraInfos.extraInfoEmergency[0].phoneNumber,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoEmergency[0],"phoneNumber","string"===typeof t?t.trim():t)},expression:"submitData.extraInfos.extraInfoEmergency[0].phoneNumber"}},[a("CountryCodePicker",{attrs:{slot:"prepend"},slot:"prepend",model:{value:e.submitData.extraInfos.extraInfoEmergency[0].phoneCode,callback:function(t){e.$set(e.submitData.extraInfos.extraInfoEmergency[0],"phoneCode",t)},expression:"submitData.extraInfos.extraInfoEmergency[0].phoneCode"}})],1)],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",staticStyle:{"margin-left":"-4px"},attrs:{prop:"email",label:"電子信箱"}},[a("el-input",{attrs:{placeholder:"Email"},model:{value:e.submitData.email,callback:function(t){e.$set(e.submitData,"email",t)},expression:"submitData.email"}})],1),a("el-form-item",{staticClass:"el-form-item--normal-margin",staticStyle:{"margin-left":"-4px"},attrs:{label:"LINE ID"}},[a("el-input",{attrs:{placeholder:"LINE ID"},model:{value:e.submitData.lineId,callback:function(t){e.$set(e.submitData,"lineId",t)},expression:"submitData.lineId"}})],1)],1)]:[a("li",[e._v("姓名："+e._s(e.submitData.fullName)+" "+e._s(e._f("genderFilter")(e.submitData.gender)))]),a("li",[e._v("聯絡電話："+e._s(e.submitData.phoneCode+" "+e.submitData.phoneNumber))]),e.defaultValue.extraInfos&&e.defaultValue.extraInfos.extraInfoPhone[0].phoneNumber?a("li",[e._v("\n          備用電話：\n          "+e._s(e.defaultValue.extraInfos.extraInfoPhone[0].phoneCode+" "+e.defaultValue.extraInfos.extraInfoPhone[0].phoneNumber)+"\n        ")]):e._e(),e.defaultValue.extraInfos&&e.defaultValue.extraInfos.extraInfoEmergency[0].fullName?a("li",[e._v("\n          緊急聯絡人姓名：\n          "+e._s(e.defaultValue.extraInfos.extraInfoEmergency[0].fullName)+" "+e._s(e._f("genderFilter")(e.defaultValue.extraInfos.extraInfoEmergency[0].gender))+" \n        ")]):e._e(),e.defaultValue.extraInfos&&e.defaultValue.extraInfos.extraInfoEmergency[0].phoneNumber?a("li",[e._v("\n          緊急聯絡人電話：\n          "+e._s(e.defaultValue.extraInfos.extraInfoEmergency[0].phoneCode+" "+e.defaultValue.extraInfos.extraInfoEmergency[0].phoneNumber)+"\n        ")]):e._e(),a("li",[e._v("電子信箱："+e._s(e.submitData.email))]),a("li",[e._v("LINE ID："+e._s(e.submitData.lineId))])],e.$hasHomeService()?[a("li",[e._v("\n          帳單地址：\n          "),e.defaultValue.billingInfo?[e._v(" "+e._s(e.defaultValue.billingInfo.city)+" "+e._s(e.defaultValue.billingInfo.district)+" "+e._s(e.defaultValue.billingInfo.address)+" ")]:e._e(),a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:function(t){return e.enableEditAddress("billing")}}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2),a("li",[e._v("\n          地址：\n          "),e.defaultValue.shippingInfo?[e._v(" "+e._s(e.defaultValue.shippingInfo[0].city)+" "+e._s(e.defaultValue.shippingInfo[0].district)+" "+e._s(e.defaultValue.shippingInfo[0].address)+" ")]:e._e(),a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:function(t){return e.enableEditAddress("shipping")}}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2)]:e._e()],2),a("div",{staticClass:"bottom-line-box-normal"}),a("h4",{staticClass:"form-block-title"},[e._v("\n      隸屬標籤\n      "),e.editTagEnabled?[a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.cancelTagEdit}},[e._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{size:"mini",type:"primary",loading:e.tryingUpdateTag},on:{click:e.updateTag}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[e._v("儲存")])],1)]:a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.enableEditTag}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2),e.editTagEnabled?a("div",[a("div",{staticStyle:{color:"#aaaaaa","margin-bottom":"10px","margin-top":"-10px"}},[e._v("標籤")]),a("el-select",{attrs:{"value-key":"id",multiple:"",placeholder:"請選擇"},model:{value:e.submitData.tags,callback:function(t){e.$set(e.submitData,"tags",t)},expression:"submitData.tags"}},e._l(e.tagList,function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e}})}),1)],1):a("div",{class:e.$style["label-tag"]},[a("span",[e._v("標籤：")]),e._l(e.submitData.tags,function(t){return a("el-tag",{key:"tag-"+t.id,attrs:{type:"info",effect:"plain","disable-transitions":""}},[e._v("\n        "+e._s(t.title)+"\n      ")])})],2),a("div",{staticClass:"bottom-line-box-normal"}),e.storeInvoiceSetting?[a("h4",{staticClass:"form-block-title"},[e._v("發票資訊\n        "),e.editInvoiceEnabled?[a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.cancelEditInvoice}},[e._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{size:"mini",type:"primary"},on:{click:e.saveEdit}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[e._v("儲存")])],1)]:a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.enableEditInvoice}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2),a("ul",{class:e.$style.detail},[e.editInvoiceEnabled?[a("el-form",{ref:"form-invoice",staticClass:"el-form-item--normal-margin",class:e.$style["detail-form"],attrs:{model:e.submitData,"label-position":"left","label-width":"100px"}},[a("InvoiceForm",{attrs:{"default-value":e.submitData,"show-sync":!1}})],1)]:[a("li",[e._v("開立類型："+e._s(e.taxTypeMap[e.defaultValue.taxType]))]),"B2C"===e.defaultValue.taxType?[a("li",[e._v("載具類別："+e._s(e.carrierTypeMap[e.defaultValue.CarrierType]||"無（寄送電子發票至客戶 email）"))]),"0"===e.defaultValue.CarrierType||"1"===e.defaultValue.CarrierType?a("li",[e._v("載具編號："+e._s(e.defaultValue.CarrierNum))]):e._e()]:"B2B"===e.defaultValue.taxType?a("li",[e._v("統一編號："+e._s(e.defaultValue.taxId))]):a("li",[e._v("捐贈碼："+e._s(e.defaultValue.LoveCode))])]],2),a("div",{staticClass:"bottom-line-box-normal"})]:e._e(),a("h4",{staticClass:"form-block-title"},[e._v("\n      內部備註\n      "),e.editEnabled?[a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.cancelEdit}},[e._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{size:"mini",type:"primary"},on:{click:e.saveEdit}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[e._v("儲存")])],1)]:a("el-button",{staticClass:"is-round",attrs:{size:"mini"},on:{click:e.enableEdit}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[e._v("編輯")])],1)],2),e.editEnabled?a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"請輸入你的備註文字"},model:{value:e.editedNote,callback:function(t){e.editedNote=t},expression:"editedNote"}}):a("p",{staticStyle:{"line-height":"25px","white-space":"break-spaces"},domProps:{innerHTML:e._s(e.submitData.merchantNote||"目前尚無備註")}})],2),a("el-dialog",{attrs:{title:"編輯"+("billing"===e.addressMode?"帳單":"")+"地址",visible:e.visibleDialog,top:"0",width:"680px","append-to-body":""},on:{"update:visible":function(t){e.visibleDialog=t},close:e.handleClose}},[e.$hasHomeService()&&e.submitData[e.addressMode+"Info"]?[a("el-form",{ref:"addressForm",staticClass:"el-form--floating",staticStyle:{"margin-top":"30px"},attrs:{model:e.submitData,rules:e.addressRules,"label-position":"top"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名"}},["shipping"===e.addressMode?a("el-input",{model:{value:e.submitData[e.addressMode+"Info"][0].name,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"name",t)},expression:"submitData[`${addressMode}Info`][0].name"}}):a("el-input",{model:{value:e.submitData[e.addressMode+"Info"].name,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"name",t)},expression:"submitData[`${addressMode}Info`].name"}})],1)],1),a("el-col",{attrs:{span:12}},["shipping"===e.addressMode?a("el-form-item",{attrs:{label:"電話",prop:"shippingInfo.0.phone"}},[a("el-input",{model:{value:e.submitData[e.addressMode+"Info"][0].phone,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"phone",t)},expression:"submitData[`${addressMode}Info`][0].phone"}})],1):a("el-form-item",{attrs:{label:"電話",prop:"billingInfo.phone"}},[a("el-input",{model:{value:e.submitData[e.addressMode+"Info"].phone,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"phone",t)},expression:"submitData[`${addressMode}Info`].phone"}})],1)],1)],1),"billing"===e.addressMode?a("el-form-item",{attrs:{label:"電子郵件"}},[a("el-input",{model:{value:e.submitData[e.addressMode+"Info"].email,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"email",t)},expression:"submitData[`${addressMode}Info`].email"}})],1):e._e(),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"縣市"}},["shipping"===e.addressMode?a("el-select",{attrs:{placeholder:"請選擇縣市",filterable:""},on:{change:e.onSelectCity},model:{value:e.submitData[e.addressMode+"Info"][0].city,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"city",t)},expression:"submitData[`${addressMode}Info`][0].city"}},e._l(e.taiwanCitys,function(e,t){return a("el-option",{key:"billing-city-"+t,attrs:{label:e.name,value:e.name}})}),1):a("el-select",{attrs:{placeholder:"請選擇縣市",filterable:""},on:{change:e.onSelectCity},model:{value:e.submitData[e.addressMode+"Info"].city,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"city",t)},expression:"submitData[`${addressMode}Info`].city"}},e._l(e.taiwanCitys,function(e,t){return a("el-option",{key:"billing-city-"+t,attrs:{label:e.name,value:e.name}})}),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"鄉鎮市區"}},["shipping"===e.addressMode?a("el-select",{attrs:{placeholder:"請選擇鄉鎮市區",filterable:""},on:{change:e.onSelectDistrict},model:{value:e.submitData[e.addressMode+"Info"][0].district,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"district",t)},expression:"submitData[`${addressMode}Info`][0].district"}},e._l(e.districts,function(e,t){return a("el-option",{key:"billing-district-"+t,attrs:{label:e.name,value:e.name}})}),1):a("el-select",{attrs:{placeholder:"請選擇鄉鎮市區",filterable:""},on:{change:e.onSelectDistrict},model:{value:e.submitData[e.addressMode+"Info"].district,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"district",t)},expression:"submitData[`${addressMode}Info`].district"}},e._l(e.districts,function(e,t){return a("el-option",{key:"billing-district-"+t,attrs:{label:e.name,value:e.name}})}),1)],1)],1)],1),a("el-form-item",{attrs:{label:"郵政編號"}},["shipping"===e.addressMode?a("el-input",{model:{value:e.submitData[e.addressMode+"Info"][0].postcode,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"postcode",t)},expression:"submitData[`${addressMode}Info`][0].postcode"}}):a("el-input",{model:{value:e.submitData[e.addressMode+"Info"].postcode,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"postcode",t)},expression:"submitData[`${addressMode}Info`].postcode"}})],1),a("el-form-item",{attrs:{label:"詳細地址"}},["shipping"===e.addressMode?a("el-input",{model:{value:e.submitData[e.addressMode+"Info"][0].address,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"][0],"address",t)},expression:"submitData[`${addressMode}Info`][0].address"}}):a("el-input",{model:{value:e.submitData[e.addressMode+"Info"].address,callback:function(t){e.$set(e.submitData[e.addressMode+"Info"],"address",t)},expression:"submitData[`${addressMode}Info`].address"}})],1)],1),a("div",{class:e.$style.footer},[a("el-button",{staticClass:"is-round",on:{click:function(t){e.visibleDialog=!1}}},[e._v("取消")]),a("el-button",{staticClass:"is-round",attrs:{loading:e.tryingSave,disabled:e.tryingSave,type:"primary"},on:{click:e.onSaveAddress}},[e._v("儲存")])],1)]:e._e()],2)],1)},i=[],n=a("4795"),l=a.n(n),r=a("cb0c"),o=a("9395"),d=a("f210"),c=a("7e02"),u=a("0644"),m=a.n(u),f=a("a315"),b=function(){return{address:"",city:"",district:"",email:"",name:"",phone:"",postcode:""}},p={phoneCode:"+886",phoneNumber:""},h={phoneCode:"+886",phoneNumber:"",fullName:"",gender:"male"},g={components:{InvoiceForm:function(){return Object(f["a"])(a.e("chunk-2d0ab0e8").then(a.bind(null,"143b")))},CountryCodePicker:function(){return Object(f["a"])(a.e("chunk-66428ff2").then(a.bind(null,"e05d")))}},filters:{genderFilter:c["h"]},props:{defaultValue:{type:Object,default:function(){}}},data:function(){return{taxTypeMap:c["B"],carrierTypeMap:c["c"],taiwanCitys:c["A"],submitData:m()(Object.assign({},{extraInfos:{extraInfoPhone:[p],extraInfoEmergency:[h]}},this.defaultValue,{merchantNote:this.defaultValue.merchantNote&&this.defaultValue.merchantNote.replace(/<br\s\/>/g,"")})),editedNote:null,editEnabled:!1,editTagEnabled:!1,removeTags:new Set,tagList:[],tryingUpdateTag:!1,addressMode:"billing",tryingSave:!1,visibleDialog:!1,editDetailEnabled:!1,editInvoiceEnabled:!1}},computed:{addIds:function(){var e=this;return this.allIds.filter(function(t){return!e.defaultTagIds.includes(t)&&e.submitDataTagIds.includes(t)})},deleteIds:function(){var e=this;return this.allIds.filter(function(t){return e.defaultTagIds.includes(t)&&!e.submitDataTagIds.includes(t)})},defaultTagIds:function(){return this.defaultValue.tags.map(function(e){return e.id})},submitDataTagIds:function(){return this.submitData.tags.map(function(e){return e.id})},allIds:function(){return Object(d["a"])(new Set(Object(d["a"])(this.defaultTagIds).concat(Object(d["a"])(this.submitDataTagIds))))},districts:function(){var e=[];return"shipping"===this.addressMode&&(e=this.submitData["".concat(this.addressMode,"Info")][0].city),"billing"===this.addressMode&&(e=this.submitData["".concat(this.addressMode,"Info")].city),Object(c["f"])(e)},searchRules:function(){return{email:[{required:!1,message:"請輸入 Email"},{type:"email",message:"請輸入正確的 Email 格式"}],fullName:[{required:!0,message:"請輸入使用人姓名"}]}},addressRules:function(){return{"shippingInfo.0.phone":[{pattern:/[\s\#0-9_\-\+\/\(\)\.]/,message:"請輸入正確的 電話 格式",trigger:"blur"}],"billingInfo.phone":[{pattern:/[\s\#0-9_\-\+\/\(\)\.]/,message:"請輸入正確的 電話 格式",trigger:"blur"}]}},storeInvoiceSetting:function(){return this.defaultValue.storeInvoiceSetting},hasHomeService:function(){return this.$hasHomeService()}},watch:{hasHomeService:function(e){this.getDefaultAddress()}},created:function(){this.tryToFetchList(""),this.submitData.extraInfos||(this.submitData=Object(o["a"])({},this.submitData,{extraInfos:{extraInfoPhone:[p],extraInfoEmergency:[h]}})),this.getDefaultAddress()},mounted:function(){},methods:{getDefaultAddress:function(){this.$hasHomeService()&&(this.submitData.billingInfo||(this.submitData.billingInfo=b()),this.submitData.shippingInfo||(this.submitData.shippingInfo=[b()]))},enableEdit:function(){this.editEnabled=!0,this.editedNote=this.submitData.merchantNote},cancelEdit:function(){this.editEnabled=!1,this.editedNote=null},enableEditTag:function(){this.editTagEnabled=!0},cancelTagEdit:function(){this.submitData.tags=Object(d["a"])(this.defaultValue.tags),this.editTagEnabled=!1},enableEditDetail:function(){this.editDetailEnabled=!0},cancelEditDetail:function(){var e=this.defaultValue,t=e.fullName,a=e.gender,s=e.email;this.submitData=Object(o["a"])({},this.submitData,{fullName:t,gender:a,email:s}),this.editDetailEnabled=!1},enableEditInvoice:function(){this.editInvoiceEnabled=!0},cancelEditInvoice:function(){var e=this.defaultValue,t=e.taxType,a=e.taxId,s=e.CarrierType,i=e.CarrierNum,n=e.LoveCode;this.submitData=Object(o["a"])({},this.submitData,{taxType:t,taxId:a,CarrierType:s,CarrierNum:i,LoveCode:n}),this.editInvoiceEnabled=!1},saveEdit:function(){var e=Object(r["a"])(l.a.mark(function e(){return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$refs.form){e.next=3;break}return e.next=3,this.$refs.form.validate();case 3:if(!this.$refs["form-invoice"]){e.next=6;break}return e.next=6,this.$refs["form-invoice"].validate();case 6:return this.$hasHomeService()||this.defaultValue.shippingInfo||this.defaultValue.billingInfo||(delete this.submitData.billingInfo,delete this.submitData.shippingInfo),e.next=9,this.$store.dispatch("member/store",Object(o["a"])({},this.submitData,{merchantNote:this.editedNote,CarrierNum:"2"===this.submitData.CarrierType?this.defaultValue.phoneNumber:this.submitData.CarrierNum}));case 9:return this.submitData.merchantNote=this.editedNote,e.next=12,this.tryToFetchMember();case 12:this.cancelEdit(),this.cancelEditDetail(),this.cancelTagEdit(),this.cancelEditInvoice();case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateTag:function(){var e=Object(r["a"])(l.a.mark(function e(){return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.tryingUpdateTag=!0,e.next=3,this.$store.dispatch("member/applyTags",{addIds:this.addIds,deleteIds:this.deleteIds,memberIds:[this.submitData.id]});case 3:return e.next=5,this.tryToFetchMember();case 5:this.cancelTagEdit(),this.tryingUpdateTag=!1;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),tryToFetchList:function(){var e=Object(r["a"])(l.a.mark(function e(t){return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("member/fetchTags",{search:t});case 2:this.tagList=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),tryToFetchMember:function(){var e=Object(r["a"])(l.a.mark(function e(){var t;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("member/fetchSingle",this.$route.params.memberId);case 2:t=e.sent,this.$emit("update:defaultValue",t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),enableEditAddress:function(e){this.addressMode=e,this.visibleDialog=!0},onSelectCity:function(){"billing"===this.addressMode&&(this.submitData["".concat(this.addressMode,"Info")]=Object(o["a"])({},this.submitData["".concat(this.addressMode,"Info")],{district:"",postcode:""})),"shipping"===this.addressMode&&(this.submitData["".concat(this.addressMode,"Info")][0].district="",this.submitData["".concat(this.addressMode,"Info")][0].postcode="")},onSelectDistrict:function(){if("shipping"===this.addressMode){var e=this.submitData["".concat(this.addressMode,"Info")][0],t=e.city,a=e.district;this.submitData["".concat(this.addressMode,"Info")][0].postcode=Object(c["g"])(t,a)}if("billing"===this.addressMode){var s=this.submitData["".concat(this.addressMode,"Info")],i=s.city,n=s.district;this.submitData["".concat(this.addressMode,"Info")].postcode=Object(c["g"])(i,n)}},onSaveAddress:function(){var e=Object(r["a"])(l.a.mark(function e(){return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs.addressForm.validate();case 3:return this.tryingSave=!0,e.next=6,this.saveEdit();case 6:return e.next=8,this.tryToFetchMember();case 8:this.visibleDialog=!1,e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](0);case 13:return e.prev=13,this.tryingSave=!1,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[0,11,13,16]])}));return function(){return e.apply(this,arguments)}}(),handleClose:function(){this.submitData=m()(this.defaultValue),this.getDefaultAddress(),this.visibleDialog=!1}}},I=g,v=a("68dc"),D=a("2877");function x(e){this["$style"]=v["default"].locals||v["default"]}var y=Object(D["a"])(I,s,i,!1,x,null,null);t["default"]=y.exports},e61c:function(e,t,a){e.exports={slide:"DetailEdit_slide_3RUGU","slide-reverse":"DetailEdit_slide-reverse_1v7H-",detail:"DetailEdit_detail_ldjC2","label-tag":"DetailEdit_label-tag_3CqJn",footer:"DetailEdit_footer_3KIyp","detail-form":"DetailEdit_detail-form_3dvck"}}}]);
//# sourceMappingURL=chunk-6433ba41.3c3998b0.js.map