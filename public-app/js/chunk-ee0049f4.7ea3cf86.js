(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ee0049f4"],{"904d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{class:t.$style.info},[a("h6",{staticClass:"form-block-title"},[t._v("基本資料")]),a("ul",{class:t.$style.detail,staticStyle:{"font-size":"12px"}},[a("li",[t._v("聯絡電話："+t._s(t.submitData.phoneCode+" "+t.submitData.phoneNumber))]),a("li",[t._v("電子信箱："+t._s(t.submitData.email))])]),a("h6",{staticClass:"form-block-title"},[t._v("\n      隸屬群組\n      "),t.editTagEnabled?[a("el-button",{attrs:{size:"mini"},on:{click:t.cancelTagEdit}},[t._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary",loading:t.tryingUpdateTag},on:{click:t.updateTag}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[t._v("儲存")])],1)]:a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.enableEditTag}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[t._v("編輯")])],1)],2),t.editTagEnabled?a("div",[a("div",{staticStyle:{color:"#AAAAAA","margin-bottom":"10px","margin-top":"-10px"}},[t._v("標籤")]),a("el-select",{attrs:{"value-key":"id",multiple:"",placeholder:"請選擇"},model:{value:t.submitData.tags,callback:function(e){t.$set(t.submitData,"tags",e)},expression:"submitData.tags"}},t._l(t.tagList,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t}})}),1)],1):a("div",{class:t.$style["label-tag"]},[a("span",[t._v("標籤：")]),t._l(t.submitData.tags,function(e){return a("el-tag",{key:"tag-"+e.id,attrs:{type:"info",effect:"plain","disable-transitions":""}},[t._v("\n        "+t._s(e.title)+"\n      ")])})],2),a("h6",{staticClass:"form-block-title"},[t._v("\n      備註\n      "),t.editEnabled?[a("el-button",{attrs:{size:"mini"},on:{click:t.cancelEdit}},[t._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.saveEdit}},[a("BaseIcon",{attrs:{name:"check"}}),a("span",[t._v("儲存")])],1)]:a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.enableEdit}},[a("BaseIcon",{attrs:{name:"edit"}}),a("span",[t._v("編輯")])],1)],2),t.editEnabled?a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"請輸入你的備註文字"},model:{value:t.editedNote,callback:function(e){t.editedNote=e},expression:"editedNote"}}):a("p",[t._v(t._s(t.submitData.merchantNote||"目前尚無備註"))])],1)],1)},n=[],s=a("4795"),r=a.n(s),l=a("9395"),c=a("cb0c"),d=a("f210"),u=a("7e02"),o={filters:{genderFilter:u["h"]},props:{defaultValue:{type:Object,default:function(){}}},data:function(){return{submitData:Object.assign({},this.defaultValue),editedNote:null,editEnabled:!1,editTagEnabled:!1,removeTags:new Set,tagList:[],tryingUpdateTag:!1}},created:function(){this.tryToFetchList("")},computed:{addIds:function(){var t=this;return this.allIds.filter(function(e){return!t.defaultTagIds.includes(e)&&t.submitDataTagIds.includes(e)})},deleteIds:function(){var t=this;return this.allIds.filter(function(e){return t.defaultTagIds.includes(e)&&!t.submitDataTagIds.includes(e)})},defaultTagIds:function(){return this.defaultValue.tags.map(function(t){return t.id})},submitDataTagIds:function(){return this.submitData.tags.map(function(t){return t.id})},allIds:function(){return Object(d["a"])(new Set(Object(d["a"])(this.defaultTagIds).concat(Object(d["a"])(this.submitDataTagIds))))}},methods:{enableEdit:function(){this.editEnabled=!0,this.editedNote=this.submitData.merchantNote},cancelEdit:function(){this.editEnabled=!1,this.editedNote=null},enableEditTag:function(){this.editTagEnabled=!0},cancelTagEdit:function(){this.submitData.tags=Object(d["a"])(this.defaultValue.tags),this.editTagEnabled=!1},saveEdit:function(){var t=Object(c["a"])(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("member/store",Object(l["a"])({},this.submitData,{merchantNote:this.editedNote}));case 2:this.submitData.merchantNote=this.editedNote,this.cancelEdit();case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),updateTag:function(){var t=Object(c["a"])(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.tryingUpdateTag=!0,t.next=3,this.$store.dispatch("member/applyTags",{addIds:this.addIds,deleteIds:this.deleteIds,memberIds:[this.submitData.id]});case 3:return t.next=5,this.tryToFetchMember();case 5:this.cancelTagEdit(),this.tryingUpdateTag=!1;case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),tryToFetchList:function(){var t=Object(c["a"])(r.a.mark(function t(e){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("member/fetchTags",{search:e});case 2:this.tagList=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),tryToFetchMember:function(){var t=Object(c["a"])(r.a.mark(function t(){var e;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("member/fetchSingle",this.$route.params.memberId);case 2:e=t.sent,this.$emit("update:defaultValue",e);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},h=o,p=a("9cf8"),f=a("2877");function m(t){this["$style"]=p["default"].locals||p["default"]}var b=Object(f["a"])(h,i,n,!1,m,null,null);e["default"]=b.exports},"9cf8":function(t,e,a){"use strict";var i=a("efed"),n=a.n(i);e["default"]=n.a},efed:function(t,e,a){t.exports={slide:"DetailEdit_slide_10vuE","slide-reverse":"DetailEdit_slide-reverse_1w1DY",detail:"DetailEdit_detail_cNtdL","label-tag":"DetailEdit_label-tag_3kMaN",info:"DetailEdit_info_g9Ajz"}}}]);
//# sourceMappingURL=chunk-ee0049f4.7ea3cf86.js.map