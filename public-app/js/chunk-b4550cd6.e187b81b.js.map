{"version":3,"sources":["webpack:///./src/router/views/member/components/TagPopover.vue?4aee","webpack:///./node_modules/@vue/babel-preset-app/node_modules/@babel/runtime/helpers/builtin/es6/arrayWithHoles.js","webpack:///./node_modules/@vue/babel-preset-app/node_modules/@babel/runtime/helpers/builtin/es6/iterableToArrayLimit.js","webpack:///./node_modules/@vue/babel-preset-app/node_modules/@babel/runtime/helpers/builtin/es6/nonIterableRest.js","webpack:///./node_modules/@vue/babel-preset-app/node_modules/@babel/runtime/helpers/builtin/es6/slicedToArray.js","webpack:///./src/router/views/member/components/TagPopover.vue?1416","webpack:///src/router/views/member/components/TagPopover.vue","webpack:///./src/router/views/member/components/TagPopover.vue?7e55","webpack:///./src/router/views/member/components/TagPopover.vue?532b","webpack:///./src/router/views/member/components/TagPopover.vue?a276"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TagPopover_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_0_0_node_modules_css_loader_index_js_ref_8_oneOf_0_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_0_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_0_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TagPopover_vue_vue_type_style_index_0_lang_scss_module_true___WEBPACK_IMPORTED_MODULE_0___default","n","__webpack_exports__","_arrayWithHoles","arr","Array","isArray","_iterableToArrayLimit","i","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","value","length","err","_nonIterableRest","TypeError","_slicedToArray","d","render","_vm","this","_h","$createElement","_c","_self","attrs","placement","title","width","trigger","class","$style","popover","clearable","on","input","onSearch","clear","tryToFetchList","model","callback","$$v","keyword","expression","staticClass","slot","name","list","change","onChanged","selectedTag","_l","tag","index","key","checkbox","label","id","disabled","selectedMember","indeterminate","showIndeterminate","_v","showManageBtn","staticStyle","margin-bottom","loading","tryingApply","type","plain","click","tryToApply","padding","justify-content","underline","$event","dialogVisible","dialog-visible","update:dialogVisible","update:dialog-visible","staticRenderFns","TagPopovervue_type_script_lang_js_","components","TagManagment","Object","lazyload_component","e","then","bind","props","default","data","tagList","selectedTagClone","selectedTagPrevious","tryingFetch","addList","Set","addListTracker","deleteList","deleteListTracker","computed","tagRecord","count","forEach","concat","member","tags","isAddedOrDeleted","isEqualArray","size","watch","newValue","oldValue","checkSelectedTag","$emit","created","_this","lodash","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","searchValue","wrap","_context","prev","stop","_x","apply","arguments","methods","_tryToFetchList","_callee2","search","_context2","$store","dispatch","sent","_x2","_tryToApply","_callee3","memberIds","request","_context3","$message","message","abrupt","map","addIds","toConsumableArray","deleteIds","has","isIndeterminate","_this2","$nextTick","$forceUpdate","_this3","isAdd","isDelete","array1","array2","every","_this4","_this$selectedTag$fil","filter","x","includes","_this$selectedTag$fil2","slicedToArray","delete","add","_this5","_this$selectedTagPrev","_this$selectedTagPrev2","components_TagPopovervue_type_script_lang_js_","injectStyles","context","TagPopovervue_type_style_index_0_lang_scss_module_true_","locals","component","componentNormalizer","module","exports","slide","slide-reverse"],"mappings":"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","file":"js/chunk-b4550cd6.e187b81b.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagPopover.vue?vue&type=style&index=0&lang=scss&module=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-0-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-0-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-0-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagPopover.vue?vue&type=style&index=0&lang=scss&module=true&\"","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-popover',{attrs:{\"placement\":\"bottom\",\"title\":\"貼標籤：\",\"width\":\"200\",\"trigger\":\"click\"}},[_c('div',{class:_vm.$style.popover},[_c('el-input',{attrs:{\"clearable\":\"\"},on:{\"input\":_vm.onSearch,\"clear\":_vm.tryToFetchList},model:{value:(_vm.keyword),callback:function ($$v) {_vm.keyword=$$v},expression:\"keyword\"}},[_c('BaseIcon',{staticClass:\"el-input__icon\",attrs:{\"slot\":\"prefix\",\"name\":\"search\"},slot:\"prefix\"})],1),_c('div',{class:_vm.$style.list},[_c('el-checkbox-group',{on:{\"change\":_vm.onChanged},model:{value:(_vm.selectedTag),callback:function ($$v) {_vm.selectedTag=$$v},expression:\"selectedTag\"}},_vm._l((_vm.tagList),function(tag,index){return _c('el-checkbox',{key:(\"box-\" + index),class:_vm.$style.checkbox,attrs:{\"label\":tag.id,\"disabled\":_vm.selectedMember.length === 0,\"indeterminate\":_vm.showIndeterminate(tag.id)}},[_vm._v(_vm._s(tag.title))])}),1)],1),_c('el-divider'),(_vm.selectedMember.length && !_vm.showManageBtn)?_c('div',{staticStyle:{\"margin-bottom\":\"5px\"}},[_c('div',[_c('el-button',{staticClass:\"is-round\",staticStyle:{\"width\":\"100%\"},attrs:{\"loading\":_vm.tryingApply,\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":_vm.tryToApply}},[_vm._v(\"套 用\")])],1)]):_vm._e(),(_vm.showManageBtn)?_c('el-link',{staticStyle:{\"padding\":\"10px 0\",\"width\":\"100%\",\"justify-content\":\"left\"},attrs:{\"underline\":false},on:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"新增 / 管理標籤\")]):_vm._e(),_c('TagManagment',{attrs:{\"dialog-visible\":_vm.dialogVisible},on:{\"update:dialogVisible\":function($event){_vm.dialogVisible=$event},\"update:dialog-visible\":function($event){_vm.dialogVisible=$event}}})],1),_c('el-button',{staticClass:\"is-round\",attrs:{\"slot\":\"reference\",\"plain\":\"\"},slot:\"reference\"},[_c('BaseIcon',{attrs:{\"name\":\"user-tag\"}}),_c('span',[_vm._v(\"標籤管理 \")]),_c('BaseIcon',{attrs:{\"name\":\"caret-down\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport lazyLoadComponent from '@router/lazyload-component'\nimport { debounce } from 'lodash'\n\nexport default {\n  components: {\n    TagManagment: () => lazyLoadComponent(import('./TagManagment')),\n  },\n  props: {\n    selectedMember: {\n      type: Array,\n      default: () => [],\n    },\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      keyword: '',\n      tagList: [],\n      selectedTag: [],\n      selectedTagClone: [],\n      selectedTagPrevious: [],\n      tryingApply: false,\n      tryingFetch: false,\n      addList: new Set(),\n      addListTracker: 1,  // vue reactivity 不支援 new Set\n      deleteList: new Set(),\n      deleteListTracker: 1\n    }\n  },\n  computed: {\n    tagRecord() {\n      const count = {}\n      this.tagList.forEach((tag) => {\n        count[`id_${tag.id}`] = 0\n      })\n      this.selectedMember.forEach((member) => {\n        member.tags.forEach((tag) => {\n          if (count[`id_${tag.id}`] !== undefined) count[`id_${tag.id}`]++\n        })\n      })\n      return count\n    },\n    showManageBtn() {\n      if (this.isAddedOrDeleted) return false\n      return (\n        // this.selectedTag.length > 0 &&\n        this.isEqualArray(this.selectedTag, this.selectedTagClone)\n      )\n    },\n    isAddedOrDeleted() {\n      return (this.addListTracker && this.addList.size > 0) || (this.deleteListTracker && this.deleteList.size > 0)\n    },\n  },\n  watch: {\n    selectedMember: function(newValue, oldValue) {\n      this.checkSelectedTag()\n    },\n    dialogVisible: function(newValue) {\n      if (newValue === false) {\n        this.tryToFetchList()\n        this.$emit('update')\n      }\n    },\n  },\n  created() {\n    this.tryToFetchList()\n    this.onSearch = debounce(async (searchValue) => {\n      // if (!searchValue) return\n      this.tryToFetchList(searchValue)\n    }, 500)\n  },\n  methods: {\n    async tryToFetchList(search) {\n      this.tryingFetch = true\n      this.tagList = await this.$store.dispatch('member/fetchTags', {\n        search: search || this.keyword,\n      })\n      this.tryingFetch = false\n      this.checkSelectedTag()\n    },\n    async tryToApply() {\n      if (!this.isAddedOrDeleted) {\n        this.$message({\n          message: '請先選擇標籤',\n          type: 'warning',\n        })\n        return\n      }\n      if (this.tryingApply) return\n      this.tryingApply = true\n      const memberIds = this.selectedMember.map((member) => member.id)\n      const request = {\n        addIds: [...this.addList],\n        deleteIds: [...this.deleteList],\n        memberIds,\n      }\n      await this.$store.dispatch('member/applyTags', request)\n      this.tryingApply = false\n      this.$emit('update')\n    },\n    showIndeterminate(id) {\n      if (this.addList.has(id) || this.deleteList.has(id)) return false\n\n      return (\n        this.tagRecord[`id_${id}`] > 0 &&\n        this.tagRecord[`id_${id}`] < this.selectedMember.length\n      )\n    },\n    isIndeterminate(id) {\n      return (\n        this.tagRecord[`id_${id}`] > 0 &&\n        this.tagRecord[`id_${id}`] < this.selectedMember.length\n      )\n    },\n    checkSelectedTag() {\n      this.selectedTag = []\n      this.tagList.forEach((tag) => {\n        if (\n          this.selectedMember.length > 0 &&\n          this.tagRecord[`id_${tag.id}`] === this.selectedMember.length\n        )\n          this.selectedTag.push(tag.id)\n      })\n\n      this.selectedTagClone = [...this.selectedTag]\n      this.selectedTagPrevious = [...this.selectedTag]\n\n      this.addList.clear()\n      this.deleteList.clear()\n      this.$nextTick(()=>{\n        this.$forceUpdate()\n      })\n    },\n    onChanged() {\n      this.isAdd()\n      this.isDelete()\n      this.selectedTagPrevious = [...this.selectedTag]\n      this.$nextTick(() => {\n        this.$forceUpdate()\n      })\n    },\n    isEqualArray(array1, array2) {\n      return (\n        array1.length === array2.length &&\n        array1.every((value, index) => value === array2[index])\n      )\n    },\n    isAdd() {\n      const [addIds] = this.selectedTag.filter(\n        (x) => !this.selectedTagPrevious.includes(x)\n      )\n      if (addIds) {\n        // 初始狀態是已勾選\n        if (this.selectedTagClone.includes(addIds)) {\n          this.deleteList.delete(addIds)\n        } else if (this.deleteList.has(addIds)) {\n          // 初始狀態是 indeterminate\n          this.selectedTag = [...this.selectedTag.filter((id) => id !== addIds)]\n          this.selectedTagPrevious = [...this.selectedTag]\n          this.deleteList.delete(addIds)\n        } else {\n          this.addList.add(addIds)\n        }\n      }\n      this.addListTracker += 1\n    },\n    isDelete() {\n      const [deleteIds] = this.selectedTagPrevious.filter(\n        (x) => !this.selectedTag.includes(x)\n      )\n      if (deleteIds) {\n        // 初始狀態是已勾選 或 indeterminate\n        if (\n          this.isIndeterminate(deleteIds) ||\n          this.selectedTagClone.includes(deleteIds)\n        )\n          this.deleteList.add(deleteIds)\n        this.addList.delete(deleteIds)\n      }\n      this.deleteListTracker += 1\n    },\n  },\n}\n</script>\n\n<template>\n  <el-popover placement=\"bottom\" title=\"貼標籤：\" width=\"200\" trigger=\"click\">\n    <div :class=\"$style.popover\">\n      <el-input\n        v-model=\"keyword\"\n        clearable\n        @input=\"onSearch\"\n        @clear=\"tryToFetchList\"\n        ><BaseIcon slot=\"prefix\" name=\"search\" class=\"el-input__icon\"\n      /></el-input>\n      <div :class=\"$style.list\">\n        <el-checkbox-group v-model=\"selectedTag\" @change=\"onChanged\">\n          <el-checkbox\n            v-for=\"(tag, index) in tagList\"\n            :key=\"`box-${index}`\"\n            :label=\"tag.id\"\n            :disabled=\"selectedMember.length === 0\"\n            :indeterminate=\"showIndeterminate(tag.id)\"\n            :class=\"$style.checkbox\"\n            >{{ tag.title }}</el-checkbox\n          >\n        </el-checkbox-group>\n      </div>\n      <el-divider></el-divider>\n      <div\n        v-if=\"selectedMember.length && !showManageBtn\"\n        style=\"margin-bottom: 5px;\"\n      >\n        <div\n          ><el-button class=\"is-round\"\n            :loading=\"tryingApply\"\n            style=\"width:100%;\"\n            type=\"primary\"\n            plain\n            @click=\"tryToApply\"\n            >套 用</el-button\n          >\n        </div>\n      </div>\n      <el-link\n        v-if=\"showManageBtn\"\n        :underline=\"false\"\n        style=\"padding: 10px 0;\n                width: 100%;\n                justify-content: left;\"\n        @click=\"dialogVisible = true\"\n        >新增 / 管理標籤</el-link\n      >\n      <TagManagment :dialog-visible.sync=\"dialogVisible\"></TagManagment>\n    </div>\n    <el-button slot=\"reference\" class=\"is-round\" plain>\n      <BaseIcon  name=\"user-tag\" />\n      <span>標籤管理 </span>\n      <BaseIcon name=\"caret-down\" />\n    </el-button>\n  </el-popover>\n</template>\n\n<style lang=\"scss\" module>\n.popover {\n  :global {\n    .el-divider {\n      margin: 15px 0;\n    }\n  }\n}\n.list {\n  padding: 10px 0;\n  max-height: 50vh;\n  overflow: auto;\n  &::-webkit-scrollbar {\n    display: block;\n    width: 4px;\n  }\n  &::-webkit-scrollbar-thumb {\n    border-radius: 10px;\n    background-color: #d8d8d8;\n  }\n}\n.checkbox {\n  display: block;\n  margin: 0;\n  margin-bottom: 10px;\n  width: 100%;\n  overflow: hidden;\n  &:last-child {\n    margin: 0;\n  }\n  :global {\n    .el-checkbox__label {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      width: 100%;\n      padding-right: 10px;\n      margin-bottom: -4px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagPopover.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagPopover.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TagPopover.vue?vue&type=template&id=2ffc914f&\"\nimport script from \"./TagPopover.vue?vue&type=script&lang=js&\"\nexport * from \"./TagPopover.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TagPopover.vue?vue&type=style&index=0&lang=scss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","// extracted by mini-css-extract-plugin\nmodule.exports = {\"slide\":\"TagPopover_slide_1yB1V\",\"slide-reverse\":\"TagPopover_slide-reverse_1Z_6-\",\"popover\":\"TagPopover_popover_EcEBv\",\"list\":\"TagPopover_list_2Qu-t\",\"checkbox\":\"TagPopover_checkbox_S3iVt\"};"],"sourceRoot":""}