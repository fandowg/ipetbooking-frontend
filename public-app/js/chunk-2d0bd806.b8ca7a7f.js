(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bd806"],{"2bee":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("div",{staticClass:"el-table-wrapper"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.tryingToGetOrder,expression:"tryingToGetOrder",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"取得訂單資訊中",data:e.loadedOrders,"default-sort":{prop:"date",order:"descending"},"row-class-name":e.calcRowClassName},on:{"row-click":e.tryToGetOrder,"sort-change":e.sortChange}},[t("el-table-column",{attrs:{label:"#訂單編號",prop:"created_at","min-width":"160",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",[e._v(e._s("#"+a.orderNo))]),t("div",[e._v(e._s(e._f("formatDate")(a.created,"dateTime")))])]}}])}),t("el-table-column",{attrs:{"min-width":"150",label:"包月方案/次數與期限"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",[t("b",[e._v(e._s(a.prepaidTitle))])]),t("div",[e._v("$"+e._s(a.total))]),t("div",[t("b",[e._v("剩餘："+e._s(a.times-a.used)+" / "+e._s(a.times))])])]}}])})],1)],1),t("BasePagination",{ref:"pagination",attrs:{"current-page":e.currentPage},on:{"update:currentPage":function(r){e.currentPage=r},"update:current-page":function(r){e.currentPage=r}}}),t("el-drawer",{attrs:{visible:e.drawerVisible,"append-to-body":"",size:e.$root.isSmallDevice?"100%":"50%"},on:{"update:visible":function(r){e.drawerVisible=r}}},[t("PortalTarget",{attrs:{slot:"title",name:"drawer-prepaid-header"},slot:"title"}),t("OrderDetail",{ref:"orderDetail",attrs:{"default-value":e.drawerOrderData},on:{"update:defaultValue":function(r){e.drawerOrderData=r},"update:default-value":function(r){e.drawerOrderData=r},update:e.tryToSearchOrder}})],1)],1)},n=[],i=t("4795"),d=t.n(i),o=t("cb0c"),s=t("a315"),l=t("7e02"),c=t("6bea"),u=t("1b80"),p=t("2b88"),f={components:{PortalTarget:p["PortalTarget"],BaseStateLabel:function(){return Object(s["a"])(t.e("chunk-12bed50d").then(t.bind(null,"38d1")))},OrderDetail:function(){return Object(s["a"])(t.e("chunk-825dd5fc").then(t.bind(null,"6dc4")))}},filters:{orderStatusFilter:l["o"],orderSourceFilter:l["m"],orderPaymentMethodFilter:l["k"],formatDate:c["a"]},mixins:[u["c"]],props:{memberInfoId:{type:String,default:""}},data:function(){return{loadedOrders:[],tryingToGetOrder:!1,drawerVisible:!1,drawerOrderData:"",filterData:{order_by:"created_at",order:"desc"}}},watch:{currentPage:{handler:"tryToSearchOrder",immediate:!0}},methods:{calcRowClassName:function(e){var r=e.row,t=r.status,a=r.groupSize/r.usedSize;return 0===t?"order--canceled":1===a?"order--used":void 0},tryToGetOrder:function(){var e=Object(o["a"])(d.a.mark(function e(r){return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.tryingToGetOrder=!0,e.next=3,this.$store.dispatch("prepaid/fetchOrderSingle",r.id);case 3:this.drawerOrderData=e.sent,this.tryingToGetOrder=!1,this.drawerVisible=!0;case 6:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),tryToSearchOrder:function(){var e=Object(o["a"])(d.a.mark(function e(){var r,t,a,n=this;return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("prepaid/fetchOrders",Object.assign({memberId:this.memberInfoId,paymentMethod:"All",order_by:this.filterData.order_by,order:this.filterData.order},this.pageQuery));case 2:r=e.sent,t=r.items,a=r.total,this.loadedOrders=t,this.$nextTick(function(){n.$refs.pagination.updateTotal(a)});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),sortChange:function(e){e.column;var r=e.prop,t=e.order;t&&(this.filterData.order_by=r,this.filterData.order="ascending"===t?"asc":"desc",this.currentPage=1,this.tryToSearchOrder())}}},h=f,b=t("2877"),m=Object(b["a"])(h,a,n,!1,null,null,null);r["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0bd806.b8ca7a7f.js.map