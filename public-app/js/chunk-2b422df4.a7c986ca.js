(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b422df4"],{"4c46":function(e,t,i){e.exports={slide:"ImageUpload_slide_2vPxf","slide-reverse":"ImageUpload_slide-reverse_3qw2u",wrap:"ImageUpload_wrap_2Hyz5"}},9529:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpload,expression:"showUpload"}],class:e.$style.wrap},[i("el-upload",{ref:"upload",class:{isLimit:5===e.fileList.length},attrs:{action:"#","list-type":"picture-card","auto-upload":!1,"http-request":e.handleUpload,"before-upload":e.beforeImageUpload,"file-list":e.fileList,"on-change":e.changeUpload,"clear-files":!1,multiple:"",limit:5,"on-exceed":e.handleExceed},scopedSlots:e._u([{key:"file",fn:function(t){var a=t.file;return i("div",{},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:a.url,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePreview(a.url)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.tryToRemove(a)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}])},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),i("p",{staticStyle:{color:"#c0c4cc",margin:"0"}},[e._v("圖檔最大 10 MB，檔案格式限 JPG 或 PNG")]),i("el-dialog",{attrs:{visible:e.dialogVisible,width:"800px",top:"0","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl}})])],1)},s=[],l=i("4795"),r=i.n(l),n=i("cb0c"),o=i("b775"),c={props:{tryingSave:{type:Boolean,default:!1},value:{type:Array,default:function(){return[]}},showUpload:{type:Boolean,default:!1},single:{type:Boolean,default:!1},fileList:{type:Array,default:function(){return[]}}},data:function(){return{tryingToUpload:!1,dialogImageUrl:"",dialogVisible:!1,disabled:!1,cacheList:[]}},computed:{showUploadBtn:function(){return!this.single||0===this.value.length}},watch:{},created:function(){},mounted:function(){},methods:{beforeImageUpload:function(e){var t=this,i=!0;return e.forEach(function(e){if(i){var a="image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type,s=e.size/1024/1024<=10;a||t.$message.error("上傳的圖片只能是 JPG 或 PNG 格式"),s||t.$message.error("上傳的圖片大小不能超過 10 MB"),i=a&&s}}),i},handleUpload:function(){var e=Object(n["a"])(r.a.mark(function e(t){var i,a,s,l;return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.beforeImageUpload(this.cacheList),i){e.next=3;break}return e.abrupt("return",Promise.reject(new Error("Error")));case 3:return a=new FormData,this.cacheList.forEach(function(e,t){a.append("images[]",e,t)}),this.tryingToUpload=!0,this.$emit("update:tryingSave",!0),e.next=9,o["a"].post("/admin/comment/upload",a,{headers:{"Content-Type":"multipart/form-data"}});case 9:return s=e.sent,l=s.items.images,this.tryingToUpload=!1,this.$emit("update:tryingSave",!1),this.cacheList=[],e.abrupt("return",l);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handlePreview:function(e){this.dialogImageUrl=e,this.dialogVisible=!0},changeUpload:function(e){var t=this;this.cacheList.push(e.raw),this.cacheList=this.cacheList.filter(function(e,i){return t.cacheList.indexOf(e)===i});var i={url:e.url,uid:e.uid};this.$emit("updateFileList",i)},tryToRemove:function(e){var t=this;this.fileList.forEach(function(i,a){e.url===i.url&&t.fileList.splice(a,1)}),this.$refs.upload.uploadFiles.forEach(function(i,a){e.url===i.url&&t.$refs.upload.uploadFiles.splice(a,1)}),this.cacheList.forEach(function(i,a){e.uid===i.uid&&t.cacheList.splice(a,1)})},handleExceed:function(){this.$message({message:"一次最多上傳5張照片",type:"error"})}}},u=c,d=i("c752"),p=i("2877");function f(e){this["$style"]=d["default"].locals||d["default"]}var h=Object(p["a"])(u,a,s,!1,f,null,null);t["default"]=h.exports},c752:function(e,t,i){"use strict";var a=i("4c46"),s=i.n(a);t["default"]=s.a}}]);
//# sourceMappingURL=chunk-2b422df4.a7c986ca.js.map