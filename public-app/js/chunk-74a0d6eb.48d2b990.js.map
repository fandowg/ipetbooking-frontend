{"version":3,"sources":["webpack:///./src/router/views/schedule/components/MemberOrdersProduct.vue?d7d8","webpack:///src/router/views/schedule/components/MemberOrdersProduct.vue","webpack:///./src/router/views/schedule/components/MemberOrdersProduct.vue?c457","webpack:///./src/router/views/schedule/components/MemberOrdersProduct.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","expression","modifiers","fullscreen","lock","attrs","element-loading-text","data","loadedOrders","default-sort","prop","order","row-class-name","calcRowClassName","on","row-click","tryToGetOrder","sort-change","sortChange","min-width","label","sortable","scopedSlots","_u","key","fn","ref","row","_v","_s","id","_f","created","productName","params","title","date","time","allActualPayTotal","current-page","currentPage","update:currentPage","$event","update:current-page","visible","drawerVisible","append-to-body","size","$root","isSmallDevice","destroy-on-close","wrapper-closable","custom-class","update:visible","closed","componentKey","default-value","drawerOrderData","update:defaultValue","update:default-value","update","tryToSearchOrder","staticRenderFns","MemberOrdersProductvue_type_script_lang_js_","components","PortalTarget","portal_vue_common","BaseStateLabel","Object","lazyload_component","__webpack_require__","e","then","bind","OrderDetail","OrderForm","Promise","resolve","filters","orderStatusFilter","filter_value_to_text","orderSourceFilter","orderPaymentMethodFilter","formatDate","format_date","bookingStatusFilter","paymentStatusMapFilter","mixins","pagination","props","memberInfoId","type","String","default","tryingToGetOrder","filterData","order_by","watch","handler","immediate","methods","_ref","orderStatus","status","orderUsedStatus","groupSize","usedSize","_tryToGetOrder","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","$store","dispatch","sent","stop","_x","apply","arguments","_tryToSearchOrder","_callee2","_ref2","items","total","_this","_context2","assign","memberId","paymentMethod","pageQuery","$nextTick","$refs","updateTotal","_ref3","column","components_MemberOrdersProductvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-74a0d6eb.48d2b990.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"el-table-wrapper\"},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading.fullscreen.lock\",value:(_vm.tryingToGetOrder),expression:\"tryingToGetOrder\",modifiers:{\"fullscreen\":true,\"lock\":true}}],attrs:{\"element-loading-text\":\"取得訂單資訊中\",\"data\":_vm.loadedOrders,\"default-sort\":{ prop: 'created', order: 'descending' },\"row-class-name\":_vm.calcRowClassName},on:{\"row-click\":_vm.tryToGetOrder,\"sort-change\":_vm.sortChange}},[_c('el-table-column',{attrs:{\"prop\":\"created_at\",\"min-width\":\"160\",\"label\":\"#編號與成立時間\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',[_vm._v(\"#\"+_vm._s(row.id)+\" \"),_c('br'),_vm._v(\"\\n          \"+_vm._s(_vm._f(\"formatDate\")(row.created))+\"\\n\\n          \"+_vm._s(_vm._f(\"formatDate\")(row.created,'time'))+\"\\n        \")])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"startDate\",\"min-width\":\"200\",\"label\":\"服務項目 / 服務時間\",\"sortable\":\"custom\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(row.productName)+\" \"+_vm._s(row.params[0].title))]),_c('div',[_vm._v(_vm._s(_vm._f(\"formatDate\")(row.date))+\" \"+_vm._s(row.time))]),_c('div',[_vm._v(\"$\"+_vm._s(row.allActualPayTotal))])]}}])})],1)],1),_c('BasePagination',{ref:\"pagination\",attrs:{\"current-page\":_vm.currentPage},on:{\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event}}}),_c('el-drawer',{ref:\"orderFormEdit\",staticClass:\"only-close\",attrs:{\"visible\":_vm.drawerVisible,\"append-to-body\":\"\",\"size\":_vm.$root.isSmallDevice ? '100%' : '90%',\"destroy-on-close\":\"\",\"wrapper-closable\":false,\"custom-class\":\"order-drawer\"},on:{\"update:visible\":function($event){_vm.drawerVisible=$event},\"closed\":function($event){_vm.componentKey++}}},[_c('OrderForm',{key:_vm.componentKey,ref:\"orderDetail\",attrs:{\"default-value\":_vm.drawerOrderData},on:{\"update:defaultValue\":function($event){_vm.drawerOrderData=$event},\"update:default-value\":function($event){_vm.drawerOrderData=$event},\"update\":_vm.tryToSearchOrder}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport lazyLoadComponent from '@router/lazyload-component'\nimport { orderStatusFilter, orderSourceFilter,orderPaymentMethodFilter,bookingStatusFilter,paymentStatusMapFilter } from '@utils/filter-value-to-text'\nimport formatDate from '@utils/format-date'\nimport pageMixin from '@src/mixins/pagination'\nimport { PortalTarget } from 'portal-vue'\n\nexport default {\n  components: {\n    PortalTarget,\n    BaseStateLabel: () => lazyLoadComponent(import('@components/BaseStateLabel')),\n    OrderDetail: () => lazyLoadComponent(import('@components/Order/OrderDetail')),\n    OrderForm: () => lazyLoadComponent(import('@views/schedule/components/OrderForm')),\n  },\n  filters: {\n    orderStatusFilter,\n    orderSourceFilter,\n    orderPaymentMethodFilter,\n    formatDate,\n    bookingStatusFilter,\n    paymentStatusMapFilter,\n  },\n  mixins: [pageMixin],\n  props:{\n    memberInfoId:{\n      type:String,\n      default:''\n    }\n  },\n  data() {\n    return {\n      componentKey: 0,\n      loadedOrders: [],\n      tryingToGetOrder: false,\n      drawerVisible: false,\n      drawerOrderData: '',\n      filterData:{\n        order_by:'created_at',\n        order:'desc'\n      }\n    }\n  },\n  watch: {\n    currentPage: {\n      handler: 'tryToSearchOrder',\n      immediate: true,\n    },\n  },\n  methods: {\n    calcRowClassName({ row }) {\n      const orderStatus = row.status\n      const orderUsedStatus = row.groupSize / row.usedSize\n\n      if (orderStatus === 0) return 'order--canceled'\n      if (orderUsedStatus === 1) return 'order--used'\n    },\n    async tryToGetOrder(row) {\n      this.tryingToGetOrder = true\n      this.drawerOrderData = await this.$store.dispatch('order/fetchSingle', row.id)\n      this.tryingToGetOrder = false\n      this.drawerVisible = true\n    },\n    async tryToSearchOrder() {\n      const { items, total } = await this.$store.dispatch('order/fetchList', Object.assign({ \n        memberId: this.memberInfoId, \n          paymentMethod: 'All',\n          order_by:this.filterData.order_by,\n          order:this.filterData.order,\n        }, this.pageQuery,\n       \n      ))\n      this.loadedOrders = items\n      this.$nextTick(() => {\n        this.$refs.pagination.updateTotal(total)\n      })\n    },\n    sortChange({column, prop, order}){\n      if(order){\n  \n        this.filterData.order_by = prop\n        this.filterData.order = order==='ascending'?'asc':'desc'\n        this.currentPage=1\n        this.tryToSearchOrder()\n      }\n      // console.log(column, prop, order)\n    }\n  },\n}\n</script>\n\n<template>\n  <div>\n    <div class=\"el-table-wrapper\">\n      <el-table\n        v-loading.fullscreen.lock=\"tryingToGetOrder\"\n        element-loading-text=\"取得訂單資訊中\"\n        :data=\"loadedOrders\"\n        :default-sort=\"{ prop: 'created', order: 'descending' }\"\n        :row-class-name=\"calcRowClassName\"\n        @row-click=\"tryToGetOrder\"\n        @sort-change=\"sortChange\"\n      >\n        <el-table-column v-slot=\"{ row }\" prop=\"created_at\" min-width=\"160\" label=\"#編號與成立時間\"  sortable=\"custom\">\n          <span\n            >#{{ row.id }} <br />\n            {{ row.created | formatDate }}\n\n            {{ row.created | formatDate('time') }}\n          </span>\n        </el-table-column>\n   \n   \n\n        <el-table-column v-slot=\"{ row }\" prop=\"startDate\" min-width=\"200\" label=\"服務項目 / 服務時間\"  sortable=\"custom\">\n          <div>{{row.productName}} {{ row.params[0].title }}</div>\n          <div>{{ row.date | formatDate }} {{ row.time }}</div>\n          <div>${{ row.allActualPayTotal }}</div>\n        </el-table-column>\n\n      </el-table>\n    </div>\n    <BasePagination ref=\"pagination\" :current-page.sync=\"currentPage\" />\n    <el-drawer ref=\"orderFormEdit\" class=\"only-close\"\n      :visible.sync=\"drawerVisible\" \n      append-to-body \n      :size=\"$root.isSmallDevice ? '100%' : '90%'\" \n      destroy-on-close\n      :wrapper-closable = \"false\"\n      custom-class=\"order-drawer\"\n      @closed=\"componentKey++\"\n    > \n      <OrderForm \n        ref=\"orderDetail\"\n        :key=\"componentKey\"\n        :default-value.sync=\"drawerOrderData\" \n        @update=\"tryToSearchOrder\"\n      />\n    </el-drawer>\n    <!-- <el-drawer :visible.sync=\"drawerVisible\" append-to-body :size=\"$root.isSmallDevice ? '100%' : '50%'\" destroy-on-close>\n  \n      <PortalTarget slot=\"title\" name=\"drawer-header\"></PortalTarget>\n\n      <OrderDetail ref=\"orderDetail\" :default-value.sync=\"drawerOrderData\" @update=\"tryToSearchOrder\" />\n    </el-drawer> -->\n  </div>\n</template>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MemberOrdersProduct.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MemberOrdersProduct.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MemberOrdersProduct.vue?vue&type=template&id=a79a0920&\"\nimport script from \"./MemberOrdersProduct.vue?vue&type=script&lang=js&\"\nexport * from \"./MemberOrdersProduct.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}