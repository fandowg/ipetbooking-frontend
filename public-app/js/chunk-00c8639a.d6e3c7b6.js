(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00c8639a"],{"2d66":function(t,e,r){t.exports=r.p+"img/logo-dark.9cbb0fa3.svg"},"35e0":function(t,e,r){"use strict";var s=r("9737"),a=r.n(s);e["default"]=a.a},9737:function(t,e,r){t.exports={slide:"login_slide_1cCBr","slide-reverse":"login_slide-reverse_1_MKr",loginWrapper:"login_loginWrapper_2cQRu",top:"login_top_rFx1q",top__header:"login_top__header_2Ol0o",main:"login_main_2BAh-",main__header:"login_main__header_11gSo","help-text":"login_help-text_3EcKE",footer:"login_footer_W5u67","bg-mark":"login_bg-mark_3IYbB"}},b6e6:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",{staticClass:"login-container",class:[t.$style.loginWrapper,{isReset:t.resetMode||t.forgotMode}]},[s("div",{staticClass:"inner"},[s("div",{class:t.$style.top},[s("img",{staticClass:"logo-pet",attrs:{src:r("2d66")}}),s("img",{staticClass:"logo-site",attrs:{src:r("c791")}})]),s("transition",{attrs:{name:"login-form",appear:""}},[t.resetMode?s("el-form",{ref:"form",staticClass:"el-form-item--normal-margin",class:t.$style.main,attrs:{model:t.resetData,rules:t.resetRules},nativeOn:{submit:function(e){return e.preventDefault(),t.tryToReset(e)}}},[s("h3",[t._v("重置密碼")]),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:t.passwordVisible?"text":"password",placeholder:"輸入新的密碼"},model:{value:t.resetData.password,callback:function(e){t.$set(t.resetData,"password",e)},expression:"resetData.password"}},[s("el-button",{attrs:{slot:"append"},on:{click:function(e){t.passwordVisible=!t.passwordVisible}},slot:"append"},[s("BaseIcon",{attrs:{name:t.passwordVisible?"eye-slash":"eye"}})],1)],1)],1),s("el-form-item",{attrs:{prop:"passwordConfirm"}},[s("el-input",{attrs:{type:t.passwordVisible?"text":"password",placeholder:"再次輸入密碼以確認"},model:{value:t.resetData.passwordConfirm,callback:function(e){t.$set(t.resetData,"passwordConfirm",e)},expression:"resetData.passwordConfirm"}},[s("el-button",{attrs:{slot:"append"},on:{click:function(e){t.passwordVisible=!t.passwordVisible}},slot:"append"},[s("BaseIcon",{attrs:{name:t.passwordVisible?"eye-slash":"eye"}})],1)],1)],1),s("el-form-item",[s("el-button",{staticClass:"is-fullwidth",attrs:{size:"large",type:"primary","native-type":"submit",loading:t.buttonLoading,disabled:t.buttonLoading}},[t._v("變更密碼\n          ")])],1),s("el-button",{attrs:{type:"text"},on:{click:t.backToLogin}},[t._v("回到登入頁")])],1):t._e()],1),s("transition",{attrs:{name:"login-form",appear:""}},[t.$route.params.resetToken?t._e():s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.processingLogin,expression:"processingLogin"}],ref:"form",staticClass:"el-form-item--normal-margin",class:t.$style.main,attrs:{model:t.loginData,rules:t.formRules,"validate-on-rule-change":!1,"element-loading-text":t.processingText},nativeOn:{submit:function(e){return e.preventDefault(),t.handleSubmitForm(e)}}},[t.processingLogin?t._e():[t.forgotMode?s("div",{class:t.$style.main__header},[s("h3",[t._v("忘記密碼？")]),s("p",[t._v("不用擔心！您只要輸入您註冊的 Email，我們將會協助您重置密碼。")])]):t._e(),s("el-form-item",{attrs:{prop:"email"}},[s("h3",{directives:[{name:"show",rawName:"v-show",value:!t.forgotMode,expression:"!forgotMode"}],staticStyle:{"margin-top":"0"}},[t._v("登入")]),s("el-input",{staticClass:"is-round",attrs:{type:"text",placeholder:"Email"},model:{value:t.loginData.email,callback:function(e){t.$set(t.loginData,"email",e)},expression:"loginData.email"}})],1),t.forgotMode?[s("el-form-item",[s("el-button",{staticClass:"is-fullwidth is-round",attrs:{size:"large",type:"primary","native-type":"submit",loading:t.buttonLoading,disabled:t.buttonLoading}},[t._v("取得重置密碼信\n              ")])],1),s("div",{class:t.$style["help-text"]},[t._v("\n              記得您的密碼？試著\n              "),s("el-button",{attrs:{type:"text"},on:{click:t.switchForgotMode}},[t._v("登入")]),t._v("\n              吧！\n            ")],1)]:t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.forgotMode,expression:"!forgotMode"}]},[s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{staticClass:"is-round",attrs:{type:t.passwordVisible?"text":"password",placeholder:"密碼"},model:{value:t.loginData.password,callback:function(e){t.$set(t.loginData,"password",e)},expression:"loginData.password"}},[s("el-button",{attrs:{slot:"append"},on:{click:function(e){t.passwordVisible=!t.passwordVisible}},slot:"append"},[s("BaseIcon",{attrs:{name:t.passwordVisible?"eye-slash":"eye"}})],1)],1)],1),s("el-button",{staticClass:"is-fullwidth",staticStyle:{"text-align":"right","margin-top":"-20px","margin-bottom":"20px"},attrs:{type:"text"},on:{click:t.switchForgotMode}},[t._v("\n              忘記密碼？\n            ")]),s("el-form-item",[s("el-button",{staticClass:"is-fullwidth is-round",attrs:{size:"large",type:"primary","native-type":"submit",loading:t.buttonLoading,disabled:t.buttonLoading}},[t._v("登入\n              ")])],1)],1)]],2)],1)],1),s("div",{class:t.$style.footer},[t._v(t._s("版本 "+t.appVersion))]),t.bindCardFormData?s("form",{ref:"cardForm",attrs:{action:t.bindCardFormData.PostUrl,method:"POST",hidden:""}},t._l(t.bindCardFormData,function(t,e){return s("input",{key:e,attrs:{name:e},domProps:{value:t}})}),0):t._e()])},a=[],n=r("4795"),o=r.n(n),i=r("cb0c"),l=r("9395"),c=r("b775"),u=r("4d77"),d=r("c2a4"),p=(r("a78e"),r("1547"));Object(p["b"])("Http",{web:()=>r.e("chunk-2d0c1783").then(r.bind(null,"45d0")).then(t=>new t.HttpWeb),electron:()=>r.e("chunk-2d0c1783").then(r.bind(null,"45d0")).then(t=>new t.HttpWeb)});r("6300"),r("5b99");var h={page:{title:"登入",meta:[{name:"description",content:"Log in to ".concat(d.title)}]},data:function(){var t=this;return{forgotMode:!1,loginData:{email:"",password:""},resetData:{password:"",passwordConfirm:""},resetRules:{password:[{required:!0,validator:function(e,r,s){if(!r)return s(new Error("請輸入密碼"));var a=/(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])|(?=.*[a-z])(?=.*[A-Z])(?=.*[$@$!%*#?&])|(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*#?&])|(?=.*[a-z])(?=.*[0-9])(?=.*[$@$!%*#?&]).{8,16}/,n=t.resetData.passwordConfirm;a.test(r)||s(new Error("請用 8~16 個大小寫英文字母、數字與特殊符號組合")),""!==n&&t.$refs.form.validateField("passwordConfirm"),s()},trigger:"blur"}],passwordConfirm:[{required:!0,validator:function(e,r,s){if(!r)return s(new Error("請再次輸入密碼"));var a=t.resetData.password;r!==a?s(new Error("兩次輸入的密碼不一致")):s()},trigger:"blur"}]},buttonLoading:!1,subscriptionData:{},bindCardFormData:"",processingLogin:!1,processingText:"",passwordVisible:!1}},computed:Object(l["a"])({},u["a"],u["b"],{resetMode:function(){return this.$route.params.resetToken},formRules:function(){return{email:[{required:!0,message:"請輸入 Email",trigger:"blur"},{type:"email",message:"請輸入有效的 Email",trigger:"blur"}],password:[{required:!this.forgotMode,message:"請輸入密碼",trigger:"blur"}]}}}),methods:{tryToReset:function(){var t=Object(i["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.buttonLoading=!0,t.prev=1,t.next=4,this.$store.dispatch("auth/reset",Object(l["a"])({},this.resetData,{token:this.resetMode}));case 4:return t.next=6,this.$alert("您的密碼已重置，請重新登入","密碼已更新",{confirmButtonText:"回到登入頁",type:"success",center:!0});case 6:this.backToLogin(),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](1);case 11:return t.prev=11,this.buttonLoading=!1,t.finish(11);case 14:case"end":return t.stop()}},t,this,[[1,9,11,14]])}));return function(){return t.apply(this,arguments)}}(),tryToSendForget:function(){var t=Object(i["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.buttonLoading=!0,t.prev=1,t.next=4,this.$store.dispatch("auth/forgot",this.loginData.email);case 4:return t.next=6,this.$alert("請至您的信箱查看並進行重置密碼","已成功寄出重置密碼信件！",{confirmButtonText:"確定",type:"success",center:!0});case 6:this.switchForgotMode();case 7:return t.prev=7,this.buttonLoading=!1,t.finish(7);case 10:case"end":return t.stop()}},t,this,[[1,,7,10]])}));return function(){return t.apply(this,arguments)}}(),tryToLogIn:function(){var t=this;return this.buttonLoading=!0,this.$store.dispatch("auth/logIn",this.loginData).then(function(){return t.handleLogin()}).catch(function(e){switch(console.log("TCL: tryToLogIn -> error",e),e.status){case"MERCHANT_FRONT_PLEASE_BIND_CARD_FIRST":t.subscriptionData=e.data.items,t.handleBindingCard();break;case"MERCHANT_FRONT_PLEASE_RENEW_SUBSCRIPTION":t.subscriptionData=e.data.items,t.handleSubscription();break;default:t.$alert(Object(c["b"])(e.status),"登入失敗",{confirmButtonText:"確定",type:"error",center:!0});break}}).finally(function(){return t.buttonLoading=!1})},tryToBindingCard:function(){var t=Object(i["a"])(o.a.mark(function t(){var e=this;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("merchant/changeCard",this.subscriptionData.merchantAlias);case 2:this.bindCardFormData=t.sent,this.$nextTick(function(){e.$refs.cardForm.submit()});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleBindingCard:function(){var t=Object(i["a"])(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("設定您的付款方式後，您的會員資格就會立即開始","您尚未設定付款方式",{confirmButtonText:"前往設定",cancelButtonText:"取消",type:"warning",center:!0});case 2:this.$router.push({name:"subscription"});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleSubscription:function(){var t=Object(i["a"])(o.a.mark(function t(){var e,r,s,a;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=1===this.subscriptionData.creditCard.isExpired,r=e?"您的信用卡已過期":"訂閱已到期",s=e?"請重新綁定您的信用卡":"您的訂閱已到期，故無法登入。<br>欲重啟訂閱請與我們聯繫，謝謝！<br>(02)2531-6628",a=e?"前往更新":"確定",t.next=6,this.$confirm(s,r,{confirmButtonText:a,cancelButtonText:"取消",type:"warning",center:!0,dangerouslyUseHTMLString:!0,showCancelButton:e,showClose:e,closeOnClickModal:e});case 6:this.$router.push({name:"logout"});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleLogin:function(){var t=Object(i["a"])(o.a.mark(function t(){var e;return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.processingLogin=!0,this.processingText="登入成功，取得身份權限中",t.prev=2,t.next=5,this.$store.dispatch("auth/fetchAccess");case 5:return e=t.sent,this.$router.addRoutes(e),t.next=9,this.$store.dispatch("auth/fetchTour");case 9:this.$route.params.routeFromPath?this.$router.push({path:String(this.$route.params.routeFromPath)}):this.$router.push(this.$route.query.redirectFrom||{name:this.currentUser.redirect}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),this.processingLogin=!1;case 15:case"end":return t.stop()}},t,this,[[2,12]])}));return function(){return t.apply(this,arguments)}}(),handleSubmitForm:function(){this.forgotMode?this.tryToSendForget():this.tryToLogIn()},switchForgotMode:function(){this.$refs.form.clearValidate(),this.forgotMode=!this.forgotMode},backToLogin:function(){this.$router.push({name:"login"})}}},m=h,g=r("35e0"),f=r("2877");function b(t){this["$style"]=g["default"].locals||g["default"]}var w=Object(f["a"])(m,s,a,!1,b,null,null);e["default"]=w.exports},c791:function(t,e,r){t.exports=r.p+"img/login_logo.ffa159ed.svg"}}]);
//# sourceMappingURL=chunk-00c8639a.d6e3c7b6.js.map